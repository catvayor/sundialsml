<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Sundials_LinearSolver.html">
<link rel="next" href="Nvector_custom.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Sundials_parallel" rel="Chapter" href="Sundials_parallel.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Core functions" rel="Section" href="#nlscore">
<link title="Set functions" rel="Section" href="#nlsset">
<link title="Get functions" rel="Section" href="#nlsget">
<link title="Nonlinear Solver Implementations" rel="Section" href="#nlssolvers">
<link title="Exceptions" rel="Section" href="#nlsexceptions">
<title>Sundials/ML 6.0.0p0 : Sundials_NonlinearSolver</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Sundials_LinearSolver.html" title="Sundials_LinearSolver">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Nvector_custom.html" title="Nvector_custom">Next</a>
</div>
<h1>Module <a href="type_Sundials_NonlinearSolver.html">Sundials_NonlinearSolver</a></h1>

<pre><span id="MODULESundials_NonlinearSolver"><span class="keyword">module</span> Sundials_NonlinearSolver</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Sundials_NonlinearSolver.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>Generic nonlinear solvers.</p>

<p>Sundials provides generic nonlinear solvers of two main types:
    <a href="Sundials_NonlinearSolver.Newton.html"><code class="code"><span class="constructor">Sundials_NonlinearSolver</span>.<span class="constructor">Newton</span></code></a> and <a href="Sundials_NonlinearSolver.FixedPoint.html"><code class="code"><span class="constructor">Sundials_NonlinearSolver</span>.<span class="constructor">FixedPoint</span></code></a>. An instance of a nonlinear
    solver may only be associated with at most one integrator session at
    a time.</p>

<p>This module supports calling both Sundials and custom OCaml nonlinear
    solvers from both Sundials integrators and OCaml applications.</p>

<p>This documentation is structured as follows.</p>
<OL>
<li><a href="#nlscore">Core functions</a></li>
<li><a href="#nlsset">Set functions</a></li>
<li><a href="#nlsget">Get functions</a></li>
<li><a href="#nlssolvers">Nonlinear Solver Implementations</a></li>
<li><a href="#nlsexceptions">Exceptions</a></li>
</OL>
</div>
<ul class="info-attributes">
<div class="authors"><b>Author(s):</b> Timothy Bourke (Inria/ENS), Jun Inoue (Inria/ENS), Marc Pouzet (UPMC/ENS/Inria)</div>
<li><b>Version:</b> 6.0.0</li>
<li><b>Since</b> 4.0.0</li>
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#the-sunnonlinearsolver-api">The SUNNonlinearSolver API</a></li></ul>
</div>
<hr width="100%">

<pre><span id="TYPEt"><span class="keyword">type</span> <code class="type">('data, 'kind, 's, 'v)</code> t</span> = <code class="type">('data, 'kind, 's, 'v) nonlinear_solver</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A generic nonlinear solver.
    The type variables specify</p>
<ul>
<li><code class="code"><span class="keywordsign">'</span>data</code>, the <a href="Nvector.html#TYPEnvector"><code class="code"><span class="constructor">Nvector</span>.nvector</code></a> data,</li>
<li><code class="code"><span class="keywordsign">'</span>kind</code>, the <a href="Nvector.html#TYPEnvector"><code class="code"><span class="constructor">Nvector</span>.nvector</code></a> kind,</li>
<li><code class="code"><span class="keywordsign">'</span>s</code>, the type of of session data to be passed
      into the nonlinear solver and through to callbacks, and,</li>
<li><code class="code"><span class="keywordsign">'</span>v</code>, a type indicating that the solver manipulates nvectors (<code class="code"><span class="keywordsign">`</span><span class="constructor">Nvec</span></code>)
      or <a href="Sundials_NonlinearSolver.Senswrapper.html#TYPEt">senswrappers</a> (<code class="code"><span class="keywordsign">`</span><span class="constructor">Sens</span></code>).</li>
</ul>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinearSolver">SUNNonlinearSolver</a></li></ul>
</div>


<pre><span id="MODULESenswrapper"><span class="keyword">module</span> <a href="Sundials_NonlinearSolver.Senswrapper.html">Senswrapper</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Sundials_NonlinearSolver.Senswrapper.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>A limited interface to arrays of <a href="Nvector.html#TYPEnvector"><code class="code"><span class="constructor">Nvector</span>.nvector</code></a>s required
    to apply nonlinear solvers to sensitivity problems.</p>

</div>
<h3 id="nlscore">Core functions</h3>
<pre><code><span id="TYPEnonlinear_solver_type"><span class="keyword">type</span> <code class="type"></code>nonlinear_solver_type</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlinear_solver_type.RootFind"><span class="constructor">RootFind</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Solves $F(y) = 0$</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlinear_solver_type.FixedPoint"><span class="constructor">FixedPoint</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Solves $G(y) = y$</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>The problem specification expected by a nonlinear solver.</p>
</div>
</div>


<pre><span id="VALget_type"><span class="keyword">val</span> get_type</span> : <code class="type">('d, 'k, 's, 'v) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt;<br>       <a href="Sundials_NonlinearSolver.html#TYPEnonlinear_solver_type">nonlinear_solver_type</a></code></pre><div class="info ">
<div class="info-desc">
<p>Returns the type of a nonlinear solver.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolGetType">SUNNonlinSolGetType</a></li></ul>
</div>

<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">('d, 'k, 's, 'v) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Initializes a nonlinear solver.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolInitialize">SUNNonlinSolInitialize</a></li></ul>
</div>

<pre><span id="VALsetup"><span class="keyword">val</span> setup</span> : <code class="type">('d, 'k, 's, [ `Nvec ]) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt;<br>       y:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; 's -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Setup a nonlinear solver with an initial iteration value.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolSetup">SUNNonlinSolSetup</a></li></ul>
</div>

<pre><span id="VALsolve"><span class="keyword">val</span> solve</span> : <code class="type">('d, 'k, 's, [ `Nvec ]) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt;<br>       y0:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt;<br>       ycor:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt;<br>       w:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; float -&gt; bool -&gt; 's -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Solves a nonlinear system.
    The call <code class="code">solve&nbsp;ls&nbsp;~y0&nbsp;~y&nbsp;~w&nbsp;tol&nbsp;callLSetup&nbsp;s</code> solves the
    nonlinear system $F(y) = 0$  or $G(y) = y$ , given the following
    arguments.</p>

<ul>
<li><code class="code">y0</code>, a predicted value for the new solution state (which must not be
      modified),</li>
<li><code class="code">ycor</code>, on input, an initial guess for the correction to the predicted
      states, and on output, the final correction to the predicted state,</li>
<li><code class="code">w</code>, a solution error-weight vector used for computing weighted error
      norms,</li>
<li><code class="code">tol</code>, the requested solution tolerance in the weighted
      root-mean-squared norm,</li>
<li><code class="code">callLSetup</code>, a flag indicating whether the integrator recommends
      calling the setup function, and,</li>
<li><code class="code">s</code>, the state to pass through to callbacks.</li>
</ul>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolSolve">SUNNonlinSolSolve</a></li></ul>
</div>
<h3 id="nlsset">Set functions</h3>
<pre><span id="TYPEsysfn"><span class="keyword">type</span> <code class="type">('nv, 's)</code> sysfn</span> = <code class="type">'nv -&gt; 'nv -&gt; 's -&gt; unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A function <code class="code">sysfn&nbsp;y&nbsp;fg&nbsp;mem</code> to evaluate the nonlinear system
    $F(y)$  (for <a href="Sundials_NonlinearSolver.html#TYPEt">RootFind</a>)
    or $G(y)$  (for <a href="Sundials_NonlinearSolver.html#TYPEt">FixedPoint</a>).
    The contents of <code class="code">y</code> must not be modified.</p>

<p>This function raises <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> to
    indicate a recoverable failure. Other exceptions signal unrecoverable
    failures.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolSysFn">SUNNonlinSolSysFn</a></li></ul>
</div>


<pre><span id="VALset_sys_fn"><span class="keyword">val</span> set_sys_fn</span> : <code class="type">('d, 'k, 's, [ `Nvec ]) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt;<br>       ('d, 's) <a href="Sundials_NonlinearSolver.html#TYPEsysfn">sysfn</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specify a system function callback.
    The system function specifies the problem, either $F(y)$  or
    $G(y)$ .</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolSetSysFn">SUNNonlinSolSetSysFn</a></li></ul>
</div>

<pre><span id="TYPElsetupfn"><span class="keyword">type</span> <code class="type">'s</code> lsetupfn</span> = <code class="type">bool -&gt; 's -&gt; bool</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A function to setup linear solves.
    For direct linear solvers, sets up the system $Ax = b$ 
    where $A = \frac{\partial F}{\partial y}$  is the linearization
    of the nonlinear residual function $F(y) = 0$ . For iterative
    linear solvers, calls a preconditioner setup function.</p>

<p>The call <code class="code">jcur&nbsp;=&nbsp;lsetupfn&nbsp;jbad&nbsp;mem</code> has as arguments <code class="code">jbad</code>, which
    indicates if the solver believes that $A$  has gone stale, and <code class="code">mem</code>,
    a token passed by the function provider. A true return value (<code class="code">jcur</code>)
    signals that the Jacobian $A$  has been updated.</p>

<p>This function raises <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> to
    indicate a recoverable failure. Other exceptions signal unrecoverable
    failures.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolLSetupFn">SUNNonlinSolLSetupFn</a></li></ul>
</div>


<pre><span id="VALset_lsetup_fn"><span class="keyword">val</span> set_lsetup_fn</span> : <code class="type">('d, 'k, 's, 'v) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt;<br>       's <a href="Sundials_NonlinearSolver.html#TYPElsetupfn">lsetupfn</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specify a linear solver setup callback.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolSetLSetupFn">SUNNonlinSolSetLSetupFn</a></li></ul>
</div>

<pre><span id="TYPElsolvefn"><span class="keyword">type</span> <code class="type">('nv, 's)</code> lsolvefn</span> = <code class="type">'nv -&gt; 's -&gt; unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A function to solve linear systems.
    Solves the system $Ax = b$  where
    $A = \frac{\partial F}{\partial y}$  is the linearization of the
    nonlinear residual function $F(y)= 0$ .</p>

<p>The call <code class="code">lsolvefn&nbsp;b&nbsp;mem</code> has as arguments</p>

<ul>
<li><code class="code">b</code>, on input: the right-hand-side vector for the linear solve,
           set on output to the solution $x$ ; and,</li>
<li><code class="code">mem</code>, a token passed by the function provider.</li>
</ul>
<p>This function raises <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> to
    indicate a recoverable failure. Other exceptions signal unrecoverable
    failures.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolLSolveFn">SUNNonlinSolLSolveFn</a></li></ul>
</div>


<pre><span id="VALset_lsolve_fn"><span class="keyword">val</span> set_lsolve_fn</span> : <code class="type">('d, 'k, 's, [ `Nvec ]) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt;<br>       ('d, 's) <a href="Sundials_NonlinearSolver.html#TYPElsolvefn">lsolvefn</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specify a linear solver callback.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolSetLSolveFn">SUNNonlinSolSetLSolveFn</a></li></ul>
</div>

<pre><code><span id="TYPEconvtest"><span class="keyword">type</span> <code class="type"></code>convtest</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconvtest.Success"><span class="constructor">Success</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Converged (<code class="code"><span class="constructor">SUN_NLS_SUCCESS</span></code>)</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconvtest.Continue"><span class="constructor">Continue</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Not converged, keep iterating (<code class="code"><span class="constructor">SUN_NLS_CONTINUE</span></code>)</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconvtest.Recover"><span class="constructor">Recover</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Appears to diverge, try to recover (<code class="code"><span class="constructor">SUN_NLS_CONV_RECVR</span></code>)</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Values returned by convergence tests.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolConvTestFn">SUNNonlinSolConvTestFn</a></li></ul>
</div>


<pre><span id="TYPEconvtestfn'"><span class="keyword">type</span> <code class="type">('nv, 's)</code> convtestfn'</span> = <code class="type">'nv -&gt; 'nv -&gt; float -&gt; 'nv -&gt; 's -&gt; <a href="Sundials_NonlinearSolver.html#TYPEconvtest">convtest</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>A function providing a convergence test.
    The call <code class="code">convtestfn&nbsp;y&nbsp;del&nbsp;tol&nbsp;ewt&nbsp;mem</code> has as arguments</p>
<ul>
<li><code class="code">y</code>,   the current nonlinear iterate,</li>
<li><code class="code">del</code>, the difference between current and prior nonlinear iterates,</li>
<li><code class="code">tol</code>, the nonlinear solver tolerance (in a weighted root-mean-squared
             norm with the given error-weight vector),</li>
<li><code class="code">ewt</code>, the error-weight vector used in computing weighted norms, and,</li>
<li><code class="code">mem</code>, a token passed by the function provider.</li>
</ul>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolConvTestFn">SUNNonlinSolConvTestFn</a></li></ul>
</div>


<pre><code><span id="TYPEconvtest_callback"><span class="keyword">type</span> <code class="type">'s</code> convtest_callback</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconvtest_callback.f">f</span>&nbsp;: <code class="type">'d1 'k1 't2 'd2 'k2.<br>         ('d1, 'k1, 't2, [ `Nvec ]) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt;<br>         (('d2, 'k2) <a href="Nvector.html#TYPEt">Nvector.t</a>, 's) <a href="Sundials_NonlinearSolver.html#TYPEconvtestfn'">convtestfn'</a></code>;</code></td>

</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>A convergence test callback provided by an integrator.
    Such callbacks require an additional first argument, the nonlinear solver
    invoking the function, and otherwise expect nvector arguments.
    They access the linear solver and nvector arguments using generic
    functions, which is why the type variables are universally quantified.</p>
</div>
</div>


<pre><code><span id="TYPEconvtest_callback_sens"><span class="keyword">type</span> <code class="type">'s</code> convtest_callback_sens</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconvtest_callback_sens.f">f</span>&nbsp;: <code class="type">'d1 'k1 't2 'd2 'k2.<br>         ('d1, 'k1, 't2, [ `Sens ]) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt;<br>         (('d2, 'k2) <a href="Sundials_NonlinearSolver.Senswrapper.html#TYPEt">Senswrapper.t</a>, 's)<br>         <a href="Sundials_NonlinearSolver.html#TYPEconvtestfn'">convtestfn'</a></code>;</code></td>

</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>A convergence test callback provided by an integrator with sensitivities.
    Such callbacks require an additional first argument, the nonlinear solver
    invoking the function, and otherwise expect senswrapper arguments.
    They access the linear solver and senswrapper arguments using generic
    functions, which is why the type variables are universally quantified.</p>
</div>
</div>


<pre><code><span id="TYPEconvtestfn"><span class="keyword">type</span> <code class="type">('nv, 's, 'v)</code> convtestfn</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconvtestfn.CConvTest"><span class="constructor">CConvTest</span></span> <span class="keyword">:</span> <code class="type">'s0 <a href="Sundials_NonlinearSolver.html#TYPEconvtest_callback">convtest_callback</a> <a href="Sundials.html#TYPEcfun">Sundials.cfun</a></code> <span class="keyword">-></span> <code class="type">('nv0, 's0, [ `Nvec ]) <a href="Sundials_NonlinearSolver.html#TYPEconvtestfn">convtestfn</a></code></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconvtestfn.CSensConvTest"><span class="constructor">CSensConvTest</span></span> <span class="keyword">:</span> <code class="type">'s1 <a href="Sundials_NonlinearSolver.html#TYPEconvtest_callback_sens">convtest_callback_sens</a> <a href="Sundials.html#TYPEcfun">Sundials.cfun</a></code> <span class="keyword">-></span> <code class="type">('nv1, 's1, [ `Sens ]) <a href="Sundials_NonlinearSolver.html#TYPEconvtestfn">convtestfn</a></code></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTconvtestfn.OConvTest"><span class="constructor">OConvTest</span></span> <span class="keyword">of</span> <code class="type">('nv, 's) <a href="Sundials_NonlinearSolver.html#TYPEconvtestfn'">convtestfn'</a></code></code></td>

</tr></table>

<div class="info ">
<div class="info-desc">
<p>A convergence test provided either by an integrator or a user program.
    The OCaml interface distinguishes callback functions set by the
    underlying library (<code class="code"><span class="constructor">CConvTest</span></code>) from those supplied by user programs
    (<code class="code"><span class="constructor">OConvTest</span></code>). This reflects the different underlying mechanisms used
    to create and invoke such functions. Callback functions provied by the
    underlying library can be invoked with any kind of linear solver and
    (homogeneous) nvectors since they manipulate these values generically.</p>
</div>
</div>


<pre><span id="VALassert_not_oconvtestfn"><span class="keyword">val</span> assert_not_oconvtestfn</span> : <code class="type">('nv1, 's, [ `Nvec ]) <a href="Sundials_NonlinearSolver.html#TYPEconvtestfn">convtestfn</a> -&gt;<br>       ('nv2, 's, [ `Nvec ]) <a href="Sundials_NonlinearSolver.html#TYPEconvtestfn">convtestfn</a></code></pre><div class="info ">
<div class="info-desc">
<p>Ignore the nvector type argument in a convtestfn.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span> <code>Invalid_argument</code> if the value was constructed with <code class="code"><span class="constructor">OConvTest</span></code></div>
</ul>
</div>

<pre><span id="VALset_convtest_fn"><span class="keyword">val</span> set_convtest_fn</span> : <code class="type">('d, 'k, 's, [ `Nvec ]) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt;<br>       ('d, 's, [ `Nvec ]) <a href="Sundials_NonlinearSolver.html#TYPEconvtestfn">convtestfn</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specify a convergence test callback for the nonlinear solver iteration.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolSetConvTestFn">SUNNonlinSolSetConvTestFn</a></li></ul>
</div>

<pre><span id="MODULESens"><span class="keyword">module</span> <a href="Sundials_NonlinearSolver.Sens.html">Sens</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Sundials_NonlinearSolver.Sens.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Support for nonlinear solvers with sensitivities.</p>

</div>

<pre><span id="VALset_max_iters"><span class="keyword">val</span> set_max_iters</span> : <code class="type">('d, 'k, 's, 'v) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt; int -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the maximum number of nonlinear solver iterations.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolSetMaxIters">SUNNonlinSolSetMaxIters</a></li></ul>
</div>

<pre><span id="VALset_info_file"><span class="keyword">val</span> set_info_file</span> : <code class="type">('d, 'k, 's, 'v) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt;<br>       ?print_level:bool -&gt; <a href="Sundials.Logfile.html#TYPEt">Sundials.Logfile.t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the output file for informative (non-error) messages. The default
    is to send such messages to stdout.
    The optional argument is a convenience for invoking <a href="Sundials_NonlinearSolver.html#VALset_print_level"><code class="code"><span class="constructor">Sundials_NonlinearSolver</span>.set_print_level</code></a>.</p>

<p>Sundials must be built with <span class="cconst">(SUNDIALS_BUILD_WITH_MONITORING)</span> to
    use this function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_links.html#c.SUNNonlinSolSetInfoFile_Newton">SUNNonlinSolSetInfoFile_Newton</a></li><li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_links.html#c.SUNNonlinSolSetInfoFile_FixedPoint">SUNNonlinSolSetInfoFile_FixedPoint</a></li></ul>
</div>

<pre><span id="VALset_print_level"><span class="keyword">val</span> set_print_level</span> : <code class="type">('d, 'k, 's, 'v) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt; bool -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the level of output verbosity. When <code class="code"><span class="keyword">false</span></code> (the default) no
    information is printed, when <code class="code"><span class="keyword">true</span></code> the residual norm is printed for
    each nonlinear iteration.</p>

<p>Sundials must be built with <span class="cconst">(SUNDIALS_BUILD_WITH_MONITORING)</span> to
    use this function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_links.html#c.SUNNonlinSolSetPrintLevel_Newton">SUNNonlinSolSetPrintLevel_Newton</a></li><li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_links.html#c.SUNNonlinSolSetPrintLevel_FixedPoint">SUNNonlinSolSetPrintLevel_FixedPoint</a></li></ul>
</div>
<h3 id="nlsget">Get functions</h3>
<pre><span id="VALget_num_iters"><span class="keyword">val</span> get_num_iters</span> : <code class="type">('d, 'k, 's, 'v) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of nonlinear solver iterations in the most recent solve.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolGetNumIters">SUNNonlinSolGetNumIters</a></li></ul>
</div>

<pre><span id="VALget_cur_iter"><span class="keyword">val</span> get_cur_iter</span> : <code class="type">('d, 'k, 's, 'v) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the iteration index of the current nonlinear solve.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolGetCurIter">SUNNonlinSolGetCurIter</a></li></ul>
</div>

<pre><span id="VALget_num_conv_fails"><span class="keyword">val</span> get_num_conv_fails</span> : <code class="type">('d, 'k, 's, 'v) <a href="Sundials_NonlinearSolver.html#TYPEt">t</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of nonlinear solver convergence failures in the most
    recent solve.</p>
</div>
<ul class="info-attributes">
<li class="sundials nonlinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunnonlinsol/SUNNonlinSol_API_link.html#c.SUNNonlinSolGetNumConvFails">SUNNonlinSolGetNumConvFails</a></li></ul>
</div>
<h3 id="nlssolvers">Nonlinear Solver Implementations</h3>
<pre><span id="MODULENewton"><span class="keyword">module</span> <a href="Sundials_NonlinearSolver.Newton.html">Newton</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Sundials_NonlinearSolver.Newton.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Generic nonlinear solver based on Newton's method.</p>

</div>

<pre><span id="MODULEFixedPoint"><span class="keyword">module</span> <a href="Sundials_NonlinearSolver.FixedPoint.html">FixedPoint</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Sundials_NonlinearSolver.FixedPoint.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Generic nonlinear solver for fixed-point (functional) iteration with
    optional Anderson acceleration.</p>

</div>

<pre><span id="MODULECustom"><span class="keyword">module</span> <a href="Sundials_NonlinearSolver.Custom.html">Custom</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Sundials_NonlinearSolver.Custom.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Custom nonlinear solvers.</p>

</div>
<h3 id="nlsexceptions">Exceptions</h3>
<pre><span id="EXCEPTIONVectorOpError"><span class="keyword">exception</span> VectorOpError</span></pre>
<div class="info ">
<div class="info-desc">
<p>An error occurred in a vector operation.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUN_NLS_VECTOROP_ERR         </li></ul>
</div>

<pre><span id="EXCEPTIONIncorrectUse"><span class="keyword">exception</span> IncorrectUse</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised when a nonlinear solver is used incorrectly.
    For example, calling <a href="Sundials_NonlinearSolver.html#VALsolve"><code class="code"><span class="constructor">Sundials_NonlinearSolver</span>.solve</code></a> without having first called <a href="Sundials_NonlinearSolver.html#VALset_sys_fn"><code class="code"><span class="constructor">Sundials_NonlinearSolver</span>.set_sys_fn</code></a>
    (<code class="code"><span class="constructor">SUN_NLS_MEM_NULL</span></code>).</p>
</div>
</div>

<pre><span id="EXCEPTIONExtFail"><span class="keyword">exception</span> ExtFail</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised if an external library call fails.</p>
</div>
</div>

<pre><span id="EXCEPTIONNonlinearSolverInUse"><span class="keyword">exception</span> NonlinearSolverInUse</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised on an attempt to associate a nonlinear solver instance with more
    than one session.</p>
</div>
</div>
</body></html>
