<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Kinsol.html">
<link rel="next" href="Arkode.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Sundials_parallel" rel="Chapter" href="Sundials_parallel.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Linear solvers" rel="Section" href="#linear">
<link title="Tolerances" rel="Section" href="#tols">
<link title="Initialization" rel="Section" href="#init">
<link title="Solution" rel="Section" href="#solver">
<link title="Modifying the solver (optional input functions)" rel="Section" href="#set">
<link title="Querying the solver (optional output functions)" rel="Section" href="#get">
<link title="Additional root-finding functions" rel="Section" href="#roots">
<link title="Advanced nonlinear solver functions" rel="Section" href="#nls">
<link title="Exceptions" rel="Section" href="#exceptions">
<link title="Initial Condition Calculation" rel="Subsection" href="#calcic">
<title>Sundials/ML 6.0.0p0 : Ida</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Kinsol.html" title="Kinsol">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Arkode.html" title="Arkode">Next</a>
</div>
<h1>Module <a href="type_Ida.html">Ida</a></h1>

<pre><span id="MODULEIda"><span class="keyword">module</span> Ida</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Ida.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>Variable-step solution of DAE initial value problems with
    zero-crossing detection.</p>

<p>This module solves numerically problems of the form
    $F(t, y, \dot{y})=0$, $y(t_0) = y_0$,
    $\dot{y}(t_0)=\dot{y}_0$.</p>

<p>This documented interface is structured as follows.</p>
<OL>
<li><a href="#linear">Linear solvers</a></li>
<li><a href="#tols">Tolerances</a></li>
<li><a href="#init">Initialization</a></li>
<li><a href="#solver">Solution</a></li>
<li><a href="#set">Modifying the solver</a></li>
<li><a href="#get">Querying the solver</a></li>
<li><a href="#roots">Additional root finding functions</a></li>
<li><a href="#nls">Advanced nonlinear solver functions</a></li>
<li><a href="#exceptions">Exceptions</a></li>
</OL>
</div>
<ul class="info-attributes">
<div class="authors"><b>Author(s):</b> Timothy Bourke (Inria/ENS), Jun Inoue (Inria/ENS), Marc Pouzet (UPMC/ENS/Inria)</div>
<li><b>Version:</b> 6.0.0</li>
</ul>
</div>
<hr width="100%">

<pre><span id="TYPEsession"><span class="keyword">type</span> <code class="type">('d, 'k)</code> session</span> = <code class="type">('d, 'k) session</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A session with the IDA solver.</p>

<p>An example session with Ida (<a href="ida_skel.ml">ida_skel.ml</a>):</p>
<pre class="codepre"><code class="code"><span class="keyword">open</span> <span class="constructor">Sundials</span>

<span class="comment">(* 1. Define a residual function. *)</span>
<span class="keyword">let</span> resf _t v v' r =
  r.{0} &lt;- v.{2}  -. v'.{0};
  r.{1} &lt;- v.{3}  -. v'.{1};
  r.{2} &lt;- v'.{2} -. v.{4} *. v.{0};
  r.{3} &lt;- v'.{3} -. v.{4} *. v.{1} +. 9.81;
  r.{4} &lt;- v.{2}*.v.{2} +. v'.{2}*.v.{0} +. v.{3}*.v'.{1} +. v'.{3}*.v.{1}

<span class="comment">(* 2. Optionally define a root function. *)</span>
<span class="keyword">let</span> g _t v _v' gout = gout.{0} &lt;- v.{0} -. v.{1} *. 0.5774

<span class="comment">(* 3. Set vector of initial values.
      The length of this vector determines the problem size. *)</span>
<span class="keyword">let</span> vd = <span class="constructor">RealArray</span>.of_list [ 0.9848; 0.1736; 0.0; 0.0; 0.0 ]
<span class="keyword">let</span> v  = <span class="constructor">Nvector_serial</span>.wrap vd
<span class="keyword">let</span> v' = <span class="constructor">Nvector_serial</span>.make 5 0.0

<span class="comment">(* 4. Create and initialize a solver session.
      This will initialize a specific linear solver and the root-finding
      mechanism, if necessary. *)</span>
<span class="keyword">let</span> m = <span class="constructor">Matrix</span>.dense 5
<span class="keyword">let</span> s = <span class="constructor">Ida</span>.(init (<span class="constructor">SStolerances</span> (1e-9, 1e-9))
                  ~lsolver:<span class="constructor">Dls</span>.(solver (dense v m))
                  resf ~roots:(1, g) 0.0 v v');;

<span class="comment">(* 5. Set optional inputs, e.g.,
      call [set_*] functions to change solver parameters. *)</span>
<span class="constructor">Ida</span>.set_stop_time s 10.0;
<span class="constructor">Ida</span>.set_all_root_directions s <span class="constructor">RootDirs</span>.<span class="constructor">Decreasing</span>;;

<span class="comment">(* 6. Correct initial values *)</span>
<span class="keyword">let</span> vids = <span class="constructor">Nvector_serial</span>.make 5 <span class="constructor">Ida</span>.<span class="constructor">VarId</span>.differential;;
(<span class="constructor">Nvector_serial</span>.unwrap vids).{4} &lt;- <span class="constructor">Ida</span>.<span class="constructor">VarId</span>.algebraic;

<span class="constructor">Ida</span>.set_suppress_alg s ~varid:vids <span class="keyword">true</span>;
<span class="constructor">Ida</span>.calc_ic_ya_yd' s ~y:v ~y':v' 0.1;;

<span class="comment">(* 7. Advance the solution in time,
      by repeatedly calling [solve_normal] or [solve_one_step]. *)</span>
<span class="keyword">let</span> <span class="keyword">rec</span> go (t, r) =
  <span class="constructor">Printf</span>.printf <span class="string">"% .10e\t% .10e\t% .10e\t% .10e\t% .10e\t% .10e\n"</span>
                t vd.{0} vd.{1} vd.{2} vd.{3} vd.{4};
  <span class="keyword">match</span> r <span class="keyword">with</span>
  <span class="keywordsign">|</span> <span class="constructor">Ida</span>.<span class="constructor">Success</span> <span class="keywordsign">-&gt;</span> go (<span class="constructor">Ida</span>.solve_normal s (t +. 0.05) v v')
  <span class="keywordsign">|</span> <span class="constructor">Ida</span>.<span class="constructor">RootsFound</span> <span class="keywordsign">-&gt;</span> <span class="keyword">begin</span>
         vd.{2} &lt;- -. 0.5 *. vd.{2};
         vd.{3} &lt;- -. 0.5 *. vd.{3};
         <span class="constructor">Ida</span>.reinit s t v v';
         <span class="constructor">Ida</span>.calc_ic_ya_yd' ~y:v ~y':v' s ~varid:vids (t +. 0.05);
          go (t, <span class="constructor">Ida</span>.<span class="constructor">Success</span>)
      <span class="keyword">end</span>
  <span class="keywordsign">|</span> <span class="constructor">Ida</span>.<span class="constructor">StopTimeReached</span> <span class="keywordsign">-&gt;</span> ();;

<span class="constructor">Printf</span>.printf <span class="string">"time\tx\ty\tx'\ty'\tp\n"</span>;;
go (0.0, <span class="constructor">Ida</span>.<span class="constructor">Success</span>);;

<span class="comment">(* 8. Get optional outputs,
      call the [get_*] functions to examine solver statistics. *)</span>
<span class="keyword">let</span> ns = <span class="constructor">Ida</span>.get_num_steps s
    </code></pre></div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#a-skeleton-of-the-users-main-program">Skeleton of main program</a></li></ul>
</div>


<pre><span id="TYPEserial_session"><span class="keyword">type</span> <code class="type">[&gt; <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_session</span> = <code class="type">(Sundials.RealArray.t, [&gt; <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a) <a href="Ida.html#TYPEsession">session</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>Alias for sessions based on serial nvectors.</p>
</div>
</div>

<h3 id="linear">Linear solvers</h3>
<pre><span id="TYPElinear_solver"><span class="keyword">type</span> <code class="type">('data, 'kind)</code> linear_solver</span> = <code class="type">('data, 'kind) linear_solver</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Linear solvers used by Ida.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#linear-solver-interface-functions">Linear solver interface functions</a></li></ul>
</div>


<pre><span id="TYPEserial_linear_solver"><span class="keyword">type</span> <code class="type">[&gt; <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_linear_solver</span> = <code class="type">(<a href="Nvector_serial.html#TYPEdata">Nvector_serial.data</a>, [&gt; <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a) <a href="Ida.html#TYPElinear_solver">linear_solver</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>Alias for linear solvers that are restricted to serial nvectors.</p>
</div>
</div>


<pre><span id="TYPEdouble"><span class="keyword">type</span> <code class="type">'d</code> double</span> = <code class="type">'d * 'd</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Workspaces with two temporary vectors.</p>
</div>
</div>


<pre><span id="TYPEtriple"><span class="keyword">type</span> <code class="type">'d</code> triple</span> = <code class="type">'d * 'd * 'd</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Workspaces with three temporary vectors.</p>
</div>
</div>


<pre><span id="TYPEjacobian_arg"><span class="keyword">type</span> <code class="type">('t, 'd)</code> jacobian_arg</span> = <code class="type">('t, 'd) jacobian_arg</code> = {</pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_t">jac_t</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The independent variable.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_y">jac_y</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The dependent variable vector.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_y'">jac_y'</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The derivative vector (i.e.
                                  $\frac{\mathrm{d}y}{\mathrm{d}t}$).</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_res">jac_res</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The current value of the residual vector.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_coef">jac_coef</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The coefficient $c_j$ in
                                 $J = \frac{\partial F}{\partial y} + c_j \frac{\partial F}{\partial\dot{y}}$.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_tmp">jac_tmp</span>&nbsp;: <code class="type">'t</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Workspace data.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Arguments common to Jacobian callback functions.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDALsJacFn">IDALsJacFn</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDALsJacTimesVecFn">IDALsJacTimesVecFn</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDALsPrecSolveFn">IDALsPrecSolveFn</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDALsPrecSetupFn">IDALsPrecSetupFn</a></li></ul>
</div>


<pre><span id="TYPEresfn"><span class="keyword">type</span> <code class="type">'d</code> resfn</span> = <code class="type">float -&gt; 'd -&gt; 'd -&gt; 'd -&gt; unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Residual functions that define a DAE problem. They are passed four
 * arguments:</p>
<ul>
<li><code class="code">t</code>, the value of the independent variable, i.e., the simulation time,</li>
<li><code class="code">y</code>, the vector of dependent-variable values, i.e., $y(t)$,</li>
<li><code class="code">y'</code>, the vector of dependent-variable derivatives, i.e.,
            $\dot{y} = \frac{\mathrm{d}y}{\mathrm{d}t}$, and,</li>
<li><code class="code">r</code> a vector for storing the residual value, $F(t, y, \dot{y})$.</li>
</ul>
<p>Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
    indicates a recoverable error. Any other exception is treated as an
    unrecoverable error.</p>

<p><div class="warningbox"> <code class="code">y</code>, <code class="code">y'</code>, and <code class="code">r</code> should not be accessed after the function
             returns.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAResFn">IDAResFn</a></li></ul>
</div>


<pre><span id="MODULEDls"><span class="keyword">module</span> <a href="Ida.Dls.html">Dls</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Ida.Dls.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Direct Linear Solvers operating on dense, banded and sparse matrices.</p>

</div>

<pre><span id="MODULESpils"><span class="keyword">module</span> <a href="Ida.Spils.html">Spils</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Ida.Spils.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Scaled Preconditioned Iterative Linear Solvers.</p>

</div>

<pre><span id="VALmatrix_embedded_solver"><span class="keyword">val</span> matrix_embedded_solver</span> : <code class="type">(unit, 'data, 'kind, [&gt; `MatE ]) Sundials.LinearSolver.t -&gt;<br>       ('data, 'kind) <a href="Ida.html#TYPElinear_solver">linear_solver</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create an IDA-specific linear solver from a generic matrix embedded
    solver.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.8.0</li>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetLinearSolver">IDASetLinearSolver</a></li></ul>
</div>
<h3 id="tols">Tolerances</h3>
<pre><span id="TYPEerror_weight_fun"><span class="keyword">type</span> <code class="type">'data</code> error_weight_fun</span> = <code class="type">'data -&gt; 'data -&gt; unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Functions that set the multiplicative error weights for use in the weighted
    RMS norm. The call <code class="code">efun&nbsp;y&nbsp;ewt</code> takes the dependent variable vector <code class="code">y</code> and
    fills the error-weight vector <code class="code">ewt</code> with positive values or raises
    <a href="Sundials.html#EXCEPTIONNonPositiveEwt"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">NonPositiveEwt</span></code></a>. Other exceptions are eventually propagated, but
    should be avoided (<code class="code">efun</code> is not allowed to abort the solver).</p>
</div>
</div>


<pre><code><span id="TYPEtolerance"><span class="keyword">type</span> <code class="type">('data, 'kind)</code> tolerance</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SStolerances"><span class="constructor">SStolerances</span></span> <span class="keyword">of</span> <code class="type">float * float</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><code class="code">(rel,&nbsp;abs)</code> : scalar relative and absolute tolerances.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SVtolerances"><span class="constructor">SVtolerances</span></span> <span class="keyword">of</span> <code class="type">float * ('data, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><code class="code">(rel,&nbsp;abs)</code> : scalar relative and vector absolute tolerances.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.WFtolerances"><span class="constructor">WFtolerances</span></span> <span class="keyword">of</span> <code class="type">'data <a href="Ida.html#TYPEerror_weight_fun">error_weight_fun</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Set the multiplicative error weights for the weighted RMS norm.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Tolerance specifications.</p>
</div>
</div>


<pre><span id="VALdefault_tolerances"><span class="keyword">val</span> default_tolerances</span> : <code class="type">('data, 'kind) <a href="Ida.html#TYPEtolerance">tolerance</a></code></pre><div class="info ">
<div class="info-desc">
<p>A default relative tolerance of 1.0e-4 and absolute tolerance of 1.0e-8.</p>
</div>
</div>
<h3 id="init">Initialization</h3>
<pre><span id="TYPErootsfn"><span class="keyword">type</span> <code class="type">'d</code> rootsfn</span> = <code class="type">float -&gt; 'd -&gt; 'd -&gt; Sundials.RealArray.t -&gt; unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Called by the solver to calculate the values of root functions. These
    ‘zero-crossings’ are used to detect significant events. The function is
    passed four arguments:</p>
<ul>
<li><code class="code">t</code>, the value of the independent variable, i.e., the simulation time,</li>
<li><code class="code">y</code>, the vector of dependent-variable values, i.e., $y(t)$,</li>
<li><code class="code">y'</code>, the vector of dependent-variable derivatives, i.e.,
            $\dot{y} = \frac{\mathrm{d}y}{\mathrm{d}t}$, and,</li>
<li><code class="code">gout</code>, a vector for storing the value of $g(t, y, \dot{y})$.</li>
</ul>
<p><div class="warningbox"> <code class="code">y</code>, <code class="code">y'</code>, and <code class="code">gout</code> should not be accessed after the function
             has returned.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDARootFn">IDARootFn</a></li></ul>
</div>


<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">?context:<a href="Sundials.Context.html#TYPEt">Sundials.Context.t</a> -&gt;<br>       ('d, 'kind) <a href="Ida.html#TYPEtolerance">tolerance</a> -&gt;<br>       ?nlsolver:('d, 'kind, ('d, 'kind) <a href="Ida.html#TYPEsession">session</a>, [ `Nvec ])<br>                 <a href="Sundials_NonlinearSolver.html#TYPEt">Sundials_NonlinearSolver.t</a> -&gt;<br>       ?nlsresfn:'d <a href="Ida.html#TYPEresfn">resfn</a> -&gt;<br>       lsolver:('d, 'kind) <a href="Ida.html#TYPElinear_solver">linear_solver</a> -&gt;<br>       'd <a href="Ida.html#TYPEresfn">resfn</a> -&gt;<br>       ?varid:('d, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt;<br>       ?roots:int * 'd <a href="Ida.html#TYPErootsfn">rootsfn</a> -&gt;<br>       float -&gt;<br>       ('d, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; ('d, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; ('d, 'kind) <a href="Ida.html#TYPEsession">session</a></code></pre><div class="info ">
<div class="info-desc">
<p>Creates and initializes a session with the solver. The call</p>
<pre class="codepre"><code class="code">init linsolv tol ~nlsolver ~nlsresfn ~lsolver f ~varid:varid ~roots:(nroots, g) t0 y0 y'0</code></pre><p>has as arguments:</p>
<ul>
<li><code class="code">tol</code>,     the integration tolerances,</li>
<li><code class="code">nlsolver</code>, the solver to use to calculate integration steps
                  and initial conditions,</li>
<li><code class="code">nlsresfn</code>, alternative residual function to use in
                  nonlinear system function evaluations,</li>
<li><code class="code">lsolver</code>,  used by <code class="code">nlsolver</code>s based on Newton interation,</li>
<li><code class="code">f</code>,       the DAE residual function,</li>
<li><code class="code">varid</code>,   optionally classifies variables as algebraic or differential,</li>
<li><code class="code">nroots</code>,  the number of root functions,</li>
<li><code class="code">g</code>,       the root function (<code class="code">(nroots,&nbsp;g)</code> defaults to <a href="Ida.html#VALno_roots"><code class="code"><span class="constructor">Ida</span>.no_roots</code></a>),</li>
<li><code class="code">t0</code>,      the initial value of the independent variable,</li>
<li><code class="code">y0</code>,      a vector of initial values that also determines the number
                 of equations, and,</li>
<li><code class="code">y'0</code>,     the initial values for
                 $\dot{y} = \frac{\mathrm{d}y}{\mathrm{d}t}$.</li>
</ul>
<p>This function does everything necessary to initialize a session, i.e.,
    it makes the calls referenced below. The <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> and
    <a href="Ida.html#VALsolve_one_step"><code class="code"><span class="constructor">Ida</span>.solve_one_step</code></a> functions may be called directly.</p>

<p>If an <code class="code">nlsolver</code> is not specified, then the
    <a href="Sundials_NonlinearSolver.Newton.html">Newton</a> module is used by default.
    The <code class="code">nlsolver</code> must be of type
    <a href="Sundials_NonlinearSolver.html#TYPEnonlinear_solver_type">RootFind</a>, otherwise an
    <a href="Ida.html#EXCEPTIONIllInput"><code class="code"><span class="constructor">Ida</span>.<span class="constructor">IllInput</span></code></a> exception is raised.</p>

<p>The alternative residual function for nonlinear system function
    evaluations is only supported for Sundials &gt;= 5.8.0.</p>

<p>By default, the session is created using the context returned by
    <a href="Sundials.Context.html#VALdefault"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">Context</span>.default</code></a>, but this can be overridden by passing an
    optional <code class="code">context</code> argument.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDACreate">IDACreate</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAInit">IDAInit</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDARootInit">IDARootInit</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetLinearSolver">IDASetLinearSolver</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetNonlinearSolver">IDASetNonlinearSolver</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASStolerances">IDASStolerances</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASVtolerances">IDASVtolerances</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAWFtolerances">IDAWFtolerances</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAEwtFn">IDAEwtFn</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetId">IDASetId</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetNlsResFn">IDASetNlsResFn</a></li></ul>
</div>

<pre><span id="VALno_roots"><span class="keyword">val</span> no_roots</span> : <code class="type">int * 'd <a href="Ida.html#TYPErootsfn">rootsfn</a></code></pre><div class="info ">
<div class="info-desc">
<p>A convenience value for signalling that there are no roots to monitor.</p>
</div>
</div>
<h4 id="calcic">Initial Condition Calculation</h4>
<pre><span id="MODULEVarId"><span class="keyword">module</span> <a href="Ida.VarId.html">VarId</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Ida.VarId.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Symbolic names for constants used when calculating initial values or
    supressing local error tests.</p>

</div>

<pre><span id="VALset_id"><span class="keyword">val</span> set_id</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Class components of the state vector as either algebraic or differential.
    These classifications are required by <a href="Ida.html#VALcalc_ic_ya_yd'"><code class="code"><span class="constructor">Ida</span>.calc_ic_ya_yd'</code></a> and
    <a href="Ida.html#VALset_suppress_alg"><code class="code"><span class="constructor">Ida</span>.set_suppress_alg</code></a>. See also <a href="Ida.VarId.html"><code class="code"><span class="constructor">Ida</span>.<span class="constructor">VarId</span></code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetId">IDASetId</a></li></ul>
</div>

<pre><span id="VALset_suppress_alg"><span class="keyword">val</span> set_suppress_alg</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; ?varid:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; bool -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Indicates whether or not to ignore algebraic variables in the local error
    test. When ignoring algebraic variables (<code class="code"><span class="keyword">true</span></code>), a <code class="code">varid</code> vector must be
    specified either in the call or by a prior call to <a href="Ida.html#VALinit"><code class="code"><span class="constructor">Ida</span>.init</code></a> or <a href="Ida.html#VALset_id"><code class="code"><span class="constructor">Ida</span>.set_id</code></a>.
    Suppressing local error tests for algebraic variables is <i>discouraged</i>
    for DAE systems of index 1 and <i>encouraged</i> for systems of index 2 or
    more.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetId">IDASetId</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetSuppressAlg">IDASetSuppressAlg</a></li></ul>
</div>

<pre><span id="VALcalc_ic_y"><span class="keyword">val</span> calc_ic_y</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; ?y:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; float -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Computes the initial state vector for certain index-one problems.
    All components of $y$ are computed, using $\dot{y}$, to satisfy
    the constraint $F(t_0, y_0, \dot{y}_0) = 0$. If given, the
    <code class="code">~y</code> vector is filled with the corrected values. The last argument is
    the first vale of $t$ at which a solution will be requested.
    A <a href="Ida.html#VALreinit"><code class="code"><span class="constructor">Ida</span>.reinit</code></a> is required before calling this function after
    <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> or <a href="Ida.html#VALsolve_one_step"><code class="code"><span class="constructor">Ida</span>.solve_one_step</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span> <code>IdNotSet</code> Variable ids have not been set (see <a href="Ida.html#VALset_id"><code class="code"><span class="constructor">Ida</span>.set_id</code></a>).</div>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDACalcIC">IDACalcIC (IDA_Y_INIT)</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetConsistentIC">IDAGetConsistentIC</a></li></ul>
</div>

<pre><span id="VALcalc_ic_ya_yd'"><span class="keyword">val</span> calc_ic_ya_yd'</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt;<br>       ?y:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt;<br>       ?y':('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; ?varid:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; float -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Computes the algebraic components of the initial state and derivative
    vectors for certain index-one problems.
    The elements of $y$ and $\dot{y}$ marked as algebraic are computed,
    using $\dot{y}$, to satisfy the constraint
    $F(t_0, y_0, \dot{y}_0) = 0$.
    The variable ids must be given in <code class="code">~varid</code> or by a prior call to <a href="Ida.html#VALinit"><code class="code"><span class="constructor">Ida</span>.init</code></a> or
    <a href="Ida.html#VALset_id"><code class="code"><span class="constructor">Ida</span>.set_id</code></a>.
    If given, the <code class="code">~y</code> and <code class="code">~y'</code> vectors are filled with the corrected values.
    The last argument is the first vale of $t$ at which a solution will be
    requested. A <a href="Ida.html#VALreinit"><code class="code"><span class="constructor">Ida</span>.reinit</code></a> is required before calling this function after
    <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> or <a href="Ida.html#VALsolve_one_step"><code class="code"><span class="constructor">Ida</span>.solve_one_step</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span> <code>IdNotSet</code> Variable ids have not been set (see <a href="Ida.html#VALset_id"><code class="code"><span class="constructor">Ida</span>.set_id</code></a>).</div>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDACalcIC">IDACalcIC (IDA_YA_YDP_INIT)</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetId">IDASetId</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetConsistentIC">IDAGetConsistentIC</a></li></ul>
</div>

<pre><span id="VALset_nonlin_conv_coef_ic"><span class="keyword">val</span> set_nonlin_conv_coef_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the positive constant in the nonlinear convergence test
    of the initial condition calculation.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetNonlinConvCoefIC">IDASetNonlinConvCoefIC</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDACalcIC">IDACalcIC</a></li></ul>
</div>

<pre><span id="VALset_max_num_steps_ic"><span class="keyword">val</span> set_max_num_steps_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of steps taken in attempting to reach
    a given output time in the initial condition calculation.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetMaxNumStepsIC">IDASetMaxNumStepsIC</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDACalcIC">IDACalcIC (IDA_YA_YDP_INIT)</a></li></ul>
</div>

<pre><span id="VALset_max_num_jacs_ic"><span class="keyword">val</span> set_max_num_jacs_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of approximate Jacobian or preconditioner
    evaluations allowed when the Newton iteration appears to be slowly
    converging.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetMaxNumJacsIC">IDASetMaxNumJacsIC</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDACalcIC">IDACalcIC</a></li></ul>
</div>

<pre><span id="VALset_max_num_iters_ic"><span class="keyword">val</span> set_max_num_iters_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of Newton iterations allowed in any one
    attempt to calculate initial conditions.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetMaxNumItersIC">IDASetMaxNumItersIC</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDACalcIC">IDACalcIC</a></li></ul>
</div>

<pre><span id="VALset_max_backs_ic"><span class="keyword">val</span> set_max_backs_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of linesearch backtracks allowed in any
    Newton iteration, when solving the initial conditions calculation
    problem.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 2.7.0</li>
<div class="raisedexceptions"><span class="raises">Raises</span> <code>Config.NotImplementedBySundialsVersion</code> Feature not available.</div>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetMaxBacksIC">IDASetMaxBacksIC</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDACalcIC">IDACalcIC</a></li></ul>
</div>

<pre><span id="VALset_line_search_ic"><span class="keyword">val</span> set_line_search_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; bool -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Enables (<code class="code"><span class="keyword">true</span></code>) or disables (<code class="code"><span class="keyword">false</span></code>) the linesearch algorithm
    in the initial condition calculation.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetLineSearchOffIC">IDASetLineSearchOffIC</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDACalcIC">IDACalcIC</a></li></ul>
</div>

<pre><span id="VALset_step_tolerance_ic"><span class="keyword">val</span> set_step_tolerance_ic</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a positive lower bound on the Newton step in the initial condition
    calculation.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetStepToleranceIC">IDASetStepToleranceIC</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDACalcIC">IDACalcIC</a></li></ul>
</div>

<pre><span id="VALget_num_backtrack_ops"><span class="keyword">val</span> get_num_backtrack_ops</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of backtrack operations during <a href="Ida.html#VALcalc_ic_ya_yd'"><code class="code"><span class="constructor">Ida</span>.calc_ic_ya_yd'</code></a> or
    <a href="Ida.html#VALcalc_ic_y"><code class="code"><span class="constructor">Ida</span>.calc_ic_y</code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetNumBacktrackOps">IDAGetNumBacktrackOps</a></li></ul>
</div>
<h3 id="solver">Solution</h3>
<pre><code><span id="TYPEsolver_result"><span class="keyword">type</span> <code class="type"></code>solver_result</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.Success"><span class="constructor">Success</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The solution was advanced. <span class="cconst">(IDA_SUCCESS)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.RootsFound"><span class="constructor">RootsFound</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>A root was found. See <a href="Ida.html#VALget_root_info"><code class="code"><span class="constructor">Ida</span>.get_root_info</code></a>.
                            <span class="cconst">(IDA_ROOT_RETURN)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.StopTimeReached"><span class="constructor">StopTimeReached</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The stop time was reached. See <a href="Ida.html#VALset_stop_time"><code class="code"><span class="constructor">Ida</span>.set_stop_time</code></a>.
                            <span class="cconst">(IDA_TSTOP_RETURN)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Values returned by the step functions. Failures are indicated by
    exceptions.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASolve">IDASolve</a></li></ul>
</div>


<pre><span id="VALsolve_normal"><span class="keyword">val</span> solve_normal</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt;<br>       float -&gt;<br>       ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; float * <a href="Ida.html#TYPEsolver_result">solver_result</a></code></pre><div class="info ">
<div class="info-desc">
<p>Integrates a DAE system over an interval. The call
    <code class="code">tret,&nbsp;r&nbsp;=&nbsp;solve_normal&nbsp;s&nbsp;tout&nbsp;yout&nbsp;y'out</code> has as arguments</p>
<ul>
<li><code class="code">s</code>, a solver session,</li>
<li><code class="code">tout</code> the next time at which the solution is desired,</li>
<li><code class="code">yout</code>, a vector to store the computed solution, and,</li>
<li><code class="code">y'out</code>, a vector to store the computed derivative.</li>
</ul>
<p>It returns <code class="code">tret</code>, the time reached by the solver, which will be equal to
    <code class="code">tout</code> if no errors occur, and, <code class="code">r</code>, a <a href="Ida.html#TYPEsolver_result"><code class="code"><span class="constructor">Ida</span>.solver_result</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>IllInput</code> Missing or illegal solver inputs.</li>
<li><code>TooMuchWork</code> The requested time could not be reached in <code class="code">mxstep</code> internal steps.</li>
<li><code>TooMuchAccuracy</code> The requested accuracy could not be satisfied.</li>
<li><code>ErrFailure</code> Too many error test failures within a step or at the minimum step size.</li>
<li><code>ConvergenceFailure</code> Too many convergence test failures within a step or at the minimum step size.</li>
<li><code>LinearInitFailure</code> Linear solver initialization failed.</li>
<li><code>LinearSetupFailure</code> Linear solver setup failed unrecoverably.</li>
<li><code>LinearSolveFailure</code> Linear solver solution failed unrecoverably.</li>
<li><code>ConstraintFailure</code> Inequality constraints were violated and recovery is not possible.</li>
<li><code>RepeatedResFuncFailure</code> The residual function repeatedly returned a recoverable error but the solver could not recover.</li>
<li><code>ResFuncFailure</code> The residual function failed unrecoverably.</li>
<li><code>RootFuncFailure</code> Failure in the rootfinding function <code class="code">g</code>.</li>
</ul></div>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASolve">IDASolve (IDA_NORMAL)</a></li></ul>
</div>

<pre><span id="VALsolve_one_step"><span class="keyword">val</span> solve_one_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt;<br>       float -&gt;<br>       ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; float * <a href="Ida.html#TYPEsolver_result">solver_result</a></code></pre><div class="info ">
<div class="info-desc">
<p>Like <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> but returns after one internal solver step.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASolve">IDASolve (IDA_ONE_STEP)</a></li></ul>
</div>

<pre><span id="VALget_dky"><span class="keyword">val</span> get_dky</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; float -&gt; int -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the interpolated solution or derivatives.
    <code class="code">get_dky&nbsp;s&nbsp;dky&nbsp;t&nbsp;k</code> computes the <code class="code">k</code>th derivative of the function at time
    <code class="code">t</code>, i.e., $\frac{d^\mathtt{k}y(\mathtt{t})}{\mathit{dt}^\mathtt{k}}$,
    and stores it in <code class="code">dky</code>. The arguments must satisfy
    $t_n - h_u \leq \mathtt{t} \leq t_n$—where $t_n$
    denotes <a href="Ida.html#VALget_current_time"><code class="code"><span class="constructor">Ida</span>.get_current_time</code></a> and $h_u$ denotes <a href="Ida.html#VALget_last_step"><code class="code"><span class="constructor">Ida</span>.get_last_step</code></a>,—
    and $0 \leq \mathtt{k} \leq q_u$—where $q_u$ denotes
    <a href="Ida.html#VALget_last_order"><code class="code"><span class="constructor">Ida</span>.get_last_order</code></a>.</p>

<p>This function may only be called after a successful return from either
    <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> or <a href="Ida.html#VALsolve_one_step"><code class="code"><span class="constructor">Ida</span>.solve_one_step</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadT</code> <code class="code">t</code> is not in the interval $[t_n - h_u, t_n]$.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range 0, 1, ..., $q_u$.</li>
</ul></div>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetDky">IDAGetDky</a></li></ul>
</div>

<pre><span id="VALreinit"><span class="keyword">val</span> reinit</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt;<br>       ?nlsolver:('d, 'k, ('d, 'k) <a href="Ida.html#TYPEsession">session</a>, [ `Nvec ])<br>                 <a href="Sundials_NonlinearSolver.html#TYPEt">Sundials_NonlinearSolver.t</a> -&gt;<br>       ?nlsresfn:'d <a href="Ida.html#TYPEresfn">resfn</a> -&gt;<br>       ?lsolver:('d, 'k) <a href="Ida.html#TYPElinear_solver">linear_solver</a> -&gt;<br>       ?roots:int * 'd <a href="Ida.html#TYPErootsfn">rootsfn</a> -&gt;<br>       ?resfn:'d <a href="Ida.html#TYPEresfn">resfn</a> -&gt;<br>       float -&gt; ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Reinitializes the solver with new parameters and state values. The
    values of the independent variable, i.e., the simulation time, the
    state variables, and the derivatives must be given.
    If the argument <code class="code">~linsolv</code> is not given, the current linear solver
    remains unchanged. The argument <code class="code">~roots</code> works similarly; pass
    <a href="Ida.html#VALno_roots"><code class="code"><span class="constructor">Ida</span>.no_roots</code></a> to disable root finding. The <code class="code">~resfn</code> argument gives the
    possibility to change the residual function. Similarly for <code class="code">~nlsresfn</code>
    and the alternative residual function for nonlinear system function
    iterations.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAReInit">IDAReInit</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetLinearSolver">IDASetLinearSolver</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetNonlinearSolver">IDASetNonlinearSolver</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetNlsResFn">IDASetNlsResFn</a></li></ul>
</div>
<h3 id="set">Modifying the solver (optional input functions)</h3>
<pre><span id="VALset_tolerances"><span class="keyword">val</span> set_tolerances</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; ('d, 'k) <a href="Ida.html#TYPEtolerance">tolerance</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set the integration tolerances.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASStolerances">IDASStolerances</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASVtolerances">IDASVtolerances</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAWFtolerances">IDAWFtolerances</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAEwtFn">IDAEwtFn</a></li></ul>
</div>

<pre><span id="VALset_error_file"><span class="keyword">val</span> set_error_file</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; <a href="Sundials.Logfile.html#TYPEt">Sundials.Logfile.t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Configure the default error handler to write messages to a file.
    By default it writes to Logfile.stderr.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetErrFile">IDASetErrFile</a></li></ul>
</div>

<pre><span id="VALset_err_handler_fn"><span class="keyword">val</span> set_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; (<a href="Sundials.Util.html#TYPEerror_details">Sundials.Util.error_details</a> -&gt; unit) -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a custom function for handling error messages.
    The handler must not fail: any exceptions are trapped and discarded.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetErrHandlerFn">IDASetErrHandlerFn</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAErrHandlerFn">IDAErrHandlerFn</a></li></ul>
</div>

<pre><span id="VALclear_err_handler_fn"><span class="keyword">val</span> clear_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Restores the default error handling function.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetErrHandlerFn">IDASetErrHandlerFn</a></li></ul>
</div>

<pre><span id="VALset_max_ord"><span class="keyword">val</span> set_max_ord</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum order of the linear multistep method.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetMaxOrd">IDASetMaxOrd</a></li></ul>
</div>

<pre><span id="VALset_max_num_steps"><span class="keyword">val</span> set_max_num_steps</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of steps taken in attempting to reach
    a given output time.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetMaxNumSteps">IDASetMaxNumSteps</a></li></ul>
</div>

<pre><span id="VALset_init_step"><span class="keyword">val</span> set_init_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the initial step size.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetInitStep">IDASetInitStep</a></li></ul>
</div>

<pre><span id="VALset_max_step"><span class="keyword">val</span> set_max_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies an upper bound on the magnitude of the step size.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetMaxStep">IDASetMaxStep</a></li></ul>
</div>

<pre><span id="VALset_stop_time"><span class="keyword">val</span> set_stop_time</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Limits the value of the independent variable <code class="code">t</code> when solving.
    By default no stop time is imposed.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetStopTime">IDASetStopTime</a></li></ul>
</div>

<pre><span id="VALset_max_err_test_fails"><span class="keyword">val</span> set_max_err_test_fails</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of error test failures permitted in attempting
    one step.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetMaxErrTestFails">IDASetMaxErrTestFails</a></li></ul>
</div>

<pre><span id="VALset_max_nonlin_iters"><span class="keyword">val</span> set_max_nonlin_iters</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of nonlinear solver iterations permitted per
    step.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetMaxNonlinIters">IDASetMaxNonlinIters</a></li></ul>
</div>

<pre><span id="VALset_max_conv_fails"><span class="keyword">val</span> set_max_conv_fails</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of nonlinear solver convergence failures
    permitted during one step.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetMaxConvFails">IDASetMaxConvFails</a></li></ul>
</div>

<pre><span id="VALset_nonlin_conv_coef"><span class="keyword">val</span> set_nonlin_conv_coef</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the safety factor used in the nonlinear convergence test.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetNonlinConvCoef">IDASetNonlinConvCoef</a></li></ul>
</div>

<pre><span id="VALset_constraints"><span class="keyword">val</span> set_constraints</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a vector defining inequality constraints for each
    component of the solution vector <code class="code">u</code>.  See <a href="Sundials.Constraint.html"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">Constraint</span></code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetConstraints">IDASetConstraints</a></li></ul>
</div>

<pre><span id="VALclear_constraints"><span class="keyword">val</span> clear_constraints</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Disables constraint checking.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetConstraints">IDASetConstraints</a></li></ul>
</div>
<h3 id="get">Querying the solver (optional output functions)</h3>
<pre><span id="VALget_work_space"><span class="keyword">val</span> get_work_space</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the sizes of the real and integer workspaces.</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">real_size</code>, <code class="code">integer_size</code>)</li>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetWorkSpace">IDAGetWorkSpace</a></li></ul>
</div>

<pre><span id="VALget_num_steps"><span class="keyword">val</span> get_num_steps</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of internal solver steps.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetNumSteps">IDAGetNumSteps</a></li></ul>
</div>

<pre><span id="VALget_num_res_evals"><span class="keyword">val</span> get_num_res_evals</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls to the residual function.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetNumResEvals">IDAGetNumResEvals</a></li></ul>
</div>

<pre><span id="VALget_num_lin_solv_setups"><span class="keyword">val</span> get_num_lin_solv_setups</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls made to the linear solver's setup function.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetNumLinSolvSetups">IDAGetNumLinSolvSetups</a></li></ul>
</div>

<pre><span id="VALget_num_err_test_fails"><span class="keyword">val</span> get_num_err_test_fails</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of local error test failures that have occurred.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetNumErrTestFails">IDAGetNumErrTestFails</a></li></ul>
</div>

<pre><span id="VALget_last_order"><span class="keyword">val</span> get_last_order</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integration method order used during the last internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetLastOrder">IDAGetLastOrder</a></li></ul>
</div>

<pre><span id="VALget_current_order"><span class="keyword">val</span> get_current_order</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integration method order to be used on the next internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetCurrentOrder">IDAGetCurrentOrder</a></li></ul>
</div>

<pre><span id="VALget_last_step"><span class="keyword">val</span> get_last_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integration step size taken on the last internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetLastStep">IDAGetLastStep</a></li></ul>
</div>

<pre><span id="VALget_current_step"><span class="keyword">val</span> get_current_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integration step size to be attempted on the next internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetCurrentStep">IDAGetCurrentStep</a></li></ul>
</div>

<pre><span id="VALget_actual_init_step"><span class="keyword">val</span> get_actual_init_step</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the the value of the integration step size used on the first step.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetActualInitStep">IDAGetActualInitStep</a></li></ul>
</div>

<pre><span id="VALget_current_time"><span class="keyword">val</span> get_current_time</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the the current internal time reached by the solver.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetCurrentTime">IDAGetCurrentTime</a></li></ul>
</div>

<pre><span id="VALget_tol_scale_factor"><span class="keyword">val</span> get_tol_scale_factor</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns a suggested factor by which the user's tolerances should be scaled
    when too much accuracy has been requested for some internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetTolScaleFactor">IDAGetTolScaleFactor</a></li></ul>
</div>

<pre><span id="VALget_err_weights"><span class="keyword">val</span> get_err_weights</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the solution error weights at the current time.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetErrWeights">IDAGetErrWeights</a></li></ul>
</div>

<pre><span id="VALget_est_local_errors"><span class="keyword">val</span> get_est_local_errors</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the vector of estimated local errors.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetEstLocalErrors">IDAGetEstLocalErrors</a></li></ul>
</div>

<pre><code><span id="TYPEintegrator_stats"><span class="keyword">type</span> <code class="type"></code>integrator_stats</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_steps">num_steps</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Cumulative number of internal solver steps.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_res_evals">num_res_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of calls to the residual function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_lin_solv_setups">num_lin_solv_setups</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of setups calls to the linear solver.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_err_test_fails">num_err_test_fails</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of local error test failures.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.last_order">last_order</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Integration method order used in the last internal step.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_order">current_order</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Integration method order to be used in the next internal step.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.actual_init_step">actual_init_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Integration step sized used on the first step.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.last_step">last_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Integration step size of the last internal step.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_step">current_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Integration step size to attempt on the next internal step.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_time">current_time</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Current internal time reached by the solver.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Summaries of integrator statistics.</p>
</div>
</div>


<pre><span id="VALget_integrator_stats"><span class="keyword">val</span> get_integrator_stats</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; <a href="Ida.html#TYPEintegrator_stats">integrator_stats</a></code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integrator statistics as a group.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetIntegratorStats">IDAGetIntegratorStats</a></li></ul>
</div>

<pre><span id="VALprint_integrator_stats"><span class="keyword">val</span> print_integrator_stats</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; Stdlib.out_channel -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Prints the integrator statistics on the given channel.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetIntegratorStats">IDAGetIntegratorStats</a></li></ul>
</div>

<pre><span id="VALget_num_nonlin_solv_iters"><span class="keyword">val</span> get_num_nonlin_solv_iters</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear (functional or Newton)
    iterations.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetNumNonlinSolvIters">IDAGetNumNonlinSolvIters</a></li></ul>
</div>

<pre><span id="VALget_num_nonlin_solv_conv_fails"><span class="keyword">val</span> get_num_nonlin_solv_conv_fails</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear convergence failures.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetNumNonlinSolvConvFails">IDAGetNumNonlinSolvConvFails</a></li></ul>
</div>

<pre><span id="VALget_nonlin_solv_stats"><span class="keyword">val</span> get_nonlin_solv_stats</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns both the numbers of nonlinear iterations performed <code class="code">nniters</code> and
    nonlinear convergence failures <code class="code">nncfails</code>.</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">nniters</code>, <code class="code">nncfails</code>)</li>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetNonlinSolvStats">IDAGetNonlinSolvStats</a></li></ul>
</div>
<h3 id="roots">Additional root-finding functions</h3>
<pre><span id="VALset_root_direction"><span class="keyword">val</span> set_root_direction</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> array -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">set_root_direction&nbsp;s&nbsp;dir</code> specifies the direction of zero-crossings to be
    located and returned. <code class="code">dir</code> may contain one entry for each root function.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetRootDirection">IDASetRootDirection</a></li></ul>
</div>

<pre><span id="VALset_all_root_directions"><span class="keyword">val</span> set_all_root_directions</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Like <a href="Ida.html#VALset_root_direction"><code class="code"><span class="constructor">Ida</span>.set_root_direction</code></a> but specifies a single direction for all root
    functions.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetRootDirection">IDASetRootDirection</a></li></ul>
</div>

<pre><span id="VALset_no_inactive_root_warn"><span class="keyword">val</span> set_no_inactive_root_warn</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Disables issuing a warning if some root function appears to be identically
    zero at the beginning of the integration.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDASetNoInactiveRootWarn">IDASetNoInactiveRootWarn</a></li></ul>
</div>

<pre><span id="VALget_num_roots"><span class="keyword">val</span> get_num_roots</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of root functions.</p>
</div>
</div>

<pre><span id="VALget_root_info"><span class="keyword">val</span> get_root_info</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; <a href="Sundials.Roots.html#TYPEt">Sundials.Roots.t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Fills an array showing which functions were found to have a root.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetRootInfo">IDAGetRootInfo</a></li></ul>
</div>

<pre><span id="VALget_num_g_evals"><span class="keyword">val</span> get_num_g_evals</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of calls made to the user-supplied root
    function g.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetNumGEvals">IDAGetNumGEvals</a></li></ul>
</div>
<h3 id="nls">Advanced nonlinear solver functions</h3>
<p>These advanced functions may be useful for writing customized nonlinear
    solver routines.</p>

<pre><span id="VALget_current_cj"><span class="keyword">val</span> get_current_cj</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the scalar $c_j$ , which is proportional to the inverse of
    the step size.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetCurrentCj">IDAGetCurrentCj</a></li></ul>
</div>

<pre><span id="VALget_current_y"><span class="keyword">val</span> get_current_y</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; 'd</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the current $y$  vector. This vector provides direct access
    to the data within the integrator.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetCurrentY">IDAGetCurrentY</a></li></ul>
</div>

<pre><span id="VALget_current_yp"><span class="keyword">val</span> get_current_yp</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; 'd</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the current $\dot{y}$  vector. This vector provides direct
    access to the data within the integrator.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetCurrentYp">IDAGetCurrentYp</a></li></ul>
</div>

<pre><code><span id="TYPEnonlin_system_data"><span class="keyword">type</span> <code class="type">'d</code> nonlin_system_data</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.tn">tn</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Independent variable value $t_n$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.yypred">yypred</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Predicted value of $y_{\mathit{pred}}$  at $t_n$ . This
        data must not be changed.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.yppred">yppred</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Predicted value of $\dot{y}_{\mathit{pred}}$  at $t_n$ . This
        data must not be changed.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.yyn">yyn</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The vector $y_n$ . This data may not be current and may
        need to be filled.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.ypn">ypn</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The vector $\dot{y}_n$ . This data may not be current and may
        need to be filled.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.res">res</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The residual function evaluated at the current time and state,
        $F(t_n, y_n, \dot{y}_n)$ . * This data may not be current and
        may need to be filled.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.cj">cj</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The scalar $c_j$  which is proportional to the inverse of
        the step size $\alpha$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Internal data required to construct the current nonlinear implicit
    system within a nonlinear solver.</p>
</div>
</div>


<pre><span id="VALget_nonlin_system_data"><span class="keyword">val</span> get_nonlin_system_data</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt; 'd <a href="Ida.html#TYPEnonlin_system_data">nonlin_system_data</a></code></pre><div class="info ">
<div class="info-desc">
<p>Gives direct access to the internal data required to construct the
    current nonlinear system within a nonlinear solver. This
    function should be called inside the nonlinear system function.
    If the nonlinear solver uses the <code class="code">lsetup</code> or <code class="code">lsolve</code> functions, then
    the nonlinear solver system function must fill the <code class="code">yyn</code>, <code class="code">ypn</code>, and <code class="code">res</code>
    vectors with, respectively:
    $\mathit{yyn} = y_{\mathit{pred}} + y_{\mathit{cor}}$ ,
    $\mathit{ypn} = \dot{y}_{\mathit{pred}} + \alpha\dot{y}_{\mathit{cor}}$ ,
    and
    $\mathit{res} = F(t_n, y_n, \dot{y}_n)$  where
    $y_{\mathit{cor}}$  is the
    first argument of the nonlinear solver system function. Within a custom
    linear solver, then the vectors <code class="code">yyn</code>, <code class="code">ypn</code>, and <code class="code">res</code> are only current
    after an evaluation of the nonlinear system function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetNonlinearSystemData">IDAGetNonlinearSystemData</a></li></ul>
</div>

<pre><span id="VALcompute_y"><span class="keyword">val</span> compute_y</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt;<br>       ycor:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; y:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Computes the current $y$  vector from a correction vector.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAComputeY">IDAComputeY</a></li></ul>
</div>

<pre><span id="VALcompute_yp"><span class="keyword">val</span> compute_yp</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">session</a> -&gt;<br>       ycor:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; yp:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -&gt; unit</code></pre><div class="info ">
<div class="info-desc">
<p>Computes the current $\dot{y}$  vector from a correction vector.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAComputeYp">IDAComputeYp</a></li></ul>
</div>
<h3 id="exceptions">Exceptions</h3>
<pre><span id="EXCEPTIONIllInput"><span class="keyword">exception</span> IllInput</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised on missing or illegal solver inputs. Also raised if an element
    of the error weight vector becomes zero during time stepping, or the
    linear solver initialization function failed, or a root was found both at
    <code class="code">t</code> and very near <code class="code">t</code>.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_ILL_INPUT</a></li></ul>
</div>

<pre><span id="EXCEPTIONTooMuchWork"><span class="keyword">exception</span> TooMuchWork</span></pre>
<div class="info ">
<div class="info-desc">
<p>The requested time could not be reached in <code class="code">mxstep</code> internal steps.
    See <a href="Ida.html#VALset_max_num_steps"><code class="code"><span class="constructor">Ida</span>.set_max_num_steps</code></a></p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_TOO_MUCH_WORK</a></li></ul>
</div>

<pre><span id="EXCEPTIONTooMuchAccuracy"><span class="keyword">exception</span> TooMuchAccuracy</span></pre>
<div class="info ">
<div class="info-desc">
<p>The requested accuracy could not be satisfied.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_TOO_MUCH_ACC</a></li></ul>
</div>

<pre><span id="EXCEPTIONErrFailure"><span class="keyword">exception</span> ErrFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Too many error test failures within a step. See <a href="Ida.html#VALset_max_err_test_fails"><code class="code"><span class="constructor">Ida</span>.set_max_err_test_fails</code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_ERR_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONConvergenceFailure"><span class="keyword">exception</span> ConvergenceFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Too many convergence test failures within a step,
    or Newton convergence failed. See <a href="Ida.html#VALset_max_conv_fails"><code class="code"><span class="constructor">Ida</span>.set_max_conv_fails</code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_CONV_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONLinearInitFailure"><span class="keyword">exception</span> LinearInitFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Linear solver initialization failed.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_LINIT_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONLinearSetupFailure"><span class="keyword">exception</span> LinearSetupFailure</span> <span class="keyword">of</span> <code class="type">exn option</code></pre>
<div class="info ">
<div class="info-desc">
<p>Linear solver setup failed in an unrecoverable manner.
    If possible, the exception in the underlying linear solver is specified.
    It is typically one of
    <a href="Sundials_LinearSolver.html#EXCEPTIONZeroInDiagonal"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">ZeroInDiagonal</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONPSetFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PSetFailure</span></code></a>,
    or
    <a href="Sundials_LinearSolver.html#EXCEPTIONPackageFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PackageFailure</span></code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetLastLinFlag">IDAGetLastLinFlag</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_LSETUP_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONLinearSolveFailure"><span class="keyword">exception</span> LinearSolveFailure</span> <span class="keyword">of</span> <code class="type">exn option</code></pre>
<div class="info ">
<div class="info-desc">
<p>Linear solver solution failed in an unrecoverable manner.
    If possible, the exception in the underlying linear solver is specified.
    It is typically one of
    <a href="Sundials_LinearSolver.html#EXCEPTIONZeroInDiagonal"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">ZeroInDiagonal</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONATimesFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">ATimesFailure</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONPSolveFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PSolveFailure</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONGSFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">GSFailure</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONQRSolFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">QRSolFailure</span></code></a>,
    or
    <a href="Sundials_LinearSolver.html#EXCEPTIONPackageFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PackageFailure</span></code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetLastLinFlag">IDAGetLastLinFlag</a></li><li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_LSOLVE_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONNonlinearSolverFailure"><span class="keyword">exception</span> NonlinearSolverFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The nonlinear solver failed in a general way.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">CV_NLS_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONNonlinearInitFailure"><span class="keyword">exception</span> NonlinearInitFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Nonlinear solver initialization failed.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_NLS_INIT_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONNonlinearSetupFailure"><span class="keyword">exception</span> NonlinearSetupFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Nonlinear solver setup failed in an unrecoverable manner.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_NLS_SETUP_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONNonlinearSetupRecoverable"><span class="keyword">exception</span> NonlinearSetupRecoverable</span></pre>
<div class="info ">
<div class="info-desc">
<p>Nonlinear solver setup failed in a recoverable manner.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_NLS_SETUP_RECVR</a></li></ul>
</div>

<pre><span id="EXCEPTIONResFuncFailure"><span class="keyword">exception</span> ResFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The residual function failed in an unrecoverable manner.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_RES_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONFirstResFuncFailure"><span class="keyword">exception</span> FirstResFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The residual function had a recoverable error when first called.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_FIRST_RES_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONRepeatedResFuncFailure"><span class="keyword">exception</span> RepeatedResFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Too many convergence test failures, or unable to estimate the initial step
    size, due to repeated recoverable errors in the residual function.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_REP_RES_ERR</a></li></ul>
</div>

<pre><span id="EXCEPTIONRootFuncFailure"><span class="keyword">exception</span> RootFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The rootfinding function failed.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_RTFUNC_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONConstraintFailure"><span class="keyword">exception</span> ConstraintFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>No solution satisfying the inequality constraints could be found.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_CONSTR_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONLinesearchFailure"><span class="keyword">exception</span> LinesearchFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Linesearch could not find a solution with a step larger than steptol in
    weighted RMS norm.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_LINESEARCH_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONNoRecovery"><span class="keyword">exception</span> NoRecovery</span></pre>
<div class="info ">
<div class="info-desc">
<p>A recoverable error occurred in a callback but no recovery was possible.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_NO_RECOVERY</a></li></ul>
</div>

<pre><span id="EXCEPTIONBadEwt"><span class="keyword">exception</span> BadEwt</span></pre>
<div class="info ">
<div class="info-desc">
<p>A component of the error weight vector, either for the input value or a
    corrected value, is zero.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_BAD_EWT</a></li></ul>
</div>

<pre><span id="EXCEPTIONBadK"><span class="keyword">exception</span> BadK</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised by <a href="Ida.html#VALget_dky"><code class="code"><span class="constructor">Ida</span>.get_dky</code></a> for invalid order values.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetDky">IDAGetDky (IDA_BAD_K)</a></li></ul>
</div>

<pre><span id="EXCEPTIONBadT"><span class="keyword">exception</span> BadT</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised by <a href="Ida.html#VALget_dky"><code class="code"><span class="constructor">Ida</span>.get_dky</code></a> for invalid time values.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Usage/index.html#c.IDAGetDky">IDAGetDky (IDA_BAD_T)</a></li></ul>
</div>

<pre><span id="EXCEPTIONIdNotSet"><span class="keyword">exception</span> IdNotSet</span></pre>
<div class="info ">
<div class="info-desc">
<p>Variable ids are required but not set. See <a href="Ida.html#VALset_id"><code class="code"><span class="constructor">Ida</span>.set_id</code></a>.</p>
</div>
</div>

<pre><span id="EXCEPTIONVectorOpErr"><span class="keyword">exception</span> VectorOpErr</span></pre>
<div class="info ">
<div class="info-desc">
<p>A fused vector operation failed.</p>
</div>
<ul class="info-attributes">
<li class="sundials ida">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/ida/Constants_link.html">IDA_VECTOROP_ERR</a></li></ul>
</div>
</body></html>
