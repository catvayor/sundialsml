<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Arkode.ARKStep.Dls.html">
<link rel="next" href="Arkode.ARKStep.Mass.html">
<link rel="Up" href="Arkode.ARKStep.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials_Logfile" rel="Chapter" href="Sundials_Logfile.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Preconditioners" rel="Section" href="#arkspilsprecond">
<link title="Solvers" rel="Section" href="#arkspilslsolvers">
<link title="Solver parameters" rel="Section" href="#arkspilsset">
<link title="Solver statistics" rel="Section" href="#arkspilsstats">
<link title="Low-level solver manipulation" rel="Section" href="#arkspilslowlevel">
<title>Sundials/ML 5.8.0p0 : Arkode.ARKStep.Spils</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Arkode.ARKStep.Dls.html" title="Arkode.ARKStep.Dls">Previous</a>
&nbsp;<a class="up" href="Arkode.ARKStep.html" title="Arkode.ARKStep">Up</a>
&nbsp;<a class="post" href="Arkode.ARKStep.Mass.html" title="Arkode.ARKStep.Mass">Next</a>
</div>
<h1>Module <a href="type_Arkode.ARKStep.Spils.html">Arkode.ARKStep.Spils</a></h1>

<pre><span id="MODULESpils"><span class="keyword">module</span> Spils</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Arkode.ARKStep.Spils.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>Scaled Preconditioned Iterative Linear Solvers.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>Description of the SUNLinearSolver module</div></ul>
</div>
<hr width="100%">

<pre><span class="keyword">include</span> <a href="Sundials_LinearSolver.Iterative.html">Sundials_LinearSolver.Iterative</a></pre>

<pre><span class="keyword">include</span> <a href="Arkode.Spils.html">Arkode.Spils</a></pre>
<h4 id="arkspilsprecond">Preconditioners</h4>
<pre><span id="VALprec_none"><span class="keyword">val</span> prec_none</span> : <code class="type">('d, 'k, <a href="Arkode.html#TYPEarkstep">Arkode.arkstep</a>) preconditioner</code></pre><div class="info ">
<div class="info-desc">
<p>No preconditioning.</p>
</div>
</div>

<pre><span id="VALprec_left"><span class="keyword">val</span> prec_left</span> : <code class="type">?setup:'d prec_setup_fn -><br>       'd prec_solve_fn -> ('d, 'k, <a href="Arkode.html#TYPEarkstep">Arkode.arkstep</a>) preconditioner</code></pre><div class="info ">
<div class="info-desc">
<p>Left preconditioning. $(P^{-1}A)x = P^{-1}b$ .</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetPreconditioner</div></ul>
</div>

<pre><span id="VALprec_right"><span class="keyword">val</span> prec_right</span> : <code class="type">?setup:'d prec_setup_fn -><br>       'd prec_solve_fn -> ('d, 'k, <a href="Arkode.html#TYPEarkstep">Arkode.arkstep</a>) preconditioner</code></pre><div class="info ">
<div class="info-desc">
<p>Right preconditioning. $(AP^{-1})Px = b$ .</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetPreconditioner</div></ul>
</div>

<pre><span id="VALprec_both"><span class="keyword">val</span> prec_both</span> : <code class="type">?setup:'d prec_setup_fn -><br>       'd prec_solve_fn -> ('d, 'k, <a href="Arkode.html#TYPEarkstep">Arkode.arkstep</a>) preconditioner</code></pre><div class="info ">
<div class="info-desc">
<p>Left and right preconditioning.
        $(P_L^{-1}AP_R^{-1})P_Rx = P_L^{-1}b$</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetPreconditioner</div></ul>
</div>
<h4 id="arkspilslsolvers">Solvers</h4>
<pre><span id="VALsolver"><span class="keyword">val</span> solver</span> : <code class="type">('m, 'd, 'k, [> `Iter ]) Sundials.LinearSolver.t -><br>       ?jac_times_vec:'d jac_times_setup_fn option * 'd jac_times_vec_fn -><br>       ?jac_times_rhs:'d rhsfn -><br>       ('d, 'k, <a href="Arkode.html#TYPEarkstep">Arkode.arkstep</a>) preconditioner -><br>       ('d, 'k) <a href="Arkode.ARKStep.html#TYPElinear_solver">Arkode.ARKStep.linear_solver</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create an ARKStep-specific linear solver from a generic iterative
        linear solver.</p>

<p>The <code class="code">jac_times_rhs</code> argument specifies an alternative right-hand-side
        function for use in the internal Jacobian-vector product difference
        quotient approximation. It is incorrect to specify both this argument
        and <code class="code">jac_times_vec</code>.</p>

<p>NB: a <code class="code">jac_times_setup_fn</code> is not supported in
            <a href="Sundials_Config.html#VALsundials_version">Config.sundials_version</a> &lt; 3.0.0.</p>

<p>NB: a <code class="code">jac_times_rhs</code> function is not supported in
            <a href="Sundials_Config.html#VALsundials_version">Config.sundials_version</a> &lt; 5.3.0.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 3.0.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetLinearSolver</div><div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetJacTimes</div><div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetJacTimesRhsFn</div></ul>
</div>
<h4 id="arkspilsset">Solver parameters</h4>
<pre><span id="VALset_jac_eval_frequency"><span class="keyword">val</span> set_jac_eval_frequency</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the maximum number of time steps to wait before recomputation of
        the Jacobian or recommendation to update the preconditioner. If the
        integer argument is less than or equal to 0, a default value of 50 is
        used.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 4.0.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetJacEvalFrequency</div></ul>
</div>

<pre><span id="VALset_linear_solution_scaling"><span class="keyword">val</span> set_linear_solution_scaling</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> bool -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Enables or disables scaling of the linear system solution to account
        for a change in $\gamma$  in the linear system.
        Linear solution scaling is enabled by default when a matrix-based
        linear solver is attached.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.2.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetLinearSolutionScaling</div></ul>
</div>

<pre><span id="VALset_eps_lin"><span class="keyword">val</span> set_eps_lin</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the factor by which the Krylov linear solver's convergence test
        constant is reduced from the Newton iteration test constant.
        This factor must be &gt;= 0; passing 0 specifies the default (0.05).</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetEpsLin</div></ul>
</div>

<pre><span id="VALset_ls_norm_factor"><span class="keyword">val</span> set_ls_norm_factor</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the factor for converting from the integrator tolerance (WRMS
        norm) to the linear solver tolerance (L2 norm). That is,
        $\mathit{tol}_{\mathsf{L2}} =
            \mathit{fact}\cdot\mathit{tol}_{\mathsf{WRMS}}$ .
        The given value is used directly if it is greater than zero.
        If it is zero (the default), then the square root of the state
        vector length is used.
        If it is less than zero, then the square root of the dot product of a
        state vector full of ones with itself is used.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetLSNormFactor</div></ul>
</div>
<h4 id="arkspilsstats">Solver statistics</h4>
<pre><span id="VALget_work_space"><span class="keyword">val</span> get_work_space</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the sizes of the real and integer workspaces used by the spils
        linear solver.</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">real_size</code>, <code class="code">integer_size</code>)</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepGetLinWorkSpace</div></ul>
</div>

<pre><span id="VALget_num_lin_iters"><span class="keyword">val</span> get_num_lin_iters</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of linear iterations.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepGetNumLinIters</div></ul>
</div>

<pre><span id="VALget_num_lin_conv_fails"><span class="keyword">val</span> get_num_lin_conv_fails</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of linear convergence failures.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepGetNumLinConvFails</div></ul>
</div>

<pre><span id="VALget_num_prec_evals"><span class="keyword">val</span> get_num_prec_evals</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of calls to the setup function with
        <code class="code">jok=<span class="keyword">false</span></code>.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepGetNumPrecEvals</div></ul>
</div>

<pre><span id="VALget_num_prec_solves"><span class="keyword">val</span> get_num_prec_solves</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of calls to the preconditioner solve
        function.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepGetNumPrecSolves</div></ul>
</div>

<pre><span id="VALget_num_jtsetup_evals"><span class="keyword">val</span> get_num_jtsetup_evals</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of calls to the Jacobian-vector
        setup function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 3.0.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepGetNumJTSetupEvals</div></ul>
</div>

<pre><span id="VALget_num_jtimes_evals"><span class="keyword">val</span> get_num_jtimes_evals</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of calls to the Jacobian-vector
        function.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepGetNumJtimesEvals</div></ul>
</div>

<pre><span id="VALget_num_lin_rhs_evals"><span class="keyword">val</span> get_num_lin_rhs_evals</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls to the right-hand side callback for
        finite difference Jacobian-vector product approximation. This counter is
        only updated if the default difference quotient function is used.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepGetNumLinRhsEvals</div></ul>
</div>
<h4 id="arkspilslowlevel">Low-level solver manipulation</h4>
<p>The <a href="Arkode.ARKStep.html#VALinit"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ARKStep</span>.init</code></a> and <a href="Arkode.ARKStep.html#VALreinit"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ARKStep</span>.reinit</code></a> functions are the preferred way to set or
        change preconditioner functions. These low-level functions are
        provided for experts who want to avoid resetting internal counters
        and other associated side-effects.</p>

<pre><span id="VALset_preconditioner"><span class="keyword">val</span> set_preconditioner</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -><br>       ?setup:'d prec_setup_fn -> 'd prec_solve_fn -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Change the preconditioner functions.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetPreconditioner</div><div class="sundials"><span class="seesundials">See sundials: </span>ARKLsPrecSolveFn</div><div class="sundials"><span class="seesundials">See sundials: </span>ARKLsPrecSetupFn</div></ul>
</div>

<pre><span id="VALset_jac_times"><span class="keyword">val</span> set_jac_times</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -><br>       ?jac_times_setup:'d jac_times_setup_fn -> 'd jac_times_vec_fn -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Change the Jacobian-times-vector function.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetJacTimes</div><div class="sundials"><span class="seesundials">See sundials: </span>ARKLsJacTimesVecFn</div></ul>
</div>

<pre><span id="VALclear_jac_times"><span class="keyword">val</span> clear_jac_times</span> : <code class="type">('d, 'k) <a href="Arkode.ARKStep.html#TYPEsession">Arkode.ARKStep.session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Remove a Jacobian-times-vector function and use the default
        implementation.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ARKStepSetJacTimes</div></ul>
</div>
</body></html>
