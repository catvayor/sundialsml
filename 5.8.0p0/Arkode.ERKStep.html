<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Arkode.ARKStep.html">
<link rel="next" href="Arkode.MRIStep.html">
<link rel="Up" href="Arkode.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials_Logfile" rel="Chapter" href="Sundials_Logfile.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Solver initialization and use" rel="Section" href="#erksolver">
<link title="Modifying the solver (optional input functions)" rel="Section" href="#erksetin">
<link title="Querying the solver (optional output functions)" rel="Section" href="#erkget">
<link title="Additional root-finding functions" rel="Section" href="#erkroots">
<link title="Optional inputs for IVP method selection" rel="Subsection" href="#erksetivp">
<link title="Optional inputs for time step adaptivity" rel="Subsection" href="#erksetadap">
<title>Sundials/ML 5.8.0p0 : Arkode.ERKStep</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Arkode.ARKStep.html" title="Arkode.ARKStep">Previous</a>
&nbsp;<a class="up" href="Arkode.html" title="Arkode">Up</a>
&nbsp;<a class="post" href="Arkode.MRIStep.html" title="Arkode.MRIStep">Next</a>
</div>
<h1>Module <a href="type_Arkode.ERKStep.html">Arkode.ERKStep</a></h1>

<pre><span id="MODULEERKStep"><span class="keyword">module</span> ERKStep</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Arkode.ERKStep.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>ERKStep Time-Stepping Module for nonstiff initial value problems.</p>

<p>This module solves problems of the form
    $\dot{y} = f(t, y)$, $y(t_0) = y_0$.</p>

<p>Its interface is structured as follows.</p>
<OL>
<li><a href="#erksolver">Solver initialization and use</a></li>
<li><a href="#erkset">Modifying the solver</a></li>
<li><a href="#erkget">Querying the solver</a></li>
<li><a href="#erkroots">Additional root finding functions</a></li>
</OL>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>Using ERKStep for C and C++ Applications</div></ul>
</div>
<hr width="100%">

<pre><span class="keyword">include</span> <a href="Arkode.Common.html">Arkode.Common</a></pre>

<pre><span id="TYPEsession"><span class="keyword">type</span> <code class="type">('d, 'k)</code> session</span> = <code class="type">('d, 'k, <a href="Arkode.html#TYPEerkstep">Arkode.erkstep</a>) session</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A session with the ERKStep time-stepping solver.</p>

<p>An example session with ERKStep (<a href="arkode_erk_skel.ml">arkode_erk_skel.ml</a>):</p>
<pre class="codepre"><code class="code"><span class="keyword">open</span> <span class="constructor">Sundials</span>
<span class="keyword">module</span> <span class="constructor">ERKStep</span> = <span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>

<span class="comment">(* 1. Define right-hand-side functions. *)</span>
<span class="keyword">let</span> f t y yd = yd.{0} &lt;- y.{1};
               yd.{1} &lt;- -9.81

<span class="comment">(* 2. Optionally define a root function. *)</span>
<span class="keyword">let</span> g t y gout = gout.{0} &lt;- 1.0 -. y.{0}

<span class="comment">(* 3. Set vector of initial values.
      The length of this vector determines the problem size. *)</span>
<span class="keyword">let</span> yd = <span class="constructor">RealArray</span>.of_list [ 10.0; 0.0 ]
<span class="keyword">let</span> y = <span class="constructor">Nvector_serial</span>.wrap yd

<span class="comment">(* 4. Create and initialize a solver session. *)</span>
<span class="keyword">let</span> s = <span class="constructor">ERKStep</span>.(init (<span class="constructor">SStolerances</span> (1e-4, 1e-9)) f ~roots:(1, g) 0.0 y);;

<span class="comment">(* 5. Set optional inputs, e.g.,
      call [set_*] functions to change solver parameters. *)</span>
<span class="constructor">ERKStep</span>.set_stop_time s 10.0;;
<span class="constructor">ERKStep</span>.set_all_root_directions s <span class="constructor">RootDirs</span>.<span class="constructor">Increasing</span>;;

<span class="comment">(* 6. Advance the solution in time,
      by repeatedly calling [evolve_normal] or [evolve_one_step]. *)</span>
<span class="keyword">let</span> <span class="keyword">rec</span> go (t, r) =
  <span class="constructor">Printf</span>.printf <span class="string">"% .10e\t% .10e\t% .10e\n"</span> t yd.{0} yd.{1};
  <span class="keyword">match</span> r <span class="keyword">with</span>
  <span class="keywordsign">|</span> <span class="constructor">ERKStep</span>.<span class="constructor">Success</span> <span class="keywordsign">-&gt;</span> go (<span class="constructor">ERKStep</span>.evolve_normal s (t +. 0.5) y)
  <span class="keywordsign">|</span> <span class="constructor">ERKStep</span>.<span class="constructor">RootsFound</span> <span class="keywordsign">-&gt;</span> <span class="keyword">begin</span>
        yd.{1} &lt;- -0.8 *. yd.{1};
        <span class="constructor">ERKStep</span>.reinit s t y;
        go (t, <span class="constructor">ERKStep</span>.<span class="constructor">Success</span>)
      <span class="keyword">end</span>
  <span class="keywordsign">|</span> <span class="constructor">ERKStep</span>.<span class="constructor">StopTimeReached</span> <span class="keywordsign">-&gt;</span> ();;

<span class="constructor">Printf</span>.printf <span class="string">"time\ty\ty'\n"</span>;;
go (0.0, <span class="constructor">ERKStep</span>.<span class="constructor">Success</span>);;

<span class="comment">(* 7. Get optional outputs,
      call the [get_*] functions to examine solver statistics. *)</span>
<span class="keyword">let</span> ns = <span class="constructor">ERKStep</span>.get_num_steps s
      </code></pre></div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>Skeleton of main program</div></ul>
</div>

<h3 id="erksolver">Solver initialization and use</h3>
<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">('data, 'kind) tolerance -><br>       ?order:int -><br>       'data rhsfn -><br>       ?roots:int * 'data rootsfn -><br>       float -> ('data, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('data, 'kind) <a href="Arkode.ERKStep.html#TYPEsession">session</a></code></pre><div class="info ">
<div class="info-desc">
<p>Creates and initializes a session with the solver. The call</p>
<pre class="codepre"><code class="code">init tol ~order f ~roots:(nroots, g) t0 y0</code></pre><p>has as arguments:</p>
<ul>
<li><code class="code">tol</code>,    the integration tolerances,</li>
<li><code class="code">order</code>,  the order of accuracy for the integration method,</li>
<li><code class="code">f</code>,      the ODE right-hand side function,</li>
<li><code class="code">nroots</code>, the number of root functions,</li>
<li><code class="code">g</code>,      the root function (<code class="code">(nroots,&nbsp;g)</code> defaults to
                  <a href="Arkode.Common.html#VALno_roots"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">Common</span>.no_roots</code></a>),</li>
<li><code class="code">t0</code>,     the initial value of the independent variable, and</li>
<li><code class="code">y0</code>,     a vector of initial values that also determines the number
                  of equations.</li>
</ul>
<p>This function does everything necessary to initialize a session, i.e.,
      it makes the calls referenced below. The <a href="Arkode.ERKStep.html#VALevolve_normal"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.evolve_normal</code></a> and
      <a href="Arkode.ERKStep.html#VALevolve_one_step"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.evolve_one_step</code></a> functions may be called directly.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 4.0.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepCreate</div><div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetOrder</div><div class="sundials"><span class="seesundials">See sundials: </span>ERKStepRootInit</div><div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSStolerances</div><div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSVtolerances</div><div class="sundials"><span class="seesundials">See sundials: </span>ERKStepWFtolerances</div></ul>
</div>

<pre><span id="VALevolve_normal"><span class="keyword">val</span> evolve_normal</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -><br>       float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float * solver_result</code></pre><div class="info ">
<div class="info-desc">
<p>Integrates an ODE system over an interval. The call
      <code class="code">tret,&nbsp;r&nbsp;=&nbsp;evolve_normal&nbsp;s&nbsp;tout&nbsp;yout</code> has as arguments</p>
<ul>
<li><code class="code">s</code>, a solver session,</li>
<li><code class="code">tout</code>, the next time at which a solution is desired, and,</li>
<li><code class="code">yout</code>, a vector to store the computed solution.</li>
</ul>
<p>It returns <code class="code">tret</code>, the time reached by the solver, which will be equal to
      <code class="code">tout</code> if no errors occur, and, <code class="code">r</code>, a <a href="Arkode.Common.html#TYPEsolver_result"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">Common</span>.solver_result</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>IllInput</code> Missing or illegal solver inputs.</li>
<li><code>TooMuchWork</code> The requested time could not be reached in <code class="code">mxstep</code> internal steps.</li>
<li><code>TooMuchAccuracy</code> The requested accuracy could not be satisfied.</li>
<li><code>ErrFailure</code> Too many error test failures within a step or at the minimum step size.</li>
<li><code>RhsFuncFailure</code> Unrecoverable failure in one of the RHS functions.</li>
<li><code>FirstRhsFuncFailure</code> Initial unrecoverable failure in one of the RHS functions.</li>
<li><code>RepeatedRhsFuncFailure</code> Too many convergence test failures, or unable to estimate the initial step size, due to repeated recoverable errors in one of the right-hand side functions.</li>
<li><code>UnrecoverableRhsFuncFailure</code> One of the right-hand side functions had a recoverable error, but no recovery was possible. This error can only occur after an error test failure at order one.</li>
<li><code>RootFuncFailure</code> Failure in the rootfinding function <code class="code">g</code>.</li>
</ul></div>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepEvolve (ARK_NORMAL)</div></ul>
</div>

<pre><span id="VALevolve_one_step"><span class="keyword">val</span> evolve_one_step</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -><br>       float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float * solver_result</code></pre><div class="info ">
<div class="info-desc">
<p>Like <a href="Arkode.ERKStep.html#VALevolve_normal"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.evolve_normal</code></a> but returns after one internal solver step.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepEvolve (ARK_ONE_STEP)</div></ul>
</div>

<pre><span id="VALget_dky"><span class="keyword">val</span> get_dky</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the interpolated solution or derivatives.
      <code class="code">get_dky&nbsp;s&nbsp;dky&nbsp;t&nbsp;k</code> computes the <code class="code">k</code>th derivative of the function
      at time <code class="code">t</code>, i.e.,
      $\frac{d^\mathtt{k}}{\mathit{dt}^\mathtt{k}}y(\mathtt{t})$,
      and stores it in <code class="code">dky</code>. The arguments must satisfy
      $t_n - h_n \leq \mathtt{t} \leq t_n$—where $t_n$
      denotes <a href="Arkode.ERKStep.html#VALget_current_time"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.get_current_time</code></a> and $h_n$ denotes <a href="Arkode.ERKStep.html#VALget_last_step"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.get_last_step</code></a>,—
      and $0 \leq \mathtt{k} \leq 3$.</p>

<p>This function may only be called after a successful return from either
      <a href="Arkode.ERKStep.html#VALevolve_normal"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.evolve_normal</code></a> or <a href="Arkode.ERKStep.html#VALevolve_one_step"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.evolve_one_step</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadT</code> <code class="code">t</code> is not in the interval $[t_n - h_n, t_n]$.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range {0, 1, ..., dord}.</li>
</ul></div>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetDky</div></ul>
</div>

<pre><span id="VALreinit"><span class="keyword">val</span> reinit</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -><br>       ?order:int -> ?roots:int * 'd rootsfn -> float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Reinitializes the solver with new parameters and state values. The
      values of the independent variable, i.e., the simulation time, and the
      state variables must be given. If given, <code class="code">order</code> changes the order of
      accuracy, and <code class="code">roots</code> specifies a new root finding function. The new
      problem must have the same size as the previous one.</p>

<p>The allowed values for <code class="code">order</code> are as for <a href="Arkode.ERKStep.html#VALinit"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.init</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepReInit</div><div class="sundials"><span class="seesundials">See sundials: </span>ERKStepRootInit</div><div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetOrder</div></ul>
</div>

<pre><span id="VALreset"><span class="keyword">val</span> reset</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Resets the state to the given independent variable value and dependent
      variable vector. All previously set options, internal counter values,
      and step-size/error histories are retained.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepReset</div></ul>
</div>

<pre><span id="VALresize"><span class="keyword">val</span> resize</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -><br>       ?resize_nvec:'d resize_fn -><br>       ('d, 'k) tolerance -> float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Change the number of equations and unknowns between integrator steps.
      The call
      <code class="code">resize&nbsp;s&nbsp;~resize_nvec:rfn&nbsp;tol&nbsp;hscale&nbsp;ynew&nbsp;t0</code>
      has as arguments:</p>
<ul>
<li><code class="code">s</code>, the solver session to resize,</li>
<li><code class="code">rfn</code>, a resize function that transforms nvectors in place-otherwise
               they are simply destroyed and recloned,</li>
<li><code class="code">tol</code>, tolerance values (ensures that any tolerance vectors are resized),</li>
<li><code class="code">hscale</code>, the next step will be of size $h \mathtt{hscale}$,</li>
<li><code class="code">ynew</code>, the newly-sized solution vector with the value $y(t_0)$, and</li>
<li><code class="code">t0</code>, the current value of the independent variable $t_0$.</li>
</ul>
<p>A call to this function disables inequality constraint checking. It can
      be reenabled by calling <a href="Arkode.ERKStep.html#VALset_constraints"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.set_constraints</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepResize</div></ul>
</div>
<h3 id="erksetin">Modifying the solver (optional input functions)</h3>
<pre><span id="VALset_tolerances"><span class="keyword">val</span> set_tolerances</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> ('d, 'k) tolerance -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the integration tolerances.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSStolerances</div><div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSVtolerances</div><div class="sundials"><span class="seesundials">See sundials: </span>ERKStepWFtolerances</div></ul>
</div>

<pre><span id="VALset_defaults"><span class="keyword">val</span> set_defaults</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Resets all optional input parameters to their default values. Neither
      the problem-defining functions nor the root-finding functions are
      changed.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetDefaults</div></ul>
</div>

<pre><span id="VALset_diagnostics"><span class="keyword">val</span> set_diagnostics</span> : <code class="type">?logfile:Sundials.Logfile.t -> ('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Write step adaptivity and solver diagnostics on the standard output
      (or given file).</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetDiagnostics</div></ul>
</div>

<pre><span id="VALset_interpolant_type"><span class="keyword">val</span> set_interpolant_type</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> interpolant_type -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the interpolation module used for output value interpolation
      and implicit method predictors.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.2.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetInterpolantType</div></ul>
</div>

<pre><span id="VALset_interpolant_degree"><span class="keyword">val</span> set_interpolant_degree</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the degree of the polynomial interpolant used for output
      values and implicit method predictors.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.2.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetInterpolantDegree</div></ul>
</div>

<pre><span id="VALclear_diagnostics"><span class="keyword">val</span> clear_diagnostics</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Do not write step adaptivity or solver diagnostics of a file.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetDiagnostics</div></ul>
</div>

<pre><span id="VALset_error_file"><span class="keyword">val</span> set_error_file</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> Sundials.Logfile.t -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Configure the default error handler to write messages to a file.
      By default it writes to Logfile.stderr.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetErrFile</div></ul>
</div>

<pre><span id="VALset_err_handler_fn"><span class="keyword">val</span> set_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -><br>       (<a href="Sundials.Util.html#TYPEerror_details">Sundials.Util.error_details</a> -> unit) -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a custom function for handling error messages.
      The handler must not fail: any exceptions are trapped and discarded.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetErrHandlerFn</div><div class="sundials"><span class="seesundials">See sundials: </span>ARKErrHandlerFn</div></ul>
</div>

<pre><span id="VALclear_err_handler_fn"><span class="keyword">val</span> clear_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Restores the default error handling function.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetErrHandlerFn</div></ul>
</div>

<pre><span id="VALset_init_step"><span class="keyword">val</span> set_init_step</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the initial step size.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetInitStep</div></ul>
</div>

<pre><span id="VALset_fixed_step"><span class="keyword">val</span> set_fixed_step</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float option -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Disables time step adaptivity and fix the step size for all internal
      steps. Pass <code class="code"><span class="constructor">None</span></code> to restore time step adaptivity. This function is not
      recommended since there is no assurance of the validity of the computed
      solutions. It is provided primarily for code-to-code verification
      testing. Use in conjunction with <a href="Arkode.ERKStep.html#VALset_min_step"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.set_min_step</code></a> or <a href="Arkode.ERKStep.html#VALset_max_step"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.set_max_step</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetFixedStep</div></ul>
</div>

<pre><span id="VALset_max_num_constr_fails"><span class="keyword">val</span> set_max_num_constr_fails</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of constraint failures in a step before an
      error is signalled.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetMaxNumConstrFails</div></ul>
</div>

<pre><span id="VALset_max_hnil_warns"><span class="keyword">val</span> set_max_hnil_warns</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of messages warning that <code class="code">t&nbsp;+&nbsp;h&nbsp;=&nbsp;t</code> on
      the next internal step.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetMaxHnilWarns</div></ul>
</div>

<pre><span id="VALset_max_num_steps"><span class="keyword">val</span> set_max_num_steps</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of steps taken in attempting to reach
      a given output time.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetMaxNumSteps</div></ul>
</div>

<pre><span id="VALset_max_err_test_fails"><span class="keyword">val</span> set_max_err_test_fails</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of error test failures permitted in
      attempting one step.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetMaxErrTestFails</div></ul>
</div>

<pre><span id="VALset_min_step"><span class="keyword">val</span> set_min_step</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a lower bound on the magnitude of the step size.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetMinStep</div></ul>
</div>

<pre><span id="VALset_max_step"><span class="keyword">val</span> set_max_step</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies an upper bound on the magnitude of the step size.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetMaxStep</div></ul>
</div>

<pre><span id="VALset_stop_time"><span class="keyword">val</span> set_stop_time</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Limits the value of the independent variable <code class="code">t</code> when solving.
      By default no stop time is imposed.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetStopTime</div></ul>
</div>
<h4 id="erksetivp">Optional inputs for IVP method selection</h4>
<pre><span id="VALset_table"><span class="keyword">val</span> set_table</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> <a href="Arkode.ButcherTable.html#TYPEt">Arkode.ButcherTable.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a customized Butcher table.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetTable</div></ul>
</div>

<pre><span id="VALset_table_num"><span class="keyword">val</span> set_table_num</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> <a href="Arkode.ButcherTable.html#TYPEerk_table">Arkode.ButcherTable.erk_table</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Use a specific built-in Butcher table for integration.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetTableNum</div></ul>
</div>
<h4 id="erksetadap">Optional inputs for time step adaptivity</h4>
<pre><span id="VALset_adaptivity_method"><span class="keyword">val</span> set_adaptivity_method</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> 'd adaptivity_method -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the method and associated parameters used for time step
      adaptivity.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetAdaptivityMethod</div><div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetAdaptivityFn</div></ul>
</div>

<pre><span id="VALset_cfl_fraction"><span class="keyword">val</span> set_cfl_fraction</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the fraction of the estimated explicitly stable step to use.
      Any non-positive argument resets to the default value (0.5).</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetCFLFraction</div></ul>
</div>

<pre><span id="VALset_error_bias"><span class="keyword">val</span> set_error_bias</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the bias to apply to the error estimates within accuracy-based
      adaptivity strategies.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetErrorBias</div></ul>
</div>

<pre><span id="VALset_fixed_step_bounds"><span class="keyword">val</span> set_fixed_step_bounds</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the step growth interval in which the step size will remain
      unchanged. In the call <code class="code">set_fixed_step_bounds&nbsp;s&nbsp;lb&nbsp;ub</code>, <code class="code">lb</code> specifies a
      lower bound on the window to leave the step size fixed and <code class="code">ub</code>
      specifies an upper bound. Any interval not containing 1.0 resets to
      default values.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetFixedStepBounds</div></ul>
</div>

<pre><span id="VALset_max_efail_growth"><span class="keyword">val</span> set_max_efail_growth</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum step size growth factor upon multiple successive
      accuracy-based error failures in the solver. Any value outside the
      interval $(0, 1]$ resets to the default value.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetMaxEFailGrowth</div></ul>
</div>

<pre><span id="VALset_max_first_growth"><span class="keyword">val</span> set_max_first_growth</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum allowed step size change following the very first
      integration step. Any value $\le 1$ resets to the default value.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetMaxFirstGrowth</div></ul>
</div>

<pre><span id="VALset_max_growth"><span class="keyword">val</span> set_max_growth</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum growth of the step size between consecutive time
      steps. Any value $\le 1$ resets to the default value.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetMaxGrowth</div></ul>
</div>

<pre><span id="VALset_min_reduction"><span class="keyword">val</span> set_min_reduction</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the minimum allowed reduction factor in step size between
      step attempts that result from a temporal error failure in the
      integration process.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetMinReduction</div></ul>
</div>

<pre><span id="VALset_safety_factor"><span class="keyword">val</span> set_safety_factor</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the safety factor to be applied to the accuracy-based
      estimated step. Any non-positive value resets to the default value.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetSafetyFactor</div></ul>
</div>

<pre><span id="VALset_small_num_efails"><span class="keyword">val</span> set_small_num_efails</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the threshold for “multiple” successive error failures
      before the factor from <a href="Arkode.ERKStep.html#VALset_max_efail_growth"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.set_max_efail_growth</code></a> is applied. Any
      non-positive value resets to the default value.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetSmallNumEFails</div></ul>
</div>

<pre><span id="VALset_stability_fn"><span class="keyword">val</span> set_stability_fn</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> 'd stability_fn -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets a problem-dependent function to estimate a stable time step size
      for the explicit portion of the ODE system.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetStabilityFn</div></ul>
</div>

<pre><span id="VALclear_stability_fn"><span class="keyword">val</span> clear_stability_fn</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Clears the problem-dependent function that estimates a stable time step
      size for the explicit portion of the ODE system.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetStabilityFn</div></ul>
</div>

<pre><span id="VALset_postprocess_step_fn"><span class="keyword">val</span> set_postprocess_step_fn</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> 'd postprocess_step_fn -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set a post processing step function.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKSetPostprocessStepFn</div></ul>
</div>

<pre><span id="VALclear_postprocess_step_fn"><span class="keyword">val</span> clear_postprocess_step_fn</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Clear the post processing step function.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKSetPostprocessStepFn</div></ul>
</div>

<pre><span id="VALset_constraints"><span class="keyword">val</span> set_constraints</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a vector defining inequality constraints for each
      component of the solution vector.  See <a href="Sundials.Constraint.html"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">Constraint</span></code></a>.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetConstraints</div></ul>
</div>
<h3 id="erkget">Querying the solver (optional output functions)</h3>
<pre><span id="VALget_work_space"><span class="keyword">val</span> get_work_space</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the real and integer workspace sizes.</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">real_size</code>, <code class="code">integer_size</code>)</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetWorkSpace</div></ul>
</div>

<pre><span id="VALget_num_steps"><span class="keyword">val</span> get_num_steps</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of internal steps taken by the solver.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetNumSteps</div></ul>
</div>

<pre><span id="VALget_num_exp_steps"><span class="keyword">val</span> get_num_exp_steps</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of stability-limited steps taken by the
      solver.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetNumExpSteps</div></ul>
</div>

<pre><span id="VALget_num_acc_steps"><span class="keyword">val</span> get_num_acc_steps</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of accuracy-limited steps taken by the
      solver.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetNumAccSteps</div></ul>
</div>

<pre><span id="VALget_num_step_attempts"><span class="keyword">val</span> get_num_step_attempts</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of steps attempted by the solver.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetNumStepAttempts</div></ul>
</div>

<pre><span id="VALget_num_rhs_evals"><span class="keyword">val</span> get_num_rhs_evals</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls to the right-hand side function.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetNumRhsEvals</div></ul>
</div>

<pre><span id="VALget_num_err_test_fails"><span class="keyword">val</span> get_num_err_test_fails</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of local error test failures that have occurred.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetNumErrTestFails</div></ul>
</div>

<pre><span id="VALget_last_step"><span class="keyword">val</span> get_last_step</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integration step size taken on the last successful internal
      step.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetLastStep</div></ul>
</div>

<pre><span id="VALget_current_step"><span class="keyword">val</span> get_current_step</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integration step size to be attempted on the next internal
      step.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetCurrentStep</div></ul>
</div>

<pre><span id="VALget_actual_init_step"><span class="keyword">val</span> get_actual_init_step</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the the value of the integration step size used on the first
      step.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetActualInitStep</div></ul>
</div>

<pre><span id="VALget_current_time"><span class="keyword">val</span> get_current_time</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the the current internal time reached by the solver.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetCurrentTime</div></ul>
</div>

<pre><span id="VALget_current_butcher_table"><span class="keyword">val</span> get_current_butcher_table</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> <a href="Arkode.ButcherTable.html#TYPEt">Arkode.ButcherTable.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Returns the Butcher table in use by the solver.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetCurrentButcherTable</div></ul>
</div>

<pre><span id="VALget_tol_scale_factor"><span class="keyword">val</span> get_tol_scale_factor</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns a suggested factor by which the user's tolerances should be
      scaled when too much accuracy has been requested for some internal step.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetTolScaleFactor</div></ul>
</div>

<pre><span id="VALget_err_weights"><span class="keyword">val</span> get_err_weights</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the solution error weights at the current time.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetErrWeights</div></ul>
</div>

<pre><span id="VALget_est_local_errors"><span class="keyword">val</span> get_est_local_errors</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the vector of estimated local errors.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetEstLocalErrors</div></ul>
</div>

<pre><code><span id="TYPEtimestepper_stats"><span class="keyword">type</span> <code class="type"></code>timestepper_stats</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtimestepper_stats.exp_steps">exp_steps</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Cumulative number of stability-limited solver steps.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtimestepper_stats.acc_steps">acc_steps</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Cumulative number of accuracy-limited solver steps.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtimestepper_stats.step_attempts">step_attempts</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Cumulative number of steps attempted by the solver.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtimestepper_stats.num_nf_evals">num_nf_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of calls to the right-hand side function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtimestepper_stats.num_err_test_fails">num_err_test_fails</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of error test failures.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Summaries of time-stepper statistics.</p>
</div>
</div>


<pre><span id="VALget_timestepper_stats"><span class="keyword">val</span> get_timestepper_stats</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> <a href="Arkode.ERKStep.html#TYPEtimestepper_stats">timestepper_stats</a></code></pre><div class="info ">
<div class="info-desc">
<p>Returns a grouped set of time-stepper statistics.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetTimestepperStats</div></ul>
</div>

<pre><span id="VALget_step_stats"><span class="keyword">val</span> get_step_stats</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> step_stats</code></pre><div class="info ">
<div class="info-desc">
<p>Returns a grouped set of integrator statistics.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetStepStats</div></ul>
</div>

<pre><span id="VALprint_timestepper_stats"><span class="keyword">val</span> print_timestepper_stats</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> Stdlib.out_channel -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Prints time-stepper statistics on the given channel.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetTimestepperStats</div></ul>
</div>

<pre><span id="VALprint_step_stats"><span class="keyword">val</span> print_step_stats</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> Stdlib.out_channel -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Prints integrator statistics on the given channel.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetStepStats</div></ul>
</div>

<pre><span id="VALwrite_session"><span class="keyword">val</span> write_session</span> : <code class="type">?logfile:Sundials.Logfile.t -> ('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Summarize the session on the standard output (or given file).</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepPrintMem</div></ul>
</div>
<h3 id="erkroots">Additional root-finding functions</h3>
<pre><span id="VALset_root_direction"><span class="keyword">val</span> set_root_direction</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">set_root_direction&nbsp;s&nbsp;dir</code> specifies the direction of zero-crossings to
      be located and returned. <code class="code">dir</code> may contain one entry for each root
      function.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetRootDirection</div></ul>
</div>

<pre><span id="VALset_all_root_directions"><span class="keyword">val</span> set_all_root_directions</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Like <a href="Arkode.ERKStep.html#VALset_root_direction"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">ERKStep</span>.set_root_direction</code></a> but specifies a single direction for all root
      functions.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetRootDirection</div></ul>
</div>

<pre><span id="VALset_no_inactive_root_warn"><span class="keyword">val</span> set_no_inactive_root_warn</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Disables issuing a warning if some root function appears to be
      identically zero at the beginning of the integration.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepSetNoInactiveRootWarn</div></ul>
</div>

<pre><span id="VALget_num_roots"><span class="keyword">val</span> get_num_roots</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of root functions.</p>
</div>
</div>

<pre><span id="VALget_root_info"><span class="keyword">val</span> get_root_info</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> <a href="Sundials.Roots.html#TYPEt">Sundials.Roots.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Fills an array showing which functions were found to have a root.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetRootInfo</div></ul>
</div>

<pre><span id="VALget_num_g_evals"><span class="keyword">val</span> get_num_g_evals</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of calls made to the user-supplied root
      function g.</p>
</div>
<ul class="info-attributes">
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetNumGEvals</div></ul>
</div>

<pre><span id="VALget_num_constr_fails"><span class="keyword">val</span> get_num_constr_fails</span> : <code class="type">('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of test failures.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepGetNumConstrFails</div></ul>
</div>

<pre><span id="VALwrite_parameters"><span class="keyword">val</span> write_parameters</span> : <code class="type">?logfile:Sundials.Logfile.t -> ('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Outputs all the solver parameters on the standard output (or given file).</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 4.1.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepWriteParameters</div></ul>
</div>

<pre><span id="VALwrite_butcher"><span class="keyword">val</span> write_butcher</span> : <code class="type">?logfile:Sundials.Logfile.t -> ('d, 'k) <a href="Arkode.ERKStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Outputs the current butcher table on the standard output (or given file).</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 4.1.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>ERKStepWriteButcher</div></ul>
</div>
</body></html>
