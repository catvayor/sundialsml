<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Cvodes.Quadrature.html">
<link rel="next" href="Cvodes.Adjoint.html">
<link rel="Up" href="Cvodes.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials_Logfile" rel="Chapter" href="Sundials_Logfile.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Initialization" rel="Section" href="#init">
<link title="Output functions" rel="Section" href="#sensout">
<link title="Modifying the solver (optional input functions)" rel="Section" href="#set">
<link title="Querying the solver (optional output functions)" rel="Section" href="#get">
<link title="Exceptions" rel="Section" href="#exceptions">
<title>Sundials/ML 5.8.0p0 : Cvodes.Sensitivity</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Cvodes.Quadrature.html" title="Cvodes.Quadrature">Previous</a>
&nbsp;<a class="up" href="Cvodes.html" title="Cvodes">Up</a>
&nbsp;<a class="post" href="Cvodes.Adjoint.html" title="Cvodes.Adjoint">Next</a>
</div>
<h1>Module <a href="type_Cvodes.Sensitivity.html">Cvodes.Sensitivity</a></h1>

<pre><span id="MODULESensitivity"><span class="keyword">module</span> Sensitivity</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvodes.Sensitivity.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>(Forward) Sensitivity analysis of ODEs with respect to their parameters.</p>

<p>Formalizes the dependency of a set of ODEs on $N_p$ parameters $p$ and
    calculates the sensitivities $s$ of the solution $y$ to a subset of
    $N_s \leq N_p$ of those parameters;
    $s(t) = \frac{\partial y(t)}{\partial p}$.</p>

<p>The <i>solution sensitivity</i> with respect to a single parameter $p_i$
    satisfies the <i>(forward) sensitivity equations</i>
    $\dot{s}_i = \frac{\partial f}{\partial y}s_i + \frac{\partial f}{\partial p_i}$
    and $s_i(t_0) = \frac{\partial y_0(p)}{\partial p_i}$, where
    $f$ and $y$ are from the $N$ equations of the original model.</p>

<p>This documented interface is structured as follows.</p>
<OL>
<li><a href="#init">Initialization</a> (including <a href="Cvodes.Sensitivity.Quadrature.html">Quadrature equations</a>)</li>
<li><a href="#sensout">Output functions</a></li>
<li><a href="#set">Modifying the solver</a></li>
<li><a href="#get">Querying the solver</a></li>
<li><a href="#exceptions">Exceptions</a></li>
</OL>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>Enhanced skeleton for sensitivity analysis</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>Using CVODES for Forward Sensitivity Analysis</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>Forward sensitivity analysis</div></li></ul>
</div>
<hr width="100%">
<h3 id="init">Initialization</h3>
<pre><code><span id="TYPEsensrhsfn_args"><span class="keyword">type</span> <code class="type">'d</code> sensrhsfn_args</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn_args.t">t</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The value of the independent variable.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn_args.y">y</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The vector of dependent-variable values $y(t)$.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn_args.y'">y'</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The value of the right-hand side of the state
          equations $\dot{y} = f(t, y, p)$.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn_args.tmp">tmp</span>&nbsp;: <code class="type">'d <a href="Cvode.html#TYPEdouble">Cvode.double</a></code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Temporary storage vectors.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Common arguments to <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn1"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.sensrhsfn1</code></a> and <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_all"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.sensrhsfn_all</code></a>.</p>
</div>
</div>


<pre><span id="TYPEsensrhsfn_all"><span class="keyword">type</span> <code class="type">'d</code> sensrhsfn_all</span> = <code class="type">'d <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_args">sensrhsfn_args</a> -> 'd array -> 'd array -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Sensitivity functions that calculate the right-hand sides of
      all sensitivity equations.  They are passed the arguments:</p>

<ul>
<li><code class="code">args</code>, the current values of state variables (see <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_args"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.sensrhsfn_args</code></a>),</li>
<li><code class="code">s</code>, an array of vectors holding the current values of sensitivity
             variables, and,</li>
<li><code class="code">s'</code>, an array of vectors to be filled with the derivatives
              of the sensitivity variables.</li>
</ul>
<p>Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
      indicates a recoverable error. Any other exception is treated as an
      unrecoverable error.</p>

<p><div class="warningbox"> The vectors in the function arguments should not
               be accessed after the function returns.</div></p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVSensRhsFn</div></li></ul>
</div>


<pre><span id="TYPEsensrhsfn1"><span class="keyword">type</span> <code class="type">'d</code> sensrhsfn1</span> = <code class="type">int -> 'd <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_args">sensrhsfn_args</a> -> 'd -> 'd -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Sensitivity functions that calculate the right-hand side of a
      single sensitivity equation.  They are passed the arguments:</p>

<ul>
<li><code class="code">i</code>, the index of the sensitivity equation to compute,</li>
<li><code class="code">args</code>, the current values of state variables
                (see <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_args"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.sensrhsfn_args</code></a>),</li>
<li><code class="code">s</code>, a vector holding the current value of the <i>i</i>th
             sensitivity variable, and</li>
<li><code class="code">s'</code>, a vector to be filled with the current value of the <i>i</i>th
              sensitivity variable's derivative.</li>
</ul>
<p>Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
      indicates a recoverable error. Any other exception is treated as an
      unrecoverable error.</p>

<p><div class="warningbox"> The vectors in the function arguments should not
               be accessed after the function returns.</div></p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVSensRhs1Fn</div></li></ul>
</div>


<pre><code><span id="TYPEsensrhsfn"><span class="keyword">type</span> <code class="type">'d</code> sensrhsfn</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn.AllAtOnce"><span class="constructor">AllAtOnce</span></span> <span class="keyword">of</span> <code class="type">'d <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn_all">sensrhsfn_all</a> option</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Calculate sensitivity functions all at once. The argument <code class="code"><span class="constructor">None</span></code>
          specifies an internal difference quotient routine.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensInit</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVSensRhsFn</div></li></ul>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensrhsfn.OneByOne"><span class="constructor">OneByOne</span></span> <span class="keyword">of</span> <code class="type">'d <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn1">sensrhsfn1</a> option</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Calculate sensitivity functions one parameter at a time. The
          argument <code class="code"><span class="constructor">None</span></code> specifies an internal difference quotient routine.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensInit1</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVSensRhs1Fn</div></li></ul>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Specify a sensitivity function.</p>
</div>
</div>


<pre><code><span id="TYPEsens_method"><span class="keyword">type</span> <code class="type">('d, 'k)</code> sens_method</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_method.Simultaneous"><span class="constructor">Simultaneous</span></span> <span class="keyword">of</span> <code class="type">('d, 'k, ('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a>, [ `Sens ]) Sundials.NonlinearSolver.t option</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Correct state and sensitivity variables at the same time.
          <span class="cconst">(CV_SIMULTANEOUS)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_method.Staggered"><span class="constructor">Staggered</span></span> <span class="keyword">of</span> <code class="type">('d, 'k, ('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a>, [ `Sens ]) Sundials.NonlinearSolver.t option</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The correction step for the sensitivity variables takes place at the
          same time for all sensitivity equations, but only after the
          correction of the state variables has converged and the state
          variables have passed the local error test.
          <span class="cconst">(CV_STAGGERED)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_method.Staggered1"><span class="constructor">Staggered1</span></span> <span class="keyword">of</span> <code class="type">('d, 'k, ('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a>, [ `Nvec ]) Sundials.NonlinearSolver.t option</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>All corrections are done sequentially, first for the state variables
          and then for the sensitivity variables, one parameter at a time. If
          the sensitivity variables are not included in the error control,
          this approach is equivalent to <code class="code"><span class="constructor">Staggered</span></code>. Note that this
          approach can only be used if the user-provided sensitivity
          right-hand side function is of type <code class="code"><span class="constructor">OneByOne</span></code>.
          <span class="cconst">(CV_STAGGERED1)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Specifies a sensitivity solution method. The method specification may
      optionally include the nonlinear solver to be used for corrections.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensInit</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensInit1</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSetNonlinearSolverSensSim</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSetNonlinearSolverSensStg</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSetNonlinearSolverSensStg1</div></li></ul>
</div>


<pre><code><span id="TYPEsens_params"><span class="keyword">type</span> <code class="type"></code>sens_params</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_params.pvals">pvals</span>&nbsp;: <code class="type">Sundials.RealArray.t option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>An array of $N_p$ parameters $p$ in $f(t, y, p)$.  If
          specified, this array is updated by the solver to pass
          perturbed parameter values to the original right-hand side
          and root functions.  Those functions must (re-)read
          parameter values from this array on every invocation.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_params.pbar">pbar</span>&nbsp;: <code class="type">Sundials.RealArray.t option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>An array of $N_s$ positive scaling factors. These are needed
          when estimating tolerances or using the internal difference
          quotient function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_params.plist">plist</span>&nbsp;: <code class="type">int array option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>An array of $N_s$ ($&lt; N_p$) indices into <code class="code">pvals</code>
          specifying the parameters to analyze. If not specified,
          the first $N_s$ parameters are analyzed.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Specifies problem parameter information for sensitivity
      calculations.  Which fields are required varies as follows:</p>
<ul>
<li><code class="code">pvals</code> is mandatory if <a href="Cvodes.Sensitivity.html#VALinit"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.init</code></a> and/or
        <a href="Cvodes.Sensitivity.Quadrature.html#VALinit"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.<span class="constructor">Quadrature</span>.init</code></a> is not given a
        user-defined callback.  Otherwise, it is ignored.</li>
<li><code class="code">plist</code> is optional if <code class="code">pvals</code> is given.  Otherwise, it is
        ignored.</li>
<li><code class="code">pbar</code> is always meaningful and optional.</li>
</ul>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSetSensParams</div></li></ul>
</div>


<pre><span id="VALno_sens_params"><span class="keyword">val</span> no_sens_params</span> : <code class="type"><a href="Cvodes.Sensitivity.html#TYPEsens_params">sens_params</a></code></pre><div class="info ">
<div class="info-desc">
<p>Empty <code class="code">pvals</code>, <code class="code">plist</code>, and <code class="code">pbar</code> fields.</p>
</div>
</div>

<pre><code><span id="TYPEtolerance"><span class="keyword">type</span> <code class="type">('d, 'k)</code> tolerance</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SStolerances"><span class="constructor">SStolerances</span></span> <span class="keyword">of</span> <code class="type">float * Sundials.RealArray.t</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><code class="code">(rel,&nbsp;abs)</code> : scalar relative and absolute tolerances.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SVtolerances"><span class="constructor">SVtolerances</span></span> <span class="keyword">of</span> <code class="type">float * ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><code class="code">(rel,&nbsp;abs)</code> : scalar relative and vector absolute tolerances.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.EEtolerances"><span class="constructor">EEtolerances</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Calculate the integration tolerances for sensitivities
          from those for state variables and the scaling factors
          in <a href="Cvodes.Sensitivity.html#TYPEsens_params">pbar</a>.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Tolerances for calculating sensitivities.</p>
</div>
</div>


<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -><br>       ('d, 'k) <a href="Cvodes.Sensitivity.html#TYPEtolerance">tolerance</a> -><br>       ('d, 'k) <a href="Cvodes.Sensitivity.html#TYPEsens_method">sens_method</a> -><br>       ?sens_params:<a href="Cvodes.Sensitivity.html#TYPEsens_params">sens_params</a> -><br>       'd <a href="Cvodes.Sensitivity.html#TYPEsensrhsfn">sensrhsfn</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Activates the calculation of forward sensitivities. The call
      <code class="code">init&nbsp;s&nbsp;tol&nbsp;sens_method&nbsp;~sens_params&nbsp;fs&nbsp;ys0</code>, has as arguments:</p>
<ul>
<li><code class="code">s</code>, a session created with <a href="Cvode.html#VALinit"><code class="code"><span class="constructor">Cvode</span>.init</code></a>,</li>
<li><code class="code">tol</code>, the tolerances desired,</li>
<li><code class="code">sens_method</code>, the solution method,</li>
<li><code class="code">sens_params</code>, the parameter information (see <a href="Cvodes.Sensitivity.html#TYPEsens_params"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.sens_params</code></a>),</li>
<li><code class="code">fs</code>, the sensitivity function, and,</li>
<li><code class="code">ys0</code>, initial values of the sensitivities for each parameter.</li>
</ul>
<p>If <code class="code">fs</code> is not given, an internal difference quotient routine
      is used.  In that case, or if the internal difference quotient
      routine will be specified in a subsequent call to
      <a href="Cvodes.Sensitivity.Quadrature.html#VALinit"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.<span class="constructor">Quadrature</span>.init</code></a>, then <code class="code">sens_params</code> must be
      given with <code class="code">pvals</code> set to non-<code class="code"><span class="constructor">None</span></code>.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensInit</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensInit1</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSetSensParams</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensSStolerances</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensSVtolerances</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensEEtolerances</div></li></ul>
</div>

<pre><span id="VALreinit"><span class="keyword">val</span> reinit</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -><br>       ('d, 'k) <a href="Cvodes.Sensitivity.html#TYPEsens_method">sens_method</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Reinitializes the forward sensitivity computation.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensReInit</div></li></ul>
</div>

<pre><span id="VALtoggle_off"><span class="keyword">val</span> toggle_off</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Deactivates forward sensitivity calculations without deallocating
      memory. Sensitivities can be reactivated with <a href="Cvodes.Sensitivity.html#VALreinit"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.reinit</code></a>.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensToggleOff</div></li></ul>
</div>

<pre><span id="VALturn_off"><span class="keyword">val</span> turn_off</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Deactivates forward sensitivity calculations with memory
      deallocation.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensFree</div></li></ul>
</div>

<pre><span id="MODULEQuadrature"><span class="keyword">module</span> <a href="Cvodes.Sensitivity.Quadrature.html">Quadrature</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvodes.Sensitivity.Quadrature.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Support for quadrature sensitivity equations.</p>

</div>
<h3 id="sensout">Output functions</h3>
<pre><span id="VALget"><span class="keyword">val</span> get</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the sensitivity solution vectors after a successful solver
      step. The given vectors are filled with values calculated during
      either <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> or <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a> and the
      value of the independent variable is returned.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSens</div></li></ul>
</div>

<pre><span id="VALget_dky"><span class="keyword">val</span> get_dky</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> float -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the interpolated solution or derivatives of the sensitivity
      solution vectors.</p>

<p><code class="code">get_dky&nbsp;s&nbsp;dks&nbsp;t&nbsp;k</code> computes the <code class="code">k</code>th derivative at time <code class="code">t</code>, i.e.,
      $\frac{d^\mathtt{k}s(\mathtt{t})}{\mathit{dt}^\mathtt{k}}$,
      and stores it in <code class="code">dks</code>. The arguments must satisfy $t_n - h_u \leq
      \mathtt{t} \leq t_n$—where $t_n$ denotes <a href="Cvode.html#VALget_current_time"><code class="code"><span class="constructor">Cvode</span>.get_current_time</code></a>
      and $h_u$ denotes <a href="Cvode.html#VALget_last_step"><code class="code"><span class="constructor">Cvode</span>.get_last_step</code></a>,— and
      $0 \leq \mathtt{k} \leq q_u$—where
      $q_u$ denotes <a href="Cvode.html#VALget_last_order"><code class="code"><span class="constructor">Cvode</span>.get_last_order</code></a>.</p>

<p>This function may only be called after a successful return from either
      <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> or <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadT</code> <code class="code">t</code> is not in the interval $[t_n - h_u, t_n]$.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range 0, 1, ..., $q_u$.</li>
</ul></div>
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSensDky</div></li></ul>
</div>

<pre><span id="VALget1"><span class="keyword">val</span> get1</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> int -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns a single sensitivity solution vector after a successful solver
      step. The given vector is filled with values calculated for the <code class="code">i</code>th
      sensitivity vector during either <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> or
      <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a> and the value of the independent variable is
      returned.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span> <code>BadIS</code> The index <code class="code">i</code> is not in the allowed range.</div>
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSens1</div></li></ul>
</div>

<pre><span id="VALget_dky1"><span class="keyword">val</span> get_dky1</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> int -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the interpolated solution or derivatives of a single
      sensitivity solution vector. <code class="code">get_dky&nbsp;s&nbsp;dks&nbsp;t&nbsp;k&nbsp;i</code> is like <a href="Cvodes.Sensitivity.html#VALget_dky"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.get_dky</code></a>
      but restricted to the <code class="code">i</code>th sensitivity solution vector.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadIS</code> The index <code class="code">i</code> is not in the allowed range.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range 0, 1, ..., <code class="code">qlast</code>.</li>
<li><code>BadT</code> <code class="code">t</code> is not in the allowed range.</li>
</ul></div>
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSensDky1</div></li></ul>
</div>
<h3 id="set">Modifying the solver (optional input functions)</h3>
<pre><span id="VALset_tolerances"><span class="keyword">val</span> set_tolerances</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Cvodes.Sensitivity.html#TYPEtolerance">tolerance</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the integration tolerances for sensitivities.</p>

<p><b>NB</b>: Unlike the other <code class="code">set_tolerances</code> functions in <code class="code"><span class="constructor">Cvodes</span></code>, this
      one does <b>not</b> call <a href="Cvodes.Sensitivity.html#VALset_err_con"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.set_err_con</code></a> (which defaults to <code class="code"><span class="keyword">false</span></code>).</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensSStolerances</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensSVtolerances</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSensEEtolerances</div></li></ul>
</div>

<pre><span id="VALset_err_con"><span class="keyword">val</span> set_err_con</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> bool -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets whether sensitivity variables are used in the error control
      mechanism. The default is <code class="code"><span class="keyword">false</span></code>.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSetSensErrCon</div></li></ul>
</div>

<pre><code><span id="TYPEdq_method"><span class="keyword">type</span> <code class="type"></code>dq_method</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTdq_method.DQCentered"><span class="constructor">DQCentered</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><span class="cconst">(CV_CENTERED)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTdq_method.DQForward"><span class="constructor">DQForward</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><span class="cconst">(CV_FORWARD)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>A difference quotient strategy. See <a href="Cvodes.Sensitivity.html#VALset_dq_method"><code class="code"><span class="constructor">Cvodes</span>.<span class="constructor">Sensitivity</span>.set_dq_method</code></a>.</p>
</div>
</div>


<pre><span id="VALset_dq_method"><span class="keyword">val</span> set_dq_method</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> <a href="Cvodes.Sensitivity.html#TYPEdq_method">dq_method</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the difference quotient strategy when sensitivity equations
      are computed internally by the solver rather than via callback. A
      method and <code class="code">dqrhomax</code> value must be given. The latter determines when
      to switch between simultaneous or separate approximations of the two
      terms in the sensitivity right-hand side.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSetSensDQMethod</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>Forward Sensitivity Analysis</div></li></ul>
</div>

<pre><span id="VALset_max_nonlin_iters"><span class="keyword">val</span> set_max_nonlin_iters</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the maximum number of nonlinear solver iterations for
      sensitivity variables permitted per step.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeSetSensMaxNonlinIters</div></li></ul>
</div>
<h3 id="get">Querying the solver (optional output functions)</h3>
<pre><span id="VALget_num_rhs_evals"><span class="keyword">val</span> get_num_rhs_evals</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls to the sensitivity function.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSensNumRhsEvals</div></li></ul>
</div>

<pre><span id="VALget_num_rhs_evals_sens"><span class="keyword">val</span> get_num_rhs_evals_sens</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls to the right-hand side function due
      to the internal finite difference approximation of the sensitivity
      equations.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetNumRhsEvalsSens</div></li></ul>
</div>

<pre><span id="VALget_num_err_test_fails"><span class="keyword">val</span> get_num_err_test_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of local error test failures for the sensitivity
      variables that have occurred.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSensNumErrTestFails</div></li></ul>
</div>

<pre><span id="VALget_num_lin_solv_setups"><span class="keyword">val</span> get_num_lin_solv_setups</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls made to the linear solver's setup function
      due to forward sensitivity calculations.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSensNumLinSolvSetups</div></li></ul>
</div>

<pre><code><span id="TYPEsensitivity_stats"><span class="keyword">type</span> <code class="type"></code>sensitivity_stats</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_sens_evals">num_sens_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of calls to the sensitivity function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_rhs_evals">num_rhs_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of calls to the right-hand side function to
            calculate sensitivities.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_err_test_fails">num_err_test_fails</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of local error test failures for sensitivity variables.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_lin_solv_setups">num_lin_solv_setups</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of setups calls to the linear solver for sensitivity
            calculations.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Summaries of sensitivity stats.</p>
</div>
</div>


<pre><span id="VALget_stats"><span class="keyword">val</span> get_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> <a href="Cvodes.Sensitivity.html#TYPEsensitivity_stats">sensitivity_stats</a></code></pre><div class="info ">
<div class="info-desc">
<p>Returns the sensitivity-related statistics as a group.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSensStats</div></li></ul>
</div>

<pre><span id="VALget_err_weights"><span class="keyword">val</span> get_err_weights</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the sensitivity error weights at the current time.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSensErrWeights</div></li><li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>IVP solution (W_i, Eq. (2.7))</div></li></ul>
</div>

<pre><span id="VALget_num_nonlin_solv_iters"><span class="keyword">val</span> get_num_nonlin_solv_iters</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear iterations performed for
      sensitivity calculations.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSensNumNonlinSolvIters</div></li></ul>
</div>

<pre><span id="VALget_num_nonlin_solv_conv_fails"><span class="keyword">val</span> get_num_nonlin_solv_conv_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear convergence failures
      during sensitivity calculations.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSensNumNonlinSolvConvFails</div></li></ul>
</div>

<pre><span id="VALget_nonlin_solv_stats"><span class="keyword">val</span> get_nonlin_solv_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns both the numbers of nonlinear iterations performed <code class="code">nniters</code>
      and nonlinear convergence failures <code class="code">nncfails</code> during sensitivity
      calculations.</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">nniters</code>, <code class="code">nncfails</code>)</li>
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetSensNonlinSolvStats</div></li></ul>
</div>

<pre><span id="VALget_num_stgr_nonlin_solv_iters"><span class="keyword">val</span> get_num_stgr_nonlin_solv_iters</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> Sundials.LintArray.t -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear (functional or Newton)
      iterations for each sensitivity equation separately in the <code class="code"><span class="constructor">Staggered1</span></code>
      case.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetStgrSensNumNonlinSolvIters</div></li></ul>
</div>

<pre><span id="VALget_num_stgr_nonlin_solv_conv_fails"><span class="keyword">val</span> get_num_stgr_nonlin_solv_conv_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> Sundials.LintArray.t -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear convergence failures
      for each sensitivity equation separately in the <code class="code"><span class="constructor">Staggered1</span></code> case.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetStgrSensNumNonlinSolvConvFails</div></li></ul>
</div>

<pre><span id="VALget_current_state_sens"><span class="keyword">val</span> get_current_state_sens</span> : <code class="type">('d, 'k) <a href="Cvodes.html#TYPEsession">Cvodes.session</a> -> 'd array</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the current sensitivity state vector array. The vectors in the
      returned array provide direct access to the data within the integrator.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetCurrentStateSens</div></li></ul>
</div>

<pre><code><span id="TYPEnonlin_system_data"><span class="keyword">type</span> <code class="type">'d</code> nonlin_system_data</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.tn">tn</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Independent variable value $t_n$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.yspred">yspred</span>&nbsp;: <code class="type">'d array</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Predicted state vectors $\mathit{yS}_{i,\mathit{pred}}$ 
          at $t_n$  for $i = 0,\ldots,N_s-1$ . This data must not
          be changed.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.ysn">ysn</span>&nbsp;: <code class="type">'d array</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>State vectors $\mathit{yS}^n_i$ 
          for $i = 0,\ldots,N_s-1$ .
          This data may not be current and may need to be filled.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.gamma">gamma</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Current value of $\gamma$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.rls1">rls1</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>A scaling factor used to compute $\tilde{a}_n =
            \mathtt{rls1}\cdot\mathtt{zns1}$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.zns1">zns1</span>&nbsp;: <code class="type">'d array</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Vectors used to compute $\tilde{a}_n =
            \mathtt{rl1}\cdot\mathtt{zn1}$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Internal data required to construct the current nonlinear implicit
      system within a nonlinear solver.</p>
</div>
</div>


<pre><span id="VALget_nonlin_system_data"><span class="keyword">val</span> get_nonlin_system_data</span> : <code class="type">('d, 'k) <a href="Cvodes.html#TYPEsession">Cvodes.session</a> -> 'd <a href="Cvodes.Sensitivity.html#TYPEnonlin_system_data">nonlin_system_data</a></code></pre><div class="info ">
<div class="info-desc">
<p>Gives direct access to the internal data required to construct the
      current nonlinear system within a nonlinear solver. This
      function should be called inside the nonlinear system function.
      The vectors <code class="code">ysn</code> are provided as additional workspace and do not need
      to be filled in. They are only current after an evaluation of the
      nonlinear system function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>CVodeGetNonlinearSystemDataSens</div></ul>
</div>

<pre><span id="VALcompute_state"><span class="keyword">val</span> compute_state</span> : <code class="type">('d, 'k) <a href="Cvodes.html#TYPEsession">Cvodes.session</a> -><br>       ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Computes the current sensitivity vector for all sensitivities using
      the stored prediction and the supplied correction vectors from the
      nonlinear solver. The call
      <code class="code">compute_state&nbsp;s&nbsp;i&nbsp;yscor&nbsp;ysn</code> computes
      $\mathit{yS}^n = \mathit{yS}_{\mathit{pred}}
                            + \mathit{yS}_{\mathit{cor}}$ .</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>CVodeComputeStateSens</div></ul>
</div>

<pre><span id="VALcompute_state1"><span class="keyword">val</span> compute_state1</span> : <code class="type">('d, 'k) <a href="Cvodes.html#TYPEsession">Cvodes.session</a> -><br>       int -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Computes the current sensitivity vector for the sensitivity at the given
      index using the stored prediction and the supplied correction vector
      from the nonlinear solver. The call
      <code class="code">compute_state&nbsp;s&nbsp;i&nbsp;yscor1&nbsp;ysn1</code> computes
      $\mathit{yS}^n_i = \mathit{yS}_{i,\mathit{pred}}
                            + \mathit{yS}_{i,\mathit{cor}}$ .</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<div class="sundials"><span class="seesundials">See sundials: </span>CVodeComputeStateSens1</div></ul>
</div>

<pre><span id="VALget_current_sens_solve_index"><span class="keyword">val</span> get_current_sens_solve_index</span> : <code class="type">('d, 'k) <a href="Cvodes.html#TYPEsession">Cvodes.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the index of the current sensitivity solve when using
      the <a href="Cvodes.Sensitivity.html#TYPEsens_method">Staggered1</a> method.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CVodeGetCurrentSensSolveIndex</div></li></ul>
</div>
<h3 id="exceptions">Exceptions</h3>
<pre><span id="EXCEPTIONSensNotInitialized"><span class="keyword">exception</span> SensNotInitialized</span></pre>
<div class="info ">
<div class="info-desc">
<p>Sensitivity analysis was not initialized.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CV_NO_SENS</div></li></ul>
</div>

<pre><span id="EXCEPTIONSensRhsFuncFailure"><span class="keyword">exception</span> SensRhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The sensitivity function failed in an unrecoverable manner.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CV_SRHSFUNC_FAIL</div></li></ul>
</div>

<pre><span id="EXCEPTIONFirstSensRhsFuncFailure"><span class="keyword">exception</span> FirstSensRhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The sensitivity function had a recoverable error when first called.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CV_FIRST_SRHSFUNC_ERR</div></li></ul>
</div>

<pre><span id="EXCEPTIONRepeatedSensRhsFuncFailure"><span class="keyword">exception</span> RepeatedSensRhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Too many convergence test failures, or unable to estimate the initial
      step size, due to repeated recoverable errors in the sensitivity
      function.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CV_REPTD_SRHSFUNC_ERR</div></li></ul>
</div>

<pre><span id="EXCEPTIONUnrecoverableSensRhsFuncFailure"><span class="keyword">exception</span> UnrecoverableSensRhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The sensitivity function had a recoverable error, but no recovery was
      possible. This error can only occur after an error test failure at
      order one.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CV_UNREC_SRHSFUNC_ERR</div></li></ul>
</div>

<pre><span id="EXCEPTIONBadSensIdentifier"><span class="keyword">exception</span> BadSensIdentifier</span></pre>
<div class="info ">
<div class="info-desc">
<p>The index passed to identify a particular sensitivity is invalid.</p>
</div>
<ul class="info-attributes">
<li><div class="sundials cvodes">      <span class="seesundials">See sundials: </span>CV_BAD_IS</div></li></ul>
</div>
</body></html>
