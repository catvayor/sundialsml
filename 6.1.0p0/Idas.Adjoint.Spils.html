<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Idas.Adjoint.Dls.html">
<link rel="next" href="Idas.Adjoint.Quadrature.html">
<link rel="Up" href="Idas.Adjoint.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Sundials_parallel" rel="Chapter" href="Sundials_parallel.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Preconditioners" rel="Section" href="#precond">
<link title="Solvers" rel="Section" href="#lsolvers">
<link title="Solver parameters" rel="Section" href="#set">
<link title="Solver statistics" rel="Section" href="#stats">
<link title="Low-level solver manipulation" rel="Section" href="#lowlevel">
<title>Sundials/ML 6.1.0p0 : Idas.Adjoint.Spils</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Idas.Adjoint.Dls.html" title="Idas.Adjoint.Dls">Previous</a>
&nbsp;<a class="up" href="Idas.Adjoint.html" title="Idas.Adjoint">Up</a>
&nbsp;<a class="post" href="Idas.Adjoint.Quadrature.html" title="Idas.Adjoint.Quadrature">Next</a>
</div>
<h1>Module <a href="type_Idas.Adjoint.Spils.html">Idas.Adjoint.Spils</a></h1>

<pre><span id="MODULESpils"><span class="keyword">module</span> Spils</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Idas.Adjoint.Spils.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>Scaled Preconditioned Iterative Linear Solvers</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSolveFnB">IDALsPrecSolveFnB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSetupFnB">IDALsPrecSetupFnB</a></li></ul>
</div>
<hr width="100%">

<pre><span class="keyword">include</span> <a href="Sundials_LinearSolver.Iterative.html">Sundials_LinearSolver.Iterative</a></pre>
<h4 id="precond">Preconditioners</h4>
<pre><span id="TYPEprec_solve_fn"><span class="keyword">type</span> <code class="type">'d</code> prec_solve_fn</span> = <code class="type">(unit, 'd) <a href="Idas.Adjoint.html#TYPEjacobian_arg">Idas.Adjoint.jacobian_arg</a> -> 'd -> 'd -> float -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Callback functions that solve a linear system involving a
        preconditioner matrix without forward sensitivities.
        In the call <code class="code">prec_solve_fn&nbsp;jac&nbsp;r&nbsp;z&nbsp;delta</code>,</p>
<ul>
<li><code class="code">jac</code> is a <a href="Idas.Adjoint.html#TYPEjacobian_arg"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.jacobian_arg</code></a> with no work vectors,</li>
<li><code class="code">r</code> is the right-hand side vector,</li>
<li><code class="code">z</code> is computed to solve $Pz = r$, and</li>
<li><code class="code">delta</code> is the input tolerance.
        $P$ is a preconditioner matrix, which approximates, however crudely,
        the Jacobian matrix
        $\frac{\partial F}{\partial y} + \mathtt{arg.jac\_coef}\frac{\partial F}{\partial\dot{y}}$.
        If the solution is found via an iterative method, it must satisfy
        $\sqrt{\sum_i (\mathit{Res}_i \cdot \mathit{ewt}_i)^2}
              < \mathtt{delta}$,
        where $\mathit{Res} = r - Pz$ and $\mathit{ewt}$ comes from
        <a href="Idas.Adjoint.html#VALget_err_weights"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.get_err_weights</code></a>.</li>
</ul>
<p>Raising <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> indicates a recoverable
        error. Any other exception is treated as an unrecoverable error.</p>

<p><div class="warningbox"> The elements of <code class="code">jac</code>, <code class="code">r</code>, and <code class="code">z</code> should not
                 be accessed after the function has returned.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSolveFnB">IDALsPrecSolveFnB</a></li></ul>
</div>


<pre><span id="TYPEprec_solve_fn_with_sens"><span class="keyword">type</span> <code class="type">'d</code> prec_solve_fn_with_sens</span> = <code class="type">(unit, 'd) <a href="Idas.Adjoint.html#TYPEjacobian_arg">Idas.Adjoint.jacobian_arg</a> -><br>       'd array -> 'd array -> 'd -> 'd -> float -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Callback functions that solve a linear system involving a
        preconditioner matrix with forward sensitivities.
        In the call <code class="code">prec_solve_fn&nbsp;jac&nbsp;ys&nbsp;yps&nbsp;r&nbsp;z&nbsp;delta</code>,</p>
<ul>
<li><code class="code">jac</code> is a <a href="Idas.Adjoint.html#TYPEjacobian_arg"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.jacobian_arg</code></a> with no work vectors,</li>
<li><code class="code">ys</code> contains the sensitivities of the forward solution,</li>
<li><code class="code">yps</code> contains the derivatives of the forward solution
                sensitivities,</li>
<li><code class="code">r</code> is the right-hand side vector,</li>
<li><code class="code">z</code> is computed to solve $Pz = r$, and</li>
<li><code class="code">delta</code> is the input tolerance.
        $P$ is a preconditioner matrix, which approximates, however crudely,
        the Jacobian matrix
        $\frac{\partial F}{\partial y} + \mathtt{arg.jac\_coef}\frac{\partial F}{\partial\dot{y}}$.
        If the solution is found via an iterative method, it must satisfy
        $\sqrt{\sum_i (\mathit{Res}_i \cdot \mathit{ewt}_i)^2}
              < \mathtt{delta}$,
        where $\mathit{Res} = r - Pz$ and $\mathit{ewt}$ comes from
        <a href="Idas.Adjoint.html#VALget_err_weights"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.get_err_weights</code></a>.</li>
</ul>
<p>Raising <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> indicates a recoverable
        error. Any other exception is treated as an unrecoverable error.</p>

<p><div class="warningbox"> The elements of <code class="code">jac</code>, <code class="code">ys</code>, <code class="code">yps</code>, <code class="code">r</code>, and <code class="code">z</code> should not
                 be accessed after the function has returned.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSolveFnBS">IDALsPrecSolveFnBS</a></li></ul>
</div>


<pre><span id="TYPEprec_setup_fn"><span class="keyword">type</span> <code class="type">'d</code> prec_setup_fn</span> = <code class="type">(unit, 'd) <a href="Idas.Adjoint.html#TYPEjacobian_arg">Idas.Adjoint.jacobian_arg</a> -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Callback functions that preprocess or evaluate Jacobian-related data
        need by <a href="Idas.Adjoint.Spils.html#TYPEprec_solve_fn"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.<span class="constructor">Spils</span>.prec_solve_fn</code></a> without forward sensitivities.
        The only argument is a <a href="Idas.Adjoint.html#TYPEjacobian_arg"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.jacobian_arg</code></a> with no work vectors.</p>

<p>Raising <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> indicates a recoverable
        error. Any other exception is treated as an unrecoverable error.</p>

<p><div class="warningbox"> The elements of the argument should not be accessed after
                 the function has returned.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSetupFnB">IDALsPrecSetupFnB</a></li></ul>
</div>


<pre><span id="TYPEprec_setup_fn_with_sens"><span class="keyword">type</span> <code class="type">'d</code> prec_setup_fn_with_sens</span> = <code class="type">(unit, 'd) <a href="Idas.Adjoint.html#TYPEjacobian_arg">Idas.Adjoint.jacobian_arg</a> -> 'd array -> 'd array -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Callback functions that preprocess or evaluate Jacobian-related data
        need by <a href="Idas.Adjoint.Spils.html#TYPEprec_solve_fn"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.<span class="constructor">Spils</span>.prec_solve_fn</code></a> with forward sensitivities.
        In the call <code class="code">prec_setup_fn&nbsp;jac&nbsp;ys&nbsp;yps</code>,</p>
<ul>
<li><code class="code">jac</code> is a <a href="Idas.Adjoint.html#TYPEjacobian_arg"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.jacobian_arg</code></a> with no work vectors,</li>
<li><code class="code">ys</code> contains the sensitivities of the forward solution, and</li>
<li><code class="code">yps</code> contains the derivatives of the forward solution
                sensitivities.</li>
</ul>
<p>Raising <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> indicates a recoverable
        error. Any other exception is treated as an unrecoverable error.</p>

<p><div class="warningbox"> The elements of the arguments should not be accessed after
                 the function has returned.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSetupFnBS">IDALsPrecSetupFnBS</a></li></ul>
</div>


<pre><span id="TYPEpreconditioner"><span class="keyword">type</span> <code class="type">('d, 'k)</code> preconditioner</span> = <code class="type">('d, 'k) AdjointTypes.SpilsTypes.preconditioner</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Specifies a preconditioner and its callback functions.
        The following functions and those in <a href="Idas_bbd.html"><code class="code"><span class="constructor">Idas_bbd</span></code></a> construct
        preconditioners.</p>

<p>The <a href="Idas.Adjoint.Spils.html#TYPEprec_solve_fn"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.<span class="constructor">Spils</span>.prec_solve_fn</code></a> is mandatory. The <a href="Idas.Adjoint.Spils.html#TYPEprec_setup_fn"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.<span class="constructor">Spils</span>.prec_setup_fn</code></a> can be
        omitted if not needed.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsSetPreconditionerB">IDALsSetPreconditionerB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsSetPreconditionerBS">IDALsSetPreconditionerBS</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSolveFnB">IDALsPrecSolveFnB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSetupFnB">IDALsPrecSetupFnB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSolveFnBS">IDALsPrecSolveFnBS</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAlsPrecSetupFnBS">IDAlsPrecSetupFnBS</a></li></ul>
</div>


<pre><span id="VALprec_none"><span class="keyword">val</span> prec_none</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.Spils.html#TYPEpreconditioner">preconditioner</a></code></pre><div class="info ">
<div class="info-desc">
<p>No preconditioning.</p>
</div>
</div>

<pre><span id="VALprec_left"><span class="keyword">val</span> prec_left</span> : <code class="type">?setup:'d <a href="Idas.Adjoint.Spils.html#TYPEprec_setup_fn">prec_setup_fn</a> -><br>       'd <a href="Idas.Adjoint.Spils.html#TYPEprec_solve_fn">prec_solve_fn</a> -><br>       ('d, 'k) <a href="Idas.Adjoint.Spils.html#TYPEpreconditioner">preconditioner</a></code></pre><div class="info ">
<div class="info-desc">
<p>Left preconditioning without forward sensitivities.
        $Pz = r$, where $P$ approximates, perhaps crudely,
        $J = \frac{\partial F}{\partial y} + c_j\frac{\partial F}{\partial\dot{y}}$.</p>
</div>
</div>

<pre><span id="VALprec_left_with_sens"><span class="keyword">val</span> prec_left_with_sens</span> : <code class="type">?setup:'d <a href="Idas.Adjoint.Spils.html#TYPEprec_setup_fn_with_sens">prec_setup_fn_with_sens</a> -><br>       'd <a href="Idas.Adjoint.Spils.html#TYPEprec_solve_fn_with_sens">prec_solve_fn_with_sens</a> -><br>       ('d, 'k) <a href="Idas.Adjoint.Spils.html#TYPEpreconditioner">preconditioner</a></code></pre><div class="info ">
<div class="info-desc">
<p>Left preconditioning with forward sensitivities.
        $Pz = r$, where $P$ approximates, perhaps crudely,
        $J = \frac{\partial F}{\partial y} + c_j\frac{\partial F}{\partial\dot{y}}$.</p>
</div>
</div>
<h4 id="lsolvers">Solvers</h4>
<pre><span id="TYPEjac_times_setup_fn_no_sens"><span class="keyword">type</span> <code class="type">'d</code> jac_times_setup_fn_no_sens</span> = <code class="type">(unit, 'd) <a href="Idas.Adjoint.html#TYPEjacobian_arg">Idas.Adjoint.jacobian_arg</a> -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Callback functions that preprocess or evaluate Jacobian-related
        data needed by the jac_times_vec_fn. In the call
        <code class="code">jac_times_setup_fn&nbsp;arg</code>, <code class="code">arg</code> is a <a href="Idas.Adjoint.html#TYPEjacobian_arg"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.jacobian_arg</code></a> with no
        work vectors.</p>

<p>Raising <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> indicates a recoverable
        error. Any other exception is treated as an unrecoverable error.</p>

<p><div class="warningbox"> The elements of <code class="code">arg</code> should not be accessed after the
                 function has returned.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetJacTimesVecFnB">IDASetJacTimesVecFnB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsJacTimesSetupFnB">IDALsJacTimesSetupFnB</a></li></ul>
</div>


<pre><span id="TYPEjac_times_setup_fn_with_sens"><span class="keyword">type</span> <code class="type">'d</code> jac_times_setup_fn_with_sens</span> = <code class="type">(unit, 'd) <a href="Idas.Adjoint.html#TYPEjacobian_arg">Idas.Adjoint.jacobian_arg</a> -> 'd array -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Callback functions that preprocess or evaluate Jacobian-related
        data needed by the jac_times_vec_fn. In the call
        <code class="code">jac_times_setup_fn&nbsp;arg&nbsp;s</code>, <code class="code">arg</code> is a <a href="Idas.Adjoint.html#TYPEjacobian_arg"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.jacobian_arg</code></a> with no
        work vectors and <code class="code">s</code> is an array of forward sensitivity vectors.</p>

<p>Raising <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> indicates a recoverable
        error. Any other exception is treated as an unrecoverable error.</p>

<p><div class="warningbox"> The elements of <code class="code">arg</code> should not be accessed after the
                 function has returned.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetJacTimesVecFnBS">IDASetJacTimesVecFnBS</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsJacTimesSetupFnBS">IDALsJacTimesSetupFnBS</a></li></ul>
</div>


<pre><span id="TYPEjac_times_vec_fn_no_sens"><span class="keyword">type</span> <code class="type">'d</code> jac_times_vec_fn_no_sens</span> = <code class="type">('d, 'd) <a href="Idas.Adjoint.html#TYPEjacobian_arg">Idas.Adjoint.jacobian_arg</a> -> 'd -> 'd -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Callback functions that compute the Jacobian times a vector without
        forward sensitivities.
        In the call <code class="code">jac_times_vec_fn&nbsp;arg&nbsp;v&nbsp;jv</code>,</p>
<ul>
<li><code class="code">arg</code> is a <a href="Idas.Adjoint.html#TYPEjacobian_arg"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.jacobian_arg</code></a> with two work vectors,</li>
<li><code class="code">v</code> is the vector multiplying the Jacobian, and</li>
<li><code class="code">jv</code> is the vector in which to store the
               result—$\mathtt{jv} = J\mathtt{v}$.</li>
</ul>
<p>Raising <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> indicates a recoverable error.
        Any other exception is treated as an unrecoverable error.</p>

<p><div class="warningbox"> Neither the elements of <code class="code">arg</code> nor <code class="code">v</code> or <code class="code">jv</code> should be
                 accessed after the function has returned.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsJacTimesVecFnB">IDALsJacTimesVecFnB</a></li></ul>
</div>


<pre><span id="TYPEjac_times_vec_fn_with_sens"><span class="keyword">type</span> <code class="type">'d</code> jac_times_vec_fn_with_sens</span> = <code class="type">('d, 'd) <a href="Idas.Adjoint.html#TYPEjacobian_arg">Idas.Adjoint.jacobian_arg</a> -><br>       'd array -> 'd array -> 'd -> 'd -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Callback functions that compute the Jacobian times a vector with
        forward sensitivities.
        In the call <code class="code">jac_times_vec_fn&nbsp;arg&nbsp;ys&nbsp;yps&nbsp;v&nbsp;jv</code>,</p>
<ul>
<li><code class="code">arg</code> is a <a href="Idas.Adjoint.html#TYPEjacobian_arg"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.jacobian_arg</code></a> with two work vectors,</li>
<li><code class="code">ys</code> contains the sensitivities of the forward solution,</li>
<li><code class="code">yps</code> contains the derivatives of the forward solution
                sensitivities.</li>
<li><code class="code">v</code> is the vector multiplying the Jacobian, and</li>
<li><code class="code">jv</code> is the vector in which to store the
               result—$\mathtt{jv} = J\mathtt{v}$.</li>
</ul>
<p>Raising <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> indicates a recoverable error.
        Any other exception is treated as an unrecoverable error.</p>

<p><div class="warningbox"> Neither the elements of <code class="code">arg</code>, <code class="code">ys</code>, <code class="code">yps</code>, <code class="code">v</code> nor <code class="code">jv</code>
                 should be accessed after the function has returned.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsJacTimesVecFnBS">IDALsJacTimesVecFnBS</a></li></ul>
</div>


<pre><code><span id="TYPEjac_times_vec_fn"><span class="keyword">type</span> <code class="type">'d</code> jac_times_vec_fn</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjac_times_vec_fn.NoSens"><span class="constructor">NoSens</span></span> <span class="keyword">of</span> <code class="type">'d <a href="Idas.Adjoint.Spils.html#TYPEjac_times_setup_fn_no_sens">jac_times_setup_fn_no_sens</a> option<br>        * 'd <a href="Idas.Adjoint.Spils.html#TYPEjac_times_vec_fn_no_sens">jac_times_vec_fn_no_sens</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Does not depend on forward sensitivities.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjac_times_vec_fn.WithSens"><span class="constructor">WithSens</span></span> <span class="keyword">of</span> <code class="type">'d <a href="Idas.Adjoint.Spils.html#TYPEjac_times_setup_fn_with_sens">jac_times_setup_fn_with_sens</a> option<br>        * 'd <a href="Idas.Adjoint.Spils.html#TYPEjac_times_vec_fn_with_sens">jac_times_vec_fn_with_sens</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Depends on forward sensitivities.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Callback functions that compute the Jacobian times a vector.</p>

<p>Depends on forward sensitivities.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsJacTimesVecFnB">IDALsJacTimesVecFnB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsJacTimesVecFnBS">IDALsJacTimesVecFnBS</a></li></ul>
</div>


<pre><span id="VALsolver"><span class="keyword">val</span> solver</span> : <code class="type">('m, 'd, 'k, 'f) Sundials.LinearSolver.t -><br>       ?jac_times_vec:'d <a href="Idas.Adjoint.Spils.html#TYPEjac_times_vec_fn">jac_times_vec_fn</a> -><br>       ?jac_times_res:'d <a href="Ida.html#TYPEresfn">Ida.resfn</a> -><br>       ('d, 'k) <a href="Idas.Adjoint.Spils.html#TYPEpreconditioner">preconditioner</a> -><br>       ('d, 'k) <a href="Idas.Adjoint.html#TYPElinear_solver">Idas.Adjoint.linear_solver</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create a Idas-specific linear solver from a generic iterative
        linear solver.</p>

<p>The <code class="code">jac_times_res</code> argument specifies an alternative DAE residual
        function for use in the internal Jacobian-vector product difference
        quotient approximation. It is incorrect to specify both this argument
        and <code class="code">jac_times_vec</code>.</p>

<p>NB: the <code class="code">jac_times_setup</code> argument is not supported in
            <a href="Sundials_Config.html#VALsundials_version">Config.sundials_version</a> &lt; 3.0.0.</p>

<p>NB: a <code class="code">jac_times_rhs</code> function is not supported in
            <a href="Sundials_Config.html#VALsundials_version">Config.sundials_version</a> &lt; 5.3.0.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetLinearSolverB">IDASetLinearSolverB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetJacTimesVecFnB">IDASetJacTimesVecFnB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetJacTimesVecFnBS">IDASetJacTimesVecFnBS</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetJacTimesResFnB">IDASetJacTimesResFnB</a></li></ul>
</div>
<h4 id="set">Solver parameters</h4>
<pre><span id="VALset_eps_lin"><span class="keyword">val</span> set_eps_lin</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the factor by which the Krylov linear solver's convergence test
        constant is reduced from the Newton iteration test constant.
        This factor must be &gt;= 0; passing 0 specifies the default (0.05).</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetEpsLinB">IDASetEpsLinB</a></li></ul>
</div>

<pre><span id="VALset_ls_norm_factor"><span class="keyword">val</span> set_ls_norm_factor</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the factor for converting from the integrator tolerance (WRMS
        norm) to the linear solver tolerance (L2 norm). That is,
        $\mathit{tol}_{\mathsf{L2}} =
            \mathit{fact}\cdot\mathit{tol}_{\mathsf{WRMS}}$ .
        The given value is used directly if it is greater than zero.
        If it is zero (the default), then the square root of the state
        vector length is used.
        If it is less than zero, then the square root of the dot product of a
        state vector full of ones with itself is used.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAStepSetLSNormFactorB">IDAStepSetLSNormFactorB</a></li></ul>
</div>

<pre><span id="VALset_linear_solution_scaling"><span class="keyword">val</span> set_linear_solution_scaling</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> bool -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Enables or disables scaling of the linear system solution to account
        for a change in $\gamma$  in the linear system. Linear solution
        scaling is enabled by default when a matrix-based linear solver is
        attached.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.2.0</li>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetLinearSolutionScalingB">IDASetLinearSolutionScalingB</a></li></ul>
</div>

<pre><span id="VALset_increment_factor"><span class="keyword">val</span> set_increment_factor</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the increment factor (<code class="code">dqincfac</code>) to use in the difference-quotient
        approximation for the backward problem.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/SIM.html#c.IDASetIncrementFactorB">IDASetIncrementFactorB</a></li></ul>
</div>
<h4 id="stats">Solver statistics</h4>
<pre><span id="VALget_work_space"><span class="keyword">val</span> get_work_space</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the sizes of the real and integer workspaces used by the
        linear solver.</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">real_size</code>, <code class="code">integer_size</code>)</li>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetLinWorkSpace">IDAGetLinWorkSpace</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetAdjIDABmem">IDAGetAdjIDABmem</a></li></ul>
</div>

<pre><span id="VALget_num_lin_iters"><span class="keyword">val</span> get_num_lin_iters</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of linear iterations.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetNumLinIters">IDAGetNumLinIters</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetAdjIDABmem">IDAGetAdjIDABmem</a></li></ul>
</div>

<pre><span id="VALget_num_lin_conv_fails"><span class="keyword">val</span> get_num_lin_conv_fails</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of linear convergence failures.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetNumLinConvFails">IDAGetNumLinConvFails</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetAdjIDABmem">IDAGetAdjIDABmem</a></li></ul>
</div>

<pre><span id="VALget_num_prec_evals"><span class="keyword">val</span> get_num_prec_evals</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls to the setup function.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetNumPrecEvals">IDAGetNumPrecEvals</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetAdjIDABmem">IDAGetAdjIDABmem</a></li></ul>
</div>

<pre><span id="VALget_num_prec_solves"><span class="keyword">val</span> get_num_prec_solves</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of calls to the preconditioner solve
        function.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetNumPrecSolves">IDAGetNumPrecSolves</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetAdjIDABmem">IDAGetAdjIDABmem</a></li></ul>
</div>

<pre><span id="VALget_num_jtsetup_evals"><span class="keyword">val</span> get_num_jtsetup_evals</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of calls to the Jacobian-vector
        setup function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 3.0.0</li>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetNumJTSetupEvals">IDAGetNumJTSetupEvals</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetAdjIDABmem">IDAGetAdjIDABmem</a></li></ul>
</div>

<pre><span id="VALget_num_jtimes_evals"><span class="keyword">val</span> get_num_jtimes_evals</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of calls to the Jacobian-vector
        function.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetNumJtimesEvals">IDAGetNumJtimesEvals</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetAdjIDABmem">IDAGetAdjIDABmem</a></li></ul>
</div>

<pre><span id="VALget_num_lin_res_evals"><span class="keyword">val</span> get_num_lin_res_evals</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls to the residual callback for
        finite difference Jacobian-vector product approximation. This counter is
        only updated if the default difference quotient function is used.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetNumLinResEvals">IDAGetNumLinResEvals</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAGetAdjIDABmem">IDAGetAdjIDABmem</a></li></ul>
</div>
<h4 id="lowlevel">Low-level solver manipulation</h4>
<p>The <a href="Idas.Adjoint.html#VALinit"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.init</code></a> and <a href="Idas.Adjoint.html#VALreinit"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Adjoint</span>.reinit</code></a> functions are the preferred way to set or
        change preconditioner functions. These low-level functions are provided
        for experts who want to avoid resetting internal counters and other
        associated side-effects.</p>

<pre><span id="VALset_preconditioner"><span class="keyword">val</span> set_preconditioner</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -><br>       ?setup:'d <a href="Idas.Adjoint.Spils.html#TYPEprec_setup_fn">prec_setup_fn</a> -><br>       'd <a href="Idas.Adjoint.Spils.html#TYPEprec_solve_fn">prec_solve_fn</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Change the preconditioner functions without using forward
        sensitivities.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetPreconditionerB">IDASetPreconditionerB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSolveFnB">IDALsPrecSolveFnB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSetupFnB">IDALsPrecSetupFnB</a></li></ul>
</div>

<pre><span id="VALset_preconditioner_with_sens"><span class="keyword">val</span> set_preconditioner_with_sens</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -><br>       ?setup:'d <a href="Idas.Adjoint.Spils.html#TYPEprec_setup_fn_with_sens">prec_setup_fn_with_sens</a> -><br>       'd <a href="Idas.Adjoint.Spils.html#TYPEprec_solve_fn_with_sens">prec_solve_fn_with_sens</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Change the preconditioner functions using forward sensitivities.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetPreconditionerBS">IDASetPreconditionerBS</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSolveFnBS">IDALsPrecSolveFnBS</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsPrecSetupFnBS">IDALsPrecSetupFnBS</a></li></ul>
</div>

<pre><span id="VALset_jac_times"><span class="keyword">val</span> set_jac_times</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -><br>       'd <a href="Idas.Adjoint.Spils.html#TYPEjac_times_vec_fn">jac_times_vec_fn</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Change the Jacobian-times-vector function.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetJacTimesVecFnB">IDASetJacTimesVecFnB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetJacTimesVecFnBS">IDASetJacTimesVecFnBS</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDALsJacTimesVecFnB">IDALsJacTimesVecFnB</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDAJacTimesVecFnBS">IDAJacTimesVecFnBS</a></li></ul>
</div>

<pre><span id="VALclear_jac_times"><span class="keyword">val</span> clear_jac_times</span> : <code class="type">('d, 'k) <a href="Idas.Adjoint.html#TYPEbsession">Idas.Adjoint.bsession</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Remove a Jacobian-times-vector function and use the default
        implementation.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/ADJ.html#c.IDASetJacTimesVecFnB">IDASetJacTimesVecFnB</a></li></ul>
</div>
</body></html>
