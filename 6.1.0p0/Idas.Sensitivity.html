<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Idas.Quadrature.html">
<link rel="next" href="Idas.Adjoint.html">
<link rel="Up" href="Idas.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Sundials_parallel" rel="Chapter" href="Sundials_parallel.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Initialization" rel="Section" href="#init">
<link title="Output functions" rel="Section" href="#sensout">
<link title="Modifying the solver (optional input functions)" rel="Section" href="#set">
<link title="Querying the solver (optional output functions)" rel="Section" href="#get">
<link title="Exceptions" rel="Section" href="#exceptions">
<link title="Initial Condition Calculation" rel="Subsection" href="#calcic">
<title>Sundials/ML 6.1.0p0 : Idas.Sensitivity</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Idas.Quadrature.html" title="Idas.Quadrature">Previous</a>
&nbsp;<a class="up" href="Idas.html" title="Idas">Up</a>
&nbsp;<a class="post" href="Idas.Adjoint.html" title="Idas.Adjoint">Next</a>
</div>
<h1>Module <a href="type_Idas.Sensitivity.html">Idas.Sensitivity</a></h1>

<pre><span id="MODULESensitivity"><span class="keyword">module</span> Sensitivity</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Idas.Sensitivity.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>(Forward) Sensitivity analysis of DAEs with respect to their parameters.</p>

<p>Formalizes the dependency of a set of DAEs on $N_p$ parameters $p$ and
    calculates the sensitivities $s$ and their derivatives $\dot{s}$
    of the solutions $y$ and $\dot{y}$ relative to a subset of
    $N_s \leq N_p$ of those parameters such that the $i$th sensitivity
    satisfies the <i>(forward) sensitivity equations</i>:
    $\frac{\partial F}{\partial y}s_i(t) + \frac{\partial F}{\partial \dot{y}}\dot{s}_i(t) + \frac{\partial F}{\partial p_i} = 0$,
    $s_i(t_0) = \frac{\partial y_0(p)}{\partial p_i}$, and,
    $\dot{s_i}(t_0) = \frac{\partial \dot{y}_0(p)}{\partial p_i}$, where
    $F$, $y$, and $\dot{y}$ are from the $N$ equations of the original
    model.</p>

<p>This documented interface is structured as follows.</p>
<OL>
<li><a href="#init">Initialization</a> (including <a href="Idas.Sensitivity.Quadrature.html">Quadrature equations</a>)</li>
<li><a href="#sensout">Output functions</a></li>
<li><a href="#set">Modifying the solver</a></li>
<li><a href="#get">Querying the solver</a></li>
<li><a href="#exceptions">Exceptions</a></li>
</OL>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#using-idas-for-forward-sensitivity-analysis">Using IDAS for Forward Sensitivity Analysis</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#a-skeleton-of-the-user-s-main-program">Enhanced skeleton for sensitivity analysis</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Mathematics_link.html#forward-sensitivity-analysis">Forward sensitivity analysis</a></li></ul>
</div>
<hr width="100%">
<h3 id="init">Initialization</h3>
<pre><code><span id="TYPEsensresfn_args"><span class="keyword">type</span> <code class="type">'d</code> sensresfn_args</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensresfn_args.t">t</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The value of the independent variable.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensresfn_args.y">y</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The vector of dependent-variable values $y(t)$.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensresfn_args.y'">y'</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The vector of derivatives of dependent variables
          $\dot{y}(t)$.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensresfn_args.res">res</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The vector of current residuals.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensresfn_args.s">s</span>&nbsp;: <code class="type">'d array</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The array of sensitivity vectors.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensresfn_args.s'">s'</span>&nbsp;: <code class="type">'d array</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The array of sensitivity derivative vectors.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensresfn_args.tmp">tmp</span>&nbsp;: <code class="type">'d <a href="Ida.html#TYPEtriple">Ida.triple</a></code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Temporary storage vectors.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Arguments to <a href="Idas.Sensitivity.html#TYPEsensresfn"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Sensitivity</span>.sensresfn</code></a>.</p>
</div>
</div>


<pre><span id="TYPEsensresfn"><span class="keyword">type</span> <code class="type">'d</code> sensresfn</span> = <code class="type">'d <a href="Idas.Sensitivity.html#TYPEsensresfn_args">sensresfn_args</a> -> 'd array -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Sensitivity functions that calculate the residuals of all
      sensitivity equations. They are passed the arguments:</p>
<ul>
<li><code class="code">args</code>, which summarizes current values of state and sensitivty
                variables, and</li>
<li><code class="code">rs</code> an array of vectors for storing the calculated sensitivity
             residual values,
             $\mathit{rs}_i = \frac{\partial F}{\partial y}s_i(t) + \frac{\partial F}{\partial \dot{y}}\dot{s}_i(t) + \frac{\partial F}{\partial p_i}$ </li>
</ul>
<p>Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
      indicates a recoverable error. Any other exception is treated as an
      unrecoverable error.</p>

<p><div class="warningbox"> The vectors in the function arguments should not
               be accessed after the function returns.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASensResFn">IDASensResFn</a></li></ul>
</div>


<pre><code><span id="TYPEsens_method"><span class="keyword">type</span> <code class="type"></code>sens_method</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_method.Simultaneous"><span class="constructor">Simultaneous</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Correct state and sensitivity variables at the same time.
          <span class="cconst">(IDA_SIMULTANEOUS)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_method.Staggered"><span class="constructor">Staggered</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Correct sensitivity variables simultaneously, but only
          after the convergence of state variable corrections and
          when state variables pass the local error test.
          <span class="cconst">(IDA_STAGGERED)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Specifies a sensitivity solution method.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASensInit">IDASensInit</a></li></ul>
</div>


<pre><code><span id="TYPEsens_params"><span class="keyword">type</span> <code class="type"></code>sens_params</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_params.pvals">pvals</span>&nbsp;: <code class="type">Sundials.RealArray.t option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>An array of $N_p$ parameters $p$ in $F(t, y, \dot{y},
          p)$.  If specified, this array is updated by the solver
          to pass perturbed parameter values to the original
          residual and root functions.  Those functions must
          (re-)read parameter values from this array on every
          invocation.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_params.pbar">pbar</span>&nbsp;: <code class="type">Sundials.RealArray.t option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>An array of $N_s$ positive scaling factors. These are needed
          when estimating tolerances or using the internal difference
          quotient function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsens_params.plist">plist</span>&nbsp;: <code class="type">int array option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>An array of $N_s$ ($&lt; N_p$) indices specifying the parameters
          to analyze. If not specified, the first $N_s$ parameters are
          analyzed.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Specifies problem parameter information for sensitivity
      calculations.  Which fields are required varies as follows:</p>
<ul>
<li><code class="code">pvals</code> is mandatory if <a href="Idas.Sensitivity.html#VALinit"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Sensitivity</span>.init</code></a> and/or
        <a href="Idas.Sensitivity.Quadrature.html#VALinit"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Sensitivity</span>.<span class="constructor">Quadrature</span>.init</code></a> is not given a
        user-defined callback.  Otherwise, it is ignored.</li>
<li><code class="code">plist</code> is optional if <code class="code">pvals</code> is given.  Otherwise, it is
        ignored.</li>
<li><code class="code">pbar</code> is always meaningful and optional.</li>
</ul>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASetSensParams">IDASetSensParams</a></li></ul>
</div>


<pre><code><span id="TYPEtolerance"><span class="keyword">type</span> <code class="type">('d, 'k)</code> tolerance</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SStolerances"><span class="constructor">SStolerances</span></span> <span class="keyword">of</span> <code class="type">float * Sundials.RealArray.t</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><code class="code">(rel,&nbsp;abs)</code> : scalar relative and absolute tolerances.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SVtolerances"><span class="constructor">SVtolerances</span></span> <span class="keyword">of</span> <code class="type">float * ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><code class="code">(rel,&nbsp;abs)</code> : scalar relative and vector absolute tolerances.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.EEtolerances"><span class="constructor">EEtolerances</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Calculate the integration tolerances for sensitivities
          from those of state variables and the scaling factors
          in <a href="Idas.Sensitivity.html#TYPEsens_params">pbar</a>.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Tolerances for calculating sensitivities.</p>
</div>
</div>


<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -><br>       ('d, 'k) <a href="Idas.Sensitivity.html#TYPEtolerance">tolerance</a> -><br>       <a href="Idas.Sensitivity.html#TYPEsens_method">sens_method</a> -><br>       ?sens_nlsolver:('d, 'k, ('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a>, [ `Sens ])<br>                      Sundials.NonlinearSolver.t -><br>       ?sens_params:<a href="Idas.Sensitivity.html#TYPEsens_params">sens_params</a> -><br>       ?fs:'d <a href="Idas.Sensitivity.html#TYPEsensresfn">sensresfn</a> -><br>       ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Activates the calculation of forward sensitivities. The call</p>
<pre class="codepre"><code class="code">init s tol sm ~sens_nlsolver ~sens_params ~fs s0 s0'</code></pre><p>has as arguments:</p>
<ul>
<li><code class="code">s</code>, a session created with <a href="Ida.html#VALinit"><code class="code"><span class="constructor">Ida</span>.init</code></a>,</li>
<li><code class="code">tol</code>, the tolerances desired,</li>
<li><code class="code">sm</code>, the solution method,</li>
<li><code class="code">sens_nlsolver</code>, the solver to use to calculate integration steps,</li>
<li><code class="code">sens_params</code>, the parameter information (see <a href="Idas.Sensitivity.html#TYPEsens_params"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Sensitivity</span>.sens_params</code></a>),</li>
<li><code class="code">fs</code>, the sensitivity function,</li>
<li><code class="code">s0</code>, initial values of the sensitivities for each parameter, and,</li>
<li><code class="code">s0'</code>, initial values of the sensitivity derivatives for each
               parameter.</li>
</ul>
<p>If <code class="code">~fs</code> is not given, an internal difference quotient routine
      is used.  In that case, or if the internal difference quotient
      routine will be specified in a subsequent call to
      <a href="Idas.Sensitivity.Quadrature.html#VALinit"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Sensitivity</span>.<span class="constructor">Quadrature</span>.init</code></a>, then <code class="code">sens_params</code> must be
      given with <code class="code">pvals</code> set to non-<code class="code"><span class="constructor">None</span></code>.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASensInit">IDASensInit</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASetSensParams">IDASetSensParams</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASensSStolerances">IDASensSStolerances</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASensSVtolerances">IDASensSVtolerances</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASensEEtolerances">IDASensEEtolerances</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASetNonlinearSolverSensSim">IDASetNonlinearSolverSensSim</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASetNonlinearSolverSensStg">IDASetNonlinearSolverSensStg</a></li></ul>
</div>

<pre><span id="VALreinit"><span class="keyword">val</span> reinit</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -><br>       <a href="Idas.Sensitivity.html#TYPEsens_method">sens_method</a> -><br>       ?sens_nlsolver:('d, 'k, ('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a>, [ `Sens ])<br>                      Sundials.NonlinearSolver.t -><br>       ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Reinitializes the forward sensitivity computation.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASensReInit">IDASensReInit</a></li></ul>
</div>

<pre><span id="VALtoggle_off"><span class="keyword">val</span> toggle_off</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Deactivates forward sensitivity calculations without deallocating
      memory. Sensitivities can be reactivated with <a href="Idas.Sensitivity.html#VALreinit"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Sensitivity</span>.reinit</code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASensToggleOff">IDASensToggleOff</a></li></ul>
</div>

<pre><span id="MODULEQuadrature"><span class="keyword">module</span> <a href="Idas.Sensitivity.Quadrature.html">Quadrature</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Idas.Sensitivity.Quadrature.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Support for quadrature sensitivity equations.</p>

</div>
<h4 id="calcic">Initial Condition Calculation</h4>
<pre><span id="VALcalc_ic_ya_yd'"><span class="keyword">val</span> calc_ic_ya_yd'</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -><br>       ?y:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -><br>       ?y':('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -><br>       ?s:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -><br>       ?s':('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> ?varid:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Identical to <a href="Ida.html#VALcalc_ic_ya_yd'"><code class="code"><span class="constructor">Ida</span>.calc_ic_ya_yd'</code></a>, but with the possibility of
      filling <code class="code">s</code> and <code class="code">s'</code> with the corrected sensitivity and sensitivity
      derivative values.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/SIM.html#c.IDACalcIC">IDACalcIC</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/SIM.html#c.IDAGetConsistentIC">IDAGetConsistentIC</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensConsistentIC">IDAGetSensConsistentIC</a></li></ul>
</div>

<pre><span id="VALcalc_ic_y"><span class="keyword">val</span> calc_ic_y</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -><br>       ?y:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ?s:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Identical to <a href="Ida.html#VALcalc_ic_y"><code class="code"><span class="constructor">Ida</span>.calc_ic_y</code></a>, but with the possibility of
      filling <code class="code">s</code> with the corrected sensitivity values.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/SIM.html#c.IDACalcIC">IDACalcIC</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/SIM.html#c.IDAGetConsistentIC">IDAGetConsistentIC</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensConsistentIC">IDAGetSensConsistentIC</a></li></ul>
</div>
<h3 id="sensout">Output functions</h3>
<pre><span id="VALget"><span class="keyword">val</span> get</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the sensitivity solution vectors after a successful solver
      step. The given vectors are filled with values calculated during
      either <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> or <a href="Ida.html#VALsolve_one_step"><code class="code"><span class="constructor">Ida</span>.solve_one_step</code></a> and the
      value of the independent variable is returned.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSens">IDAGetSens</a></li></ul>
</div>

<pre><span id="VALget_dky"><span class="keyword">val</span> get_dky</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> float -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the interpolated solution or derivatives of the sensitivity
      solution vectors.</p>

<p><code class="code">get_dky&nbsp;s&nbsp;dks&nbsp;t&nbsp;k</code> computes the <code class="code">k</code>th derivative at time <code class="code">t</code>, i.e.,
      $\frac{d^\mathtt{k}s(\mathtt{t})}{\mathit{dt}^\mathtt{k}}$,
      and stores it in <code class="code">dks</code>. The arguments must satisfy $t_n - h_u \leq
      \mathtt{t} \leq t_n$—where $t_n$ denotes <a href="Ida.html#VALget_current_time"><code class="code"><span class="constructor">Ida</span>.get_current_time</code></a>
      and $h_u$ denotes <a href="Ida.html#VALget_last_step"><code class="code"><span class="constructor">Ida</span>.get_last_step</code></a>,— and
      $0 \leq \mathtt{k} \leq q_u$—where
      $q_u$ denotes <a href="Ida.html#VALget_last_order"><code class="code"><span class="constructor">Ida</span>.get_last_order</code></a>.</p>

<p>This function may only be called after a successful return from either
      <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> or <a href="Ida.html#VALsolve_one_step"><code class="code"><span class="constructor">Ida</span>.solve_one_step</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadT</code> <code class="code">t</code> is not in the interval $[t_n - h_u, t_n]$.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range 0, 1, ..., $q_u$.</li>
</ul></div>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensDky">IDAGetSensDky</a></li></ul>
</div>

<pre><span id="VALget1"><span class="keyword">val</span> get1</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> int -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns a single sensitivity solution vector after a successful solver
      step. The given vector is filled with values calculated for the <code class="code">i</code>th
      sensitivity vector during either <a href="Ida.html#VALsolve_normal"><code class="code"><span class="constructor">Ida</span>.solve_normal</code></a> or
      <a href="Ida.html#VALsolve_one_step"><code class="code"><span class="constructor">Ida</span>.solve_one_step</code></a> and the value of the independent variable is
      returned.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span> <code>BadIS</code> The index <code class="code">i</code> is not in the allowed range.</div>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSens1">IDAGetSens1</a></li></ul>
</div>

<pre><span id="VALget_dky1"><span class="keyword">val</span> get_dky1</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> int -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the interpolated solution or derivatives of a single
      sensitivity solution vector. <code class="code">get_dky&nbsp;s&nbsp;dks&nbsp;t&nbsp;k&nbsp;i</code> is like <a href="Idas.Sensitivity.html#VALget_dky"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Sensitivity</span>.get_dky</code></a>
      but restricted to the <code class="code">i</code>th sensitivity solution vector.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadIS</code> The index <code class="code">i</code> is not in the allowed range.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range 0, 1, ..., <code class="code">qlast</code>.</li>
<li><code>BadT</code> <code class="code">t</code> is not in the allowed range.</li>
</ul></div>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensDky1">IDAGetSensDky1</a></li></ul>
</div>
<h3 id="set">Modifying the solver (optional input functions)</h3>
<pre><span id="VALset_tolerances"><span class="keyword">val</span> set_tolerances</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> ('d, 'k) <a href="Idas.Sensitivity.html#TYPEtolerance">tolerance</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specify the integration tolerances for sensitivities.</p>

<p><b>NB</b>: Unlike the other <code class="code">set_tolerances</code> functions in <code class="code"><span class="constructor">Idas</span></code>, this
      one does <b>not</b> call <a href="Idas.Sensitivity.html#VALset_err_con"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Sensitivity</span>.set_err_con</code></a> (which defaults to <code class="code"><span class="keyword">false</span></code>).</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASensSStolerances">IDASensSStolerances</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASensSVtolerances">IDASensSVtolerances</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASensEEtolerances">IDASensEEtolerances</a></li></ul>
</div>

<pre><span id="VALset_err_con"><span class="keyword">val</span> set_err_con</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> bool -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets whether sensitivity variables are used in the error control
      mechanism. The default is <code class="code"><span class="keyword">false</span></code>.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASetSensErrCon">IDASetSensErrCon</a></li></ul>
</div>

<pre><code><span id="TYPEdq_method"><span class="keyword">type</span> <code class="type"></code>dq_method</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTdq_method.DQCentered"><span class="constructor">DQCentered</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>IDA_CENTERED</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTdq_method.DQForward"><span class="constructor">DQForward</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>IDA_FORWARD</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>A difference quotient strategy. See <a href="Idas.Sensitivity.html#VALset_dq_method"><code class="code"><span class="constructor">Idas</span>.<span class="constructor">Sensitivity</span>.set_dq_method</code></a>.</p>
</div>
</div>


<pre><span id="VALset_dq_method"><span class="keyword">val</span> set_dq_method</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> <a href="Idas.Sensitivity.html#TYPEdq_method">dq_method</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the difference quotient strategy when sensitivity equations
      are computed internally by the solver rather than via callback. A
      method and <code class="code">dqrhomax</code> value must be given. The latter determines when
      to switch between simultaneous or separate approximations of the two
      terms in the sensitivity residual.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASetSensDQMethod">IDASetSensDQMethod</a></li></ul>
</div>

<pre><span id="VALset_max_nonlin_iters"><span class="keyword">val</span> set_max_nonlin_iters</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of nonlinear solver iterations for
      sensitivity variables permitted per step.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDASetSensMaxNonlinIters">IDASetSensMaxNonlinIters</a></li></ul>
</div>
<h3 id="get">Querying the solver (optional output functions)</h3>
<pre><span id="VALget_num_res_evals"><span class="keyword">val</span> get_num_res_evals</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls to the sensitivity residual function.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensNumResEvals">IDAGetSensNumResEvals</a></li></ul>
</div>

<pre><span id="VALget_num_res_evals_sens"><span class="keyword">val</span> get_num_res_evals_sens</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls to the residual function due
      to the internal finite difference approximation of the sensitivity
      residual.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetNumResEvalsSens">IDAGetNumResEvalsSens</a></li></ul>
</div>

<pre><span id="VALget_num_err_test_fails"><span class="keyword">val</span> get_num_err_test_fails</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of local error test failures for the sensitivity
      variables that have occurred.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensNumErrTestFails">IDAGetSensNumErrTestFails</a></li></ul>
</div>

<pre><span id="VALget_num_lin_solv_setups"><span class="keyword">val</span> get_num_lin_solv_setups</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls made to the linear solver's setup function
      due to forward sensitivity calculations.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensNumLinSolvSetups">IDAGetSensNumLinSolvSetups</a></li></ul>
</div>

<pre><code><span id="TYPEsensitivity_stats"><span class="keyword">type</span> <code class="type"></code>sensitivity_stats</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_sens_evals">num_sens_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of calls to the sensitivity function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_res_evals">num_res_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of calls to the residual function to
            calculate sensitivities.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_err_test_fails">num_err_test_fails</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of local error test failures for sensitivity variables.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsensitivity_stats.num_lin_solv_setups">num_lin_solv_setups</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of setups calls to the linear solver for sensitivity
            calculations.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Summaries of sensitivity stats.</p>
</div>
</div>


<pre><span id="VALget_stats"><span class="keyword">val</span> get_stats</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> <a href="Idas.Sensitivity.html#TYPEsensitivity_stats">sensitivity_stats</a></code></pre><div class="info ">
<div class="info-desc">
<p>Returns the sensitivity-related statistics as a group.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensStats">IDAGetSensStats</a></li></ul>
</div>

<pre><span id="VALget_err_weights"><span class="keyword">val</span> get_err_weights</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the sensitivity error weights at the current time.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensErrWeights">IDAGetSensErrWeights</a></li><li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Mathematics_link.html#equation-idas-errwt">IVP solution (W_i)</a></li></ul>
</div>

<pre><span id="VALget_num_nonlin_solv_iters"><span class="keyword">val</span> get_num_nonlin_solv_iters</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear iterations for sensitivity
      calculations.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensNumNonlinSolvIters">IDAGetSensNumNonlinSolvIters</a></li></ul>
</div>

<pre><span id="VALget_num_nonlin_solv_conv_fails"><span class="keyword">val</span> get_num_nonlin_solv_conv_fails</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulativ number of nonlinear convergence failures during
      sensitivity calculations.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensNumNonlinSolvConvFails">IDAGetSensNumNonlinSolvConvFails</a></li></ul>
</div>

<pre><span id="VALget_nonlin_solv_stats"><span class="keyword">val</span> get_nonlin_solv_stats</span> : <code class="type">('d, 'k) <a href="Ida.html#TYPEsession">Ida.session</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns both the numbers of nonlinear iterations performed <code class="code">nniters</code>
      and nonlinear convergence failures <code class="code">nncfails</code> during sensitivity
      calculations.</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">nniters</code>, <code class="code">nncfails</code>)</li>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetSensNonlinSolvStats">IDAGetSensNonlinSolvStats</a></li></ul>
</div>

<pre><span id="VALget_current_y_sens"><span class="keyword">val</span> get_current_y_sens</span> : <code class="type">('d, 'k) <a href="Idas.html#TYPEsession">Idas.session</a> -> 'd array</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the current sensitivity vector array. Its elements provide
      direct access to the data within the integrator.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetCurrentYSens">IDAGetCurrentYSens</a></li></ul>
</div>

<pre><span id="VALget_current_yp_sens"><span class="keyword">val</span> get_current_yp_sens</span> : <code class="type">('d, 'k) <a href="Idas.html#TYPEsession">Idas.session</a> -> 'd array</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the derivative of the current sensitivity vector array. Its
      elements provide direct access to the data within the integrator.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetCurrentYpSens">IDAGetCurrentYpSens</a></li></ul>
</div>

<pre><code><span id="TYPEnonlin_system_data"><span class="keyword">type</span> <code class="type">'d</code> nonlin_system_data</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.tn">tn</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Independent variable value $t_n$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.yyspred">yyspred</span>&nbsp;: <code class="type">'d array</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Predicted value of $\mathit{yS}_{i,\mathit{pred}}$ 
          at $t_n$  for $i = 0,\ldots,N_s-1$ .
          This data must not be changed.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.ypspred">ypspred</span>&nbsp;: <code class="type">'d array</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Predicted value of $\dot{y}S}_{i,\mathit{pred}}$ 
          at $t_n$  for $i = 0,\ldots,N_s-1$ .
          This data must not be changed.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.yysn">yysn</span>&nbsp;: <code class="type">'d array</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The vector $\mathit{yS}_{i,n}$ . This data may not be current
          and may need to be filled.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.ypsn">ypsn</span>&nbsp;: <code class="type">'d array</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The vector $\dot{y}S_{i,n}$ . This data may not be current
          and may need to be filled.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.cj">cj</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The scalar $c_j$  which is proportional to the inverse of
          the step size $\alpha$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Internal data required to construct the current nonlinear implicit
      system within a nonlinear solver.</p>
</div>
</div>


<pre><span id="VALget_nonlin_system_data"><span class="keyword">val</span> get_nonlin_system_data</span> : <code class="type">('d, 'k) <a href="Idas.html#TYPEsession">Idas.session</a> -> 'd <a href="Idas.Sensitivity.html#TYPEnonlin_system_data">nonlin_system_data</a></code></pre><div class="info ">
<div class="info-desc">
<p>Gives direct access to the internal data required to construct the
      current nonlinear system within a nonlinear solver. This
      function should be called inside the nonlinear system function.
      The vectors <code class="code">yysn</code> and <code class="code">ypsn</code> are provided as additional workspace and
      do not need to be filled in. They are only current after an evaluation
      of the nonlinear system function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAGetNonlinearSystemData">IDAGetNonlinearSystemData</a></li></ul>
</div>

<pre><span id="VALcompute_y_sens"><span class="keyword">val</span> compute_y_sens</span> : <code class="type">('d, 'k) <a href="Idas.html#TYPEsession">Idas.session</a> -><br>       ycor:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> y:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Computes the sensitiviites from a correction vector.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAComputeYSens">IDAComputeYSens</a></li></ul>
</div>

<pre><span id="VALcompute_yp_sens"><span class="keyword">val</span> compute_yp_sens</span> : <code class="type">('d, 'k) <a href="Idas.html#TYPEsession">Idas.session</a> -><br>       ycor:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> yp:('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Computes the sensitivity derivatives from a correction vector.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Usage/FSA.html#c.IDAComputeYpSens">IDAComputeYpSens</a></li></ul>
</div>
<h3 id="exceptions">Exceptions</h3>
<pre><span id="EXCEPTIONSensNotInitialized"><span class="keyword">exception</span> SensNotInitialized</span></pre>
<div class="info ">
<div class="info-desc">
<p>Sensitivity analysis was not initialized.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Constants_link.html">IDA_NO_SENS</a></li></ul>
</div>

<pre><span id="EXCEPTIONSensResFuncFailure"><span class="keyword">exception</span> SensResFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The sensitivity residual function failed in an unrecoverable manner.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Constants_link.html">IDA_SRES_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONRepeatedSensResFuncFailure"><span class="keyword">exception</span> RepeatedSensResFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Too many convergence test failures, or unable to estimate the initial
      step size, due to repeated recoverable errors in the sensitivity
      residual function.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Constants_link.html">IDA_REP_SRES_ERR</a></li></ul>
</div>

<pre><span id="EXCEPTIONBadSensIdentifier"><span class="keyword">exception</span> BadSensIdentifier</span></pre>
<div class="info ">
<div class="info-desc">
<p>The index passed to identify a particular sensitivity is invalid.</p>
</div>
<ul class="info-attributes">
<li class="sundials idas">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/idas/Constants_link.html">IDA_BAD_IS</a></li></ul>
</div>
</body></html>
