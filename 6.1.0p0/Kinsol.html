<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Cvode.html">
<link rel="next" href="Ida.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Sundials_parallel" rel="Chapter" href="Sundials_parallel.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Linear solvers" rel="Section" href="#linear">
<link title="Solver initialization and use" rel="Section" href="#solver">
<link title="Modifying the solver (optional input functions)" rel="Section" href="#set">
<link title="Querying the solver (optional output functions)" rel="Section" href="#get">
<link title="Exceptions" rel="Section" href="#exceptions">
<link title="Logging and error handling" rel="Subsection" href="#info">
<title>Sundials/ML 6.1.0p0 : Kinsol</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Cvode.html" title="Cvode">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Ida.html" title="Ida">Next</a>
</div>
<h1>Module <a href="type_Kinsol.html">Kinsol</a></h1>

<pre><span id="MODULEKinsol"><span class="keyword">module</span> Kinsol</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Kinsol.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>Solves nonlinear systems using Newton-Krylov techniques.</p>

<p>This module solves numerically problems of the form
    $F(u) = 0$ given an initial guess $u_0$.</p>

<p>This documented interface is structured as follows.</p>
<OL>
<li><a href="#linear">Linear solvers</a></li>
<li><a href="#solver">Solver initialization and use</a></li>
<li><a href="#set">Modifying the solver</a></li>
<li><a href="#get">Querying the solver</a></li>
<li><a href="#exceptions">Exceptions</a></li>
</OL>
</div>
<ul class="info-attributes">
<div class="authors"><b>Author(s):</b> Timothy Bourke (Inria/ENS), Jun Inoue (Inria/ENS), Marc Pouzet (UPMC/ENS/Inria)</div>
<li><b>Version:</b> 6.1.0</li>
</ul>
</div>
<hr width="100%">

<pre><span id="TYPEsession"><span class="keyword">type</span> <code class="type">('data, 'kind)</code> session</span> = <code class="type">('data, 'kind) session</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A session with the KINSOL solver.</p>

<p>An example session with Kinsol (<a href="kinsol_skel.ml">kinsol_skel.ml</a>):</p>
<pre class="codepre"><code class="code"><span class="keyword">open</span> <span class="constructor">Sundials</span>

<span class="comment">(* 1. Define a system function. *)</span>
<span class="keyword">let</span> pi, e = 4. *. atan 1., exp 1.
<span class="keyword">let</span> sysf u r =
  r.{0} &lt;- 0.5 *. sin(u.{0}*.u.{1}) -. 0.25 *. u.{1} /. pi -. 0.5 *. u.{0};
  r.{1} &lt;- (1. -. 0.25/.pi)*.(exp(2.*.u.{0})-.e) +. e*.u.{1}/.pi -. 2.*.e*.u.{0};
  r.{2} &lt;- u.{2} -. u.{0} +. 0.25;
  r.{3} &lt;- u.{3} -. u.{0} +. 1.0;
  r.{4} &lt;- u.{4} -. u.{1} +. 1.5;
  r.{5} &lt;- u.{5} -. u.{1} +. 2.0 *. pi

<span class="comment">(* 2. Set vector with initial guess.
      The length of this vector determines the problem size. *)</span>
<span class="keyword">let</span> ud = <span class="constructor">RealArray</span>.of_list [ 0.25; 1.5; 0.; -0.75; 0.; 1.5 -. 2. *.pi ]
<span class="keyword">let</span> u = <span class="constructor">Nvector_serial</span>.wrap ud

<span class="comment">(* 3. Create and initialize a solver session.
      This will initialize a specific linear solver. *)</span>
<span class="keyword">let</span> m = <span class="constructor">Matrix</span>.dense 6
<span class="keyword">let</span> s = <span class="constructor">Kinsol</span>.(init ~lsolver:(<span class="constructor">Dls</span>.(solver (dense u m))) sysf u);;

<span class="comment">(* 4. Set optional inputs, e.g.,
      call [set_*] functions to change solver parameters. *)</span>
<span class="keyword">let</span> c = <span class="constructor">RealArray</span>.of_list [
   <span class="constructor">Constraint</span>.unconstrained;
   <span class="constructor">Constraint</span>.unconstrained;
   <span class="constructor">Constraint</span>.geq_zero;
   <span class="constructor">Constraint</span>.leq_zero;
   <span class="constructor">Constraint</span>.geq_zero;
   <span class="constructor">Constraint</span>.leq_zero ] <span class="keyword">in</span>
<span class="constructor">Kinsol</span>.set_constraints s (<span class="constructor">Nvector_serial</span>.wrap c);
<span class="constructor">Kinsol</span>.set_func_norm_tol s 1.0e-5;
<span class="constructor">Kinsol</span>.set_scaled_step_tol s 1.0e-5;
<span class="constructor">Kinsol</span>.set_max_setup_calls s 1;;

<span class="comment">(* 5. Solve the problem. *)</span>
<span class="keyword">let</span> snv = <span class="constructor">Nvector_serial</span>.make (<span class="constructor">RealArray</span>.length ud) 1.0 <span class="keyword">in</span>
ignore (<span class="constructor">Kinsol</span>.(solve s u <span class="constructor">Newton</span> snv snv));

<span class="constructor">Printf</span>.printf <span class="string">"%8.5g %8.6g\n"</span> ud.{0} ud.{1};;

<span class="comment">(* 6. Get optional outputs,
      call the [get_*] functions to examine solver statistics. *)</span>
<span class="keyword">let</span> fnorm = <span class="constructor">Kinsol</span>.get_func_norm s;;
    </code></pre></div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#a-skeleton-of-the-users-main-program">Skeleton of main program</a></li></ul>
</div>


<pre><span id="TYPEserial_session"><span class="keyword">type</span> <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_session</span> = <code class="type">(<a href="Nvector_serial.html#TYPEdata">Nvector_serial.data</a>, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a) <a href="Kinsol.html#TYPEsession">session</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>Alias for sessions based on serial nvectors.</p>
</div>
</div>

<h3 id="linear">Linear solvers</h3>
<pre><span id="TYPElinear_solver"><span class="keyword">type</span> <code class="type">('data, 'kind)</code> linear_solver</span> = <code class="type">('data, 'kind) linear_solver</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Linear solvers used by Kinsol.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#linear-solver-specification-functions">Linear solver specification functions</a></li></ul>
</div>


<pre><span id="TYPEserial_linear_solver"><span class="keyword">type</span> <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_linear_solver</span> = <code class="type">(<a href="Nvector_serial.html#TYPEdata">Nvector_serial.data</a>, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a) <a href="Kinsol.html#TYPElinear_solver">linear_solver</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>Alias for linear solvers that are restricted to serial nvectors.</p>
</div>
</div>


<pre><span id="TYPEdouble"><span class="keyword">type</span> <code class="type">'d</code> double</span> = <code class="type">'d * 'd</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Workspaces with two temporary vectors.</p>
</div>
</div>


<pre><span id="TYPEjacobian_arg"><span class="keyword">type</span> <code class="type">('t, 'd)</code> jacobian_arg</span> = <code class="type">('t, 'd) jacobian_arg</code> = {</pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_u">jac_u</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The current unscaled iterate.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_fu">jac_fu</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The current value of the vector $F(u)$.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_tmp">jac_tmp</span>&nbsp;: <code class="type">'t</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Workspace data.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Arguments common to Jacobian callback functions.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINLsJacFn">KINLsJacFn</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINLsPrecSolveFn">KINLsPrecSolveFn</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINLsPrecSetupFn">KINLsPrecSetupFn</a></li></ul>
</div>


<pre><span id="TYPEsysfn"><span class="keyword">type</span> <code class="type">'data</code> sysfn</span> = <code class="type">'data -> 'data -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>System function that defines nonlinear problem. The call
    <code class="code">sysfun&nbsp;u&nbsp;fval</code> must calculate $F(u)$ into <code class="code">fval</code> using the current value
    vector <code class="code">u</code>.</p>

<p>Raising <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> indicates a recoverable error.
     Any other exception is treated as an unrecoverable error.</p>

<p><div class="warningbox"> <code class="code">u</code> and <code class="code">fval</code> should not be accessed after the function
             returns.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSysFn">KINSysFn</a></li></ul>
</div>


<pre><span id="MODULEDls"><span class="keyword">module</span> <a href="Kinsol.Dls.html">Dls</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Kinsol.Dls.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Direct Linear Solvers operating on dense, banded, and sparse matrices.</p>

</div>

<pre><span id="MODULESpils"><span class="keyword">module</span> <a href="Kinsol.Spils.html">Spils</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Kinsol.Spils.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Scaled Preconditioned Iterative Linear Solvers.</p>

</div>

<pre><span id="VALmatrix_embedded_solver"><span class="keyword">val</span> matrix_embedded_solver</span> : <code class="type">(unit, 'data, 'kind, [> `MatE ]) Sundials.LinearSolver.t -><br>       ('data, 'kind) <a href="Kinsol.html#TYPElinear_solver">linear_solver</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create a Kinsol-specific linear solver from a generic matrix embedded
    solver.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.8.0</li>
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetLinearSolver">KINSetLinearSolver</a></li></ul>
</div>
<h3 id="solver">Solver initialization and use</h3>
<pre><code><span id="TYPEorthaa"><span class="keyword">type</span> <code class="type"></code>orthaa</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTorthaa.MGS"><span class="constructor">MGS</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Modified Gram Schmidt (default)
                <span class="cconst">(KIN_ORTH_MGS)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTorthaa.ICWY"><span class="constructor">ICWY</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Inverse Compact WY Modified Gram Schmidt
                <span class="cconst">(KIN_ORTH_ICWY)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTorthaa.CGS2"><span class="constructor">CGS2</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Classical Gram Schmidt with Reorthogonalization
                <span class="cconst">(KIN_ORTH_CGS2)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTorthaa.DCGS2"><span class="constructor">DCGS2</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Classical Gram Schmidt with Delayed Reorthogonlization
                <span class="cconst">(KIN_ORTH_DCGS2)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Orthogonalization routines of the QR factorization portion of Anderson
    acceleration.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 6.0.0</li>
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetOrthAA">KINSetOrthAA</a></li></ul>
</div>


<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">?context:<a href="Sundials.Context.html#TYPEt">Sundials.Context.t</a> -><br>       ?max_iters:int -><br>       ?maa:int -><br>       ?orthaa:<a href="Kinsol.html#TYPEorthaa">orthaa</a> -><br>       ?lsolver:('data, 'kind) <a href="Kinsol.html#TYPElinear_solver">linear_solver</a> -><br>       'data <a href="Kinsol.html#TYPEsysfn">sysfn</a> -><br>       ('data, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('data, 'kind) <a href="Kinsol.html#TYPEsession">session</a></code></pre><div class="info ">
<div class="info-desc">
<p>Creates and initializes a session with the Kinsol solver. The call
    <code class="code">init&nbsp;~max_lin_iters:mli&nbsp;~maa:maa&nbsp;~linsolv:ls&nbsp;f&nbsp;tmpl</code> has as arguments:</p>
<ul>
<li><code class="code">mli</code>, the maximum number of nonlinear iterations allowed,</li>
<li><code class="code">maa</code>, the size of the Anderson acceleration subspace for the
              <a href="Kinsol.html#TYPEstrategy">Picard</a> and <a href="Kinsol.html#TYPEstrategy">FixedPoint</a> strategies,</li>
<li><code class="code">orthaa</code>, specifies the othogonalization routine to be used in the QR
                 factorization portion of Anderson acceleration,</li>
<li><code class="code">ls</code>, the linear solver to use (required for the <a href="Kinsol.html#TYPEstrategy">Newton</a>,
             <a href="Kinsol.html#TYPEstrategy">LineSearch</a>, and <a href="Kinsol.html#TYPEstrategy">Picard</a> strategies),</li>
<li><code class="code">f</code>,       the system function of the nonlinear problem, and,</li>
<li><code class="code">tmpl</code>     a template to initialize the session (e.g., the
                  initial guess vector).</li>
</ul>
<p>By default, the session is created using the context returned by
     <a href="Sundials.Context.html#VALdefault"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">Context</span>.default</code></a>, but this can be overridden by passing
     an optional <code class="code">context</code> argument.</p>

<p>The <code class="code">orthaa</code> argument is ignored in Sundials &lt; 6.0.0.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINCreate">KINCreate</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINInit">KINInit</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetNumMaxIters">KINSetNumMaxIters</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetMAA">KINSetMAA</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetOrthAA">KINSetOrthAA</a></li></ul>
</div>

<pre><code><span id="TYPEstrategy"><span class="keyword">type</span> <code class="type"></code>strategy</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTstrategy.Newton"><span class="constructor">Newton</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Basic Newton iteration. <span class="cconst">(KIN_NONE)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTstrategy.LineSearch"><span class="constructor">LineSearch</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Newton iteration with globalization.
                          <span class="cconst">(KIN_LINESEARCH)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTstrategy.Picard"><span class="constructor">Picard</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Picard iteration with Anderson Acceleration.
                          <span class="cconst">(KIN_PICARD)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTstrategy.FixedPoint"><span class="constructor">FixedPoint</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Fixed-point iteration with Anderson Acceleration.
                          <span class="cconst">(KIN_FP)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Strategy used to solve the nonlinear system.</p>
</div>
</div>


<pre><code><span id="TYPEresult"><span class="keyword">type</span> <code class="type"></code>result</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTresult.Success"><span class="constructor">Success</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The scaled norm of $F(u)$ is less than <code class="code">fnormtol</code>.
                          See <a href="Kinsol.html#VALset_func_norm_tol"><code class="code"><span class="constructor">Kinsol</span>.set_func_norm_tol</code></a>. <span class="cconst">(KIN_SUCCESS)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTresult.InitialGuessOK"><span class="constructor">InitialGuessOK</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The initial guess already satisfies the system.
                          <span class="cconst">(KIN_INITIAL_GUESS_OK)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTresult.StoppedOnStepTol"><span class="constructor">StoppedOnStepTol</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Stopped based on scaled step length. The
                          current iterate is an approximate solution, or the
                          algorithm stalled near an invalid solution, or
                          <code class="code">scsteptol</code> is too large
                          (see <a href="Kinsol.html#VALset_scaled_step_tol"><code class="code"><span class="constructor">Kinsol</span>.set_scaled_step_tol</code></a>).
                          <span class="cconst">(KIN_STEP_LT_STPTOL)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Results of nonlinear solution attempts.</p>
</div>
</div>


<pre><span id="VALsolve"><span class="keyword">val</span> solve</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -><br>       ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -><br>       <a href="Kinsol.html#TYPEstrategy">strategy</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> <a href="Kinsol.html#TYPEresult">result</a></code></pre><div class="info ">
<div class="info-desc">
<p>Computes an approximate solution to a nonlinear system. The call
    <code class="code">solve&nbsp;s&nbsp;u&nbsp;strategy&nbsp;u_scale&nbsp;f_scale</code> has arguments:</p>
<ul>
<li><code class="code">s</code>, a solver session,</li>
<li><code class="code">u</code>, an initial guess that is replaced with an approximate solution
           for $F(u) = 0$,</li>
<li><code class="code">strategy</code>, strategy used to solve the nonlinear system,</li>
<li><code class="code">u_scale</code>, the diagonal elements of the scaling matrix $D_u$ for
                 vector <code class="code">u</code> chosen so that all $D_u u$ all have roughly the
                 same magnitude when <code class="code">u</code> is close to a root of $F(u)$, and,</li>
<li><code class="code">f_scale</code>, the diagonal elements of the scaling matrix $D_f$ for
                 $F(u)$ chosen so that all $D_f F(u)$ have roughtly the same
                 magnitude when <code class="code">u</code> is not near a root of $F(u)$.</li>
</ul>
<p>The function either returns a <a href="Kinsol.html#TYPEresult"><code class="code"><span class="constructor">Kinsol</span>.result</code></a> or raises one of the exceptions
    listed below.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>MissingLinearSolver</code> A linear solver is required but was not given.</li>
<li><code>IllInput</code> Missing or illegal solver inputs.</li>
<li><code>LineSearchNonConvergence</code> Line search could not find a suitable iterate.</li>
<li><code>MaxIterationsReached</code> The maximum number of nonlinear iterations was reached.</li>
<li><code>MaxNewtonStepExceeded</code> Five consecutive steps satisfied a scaled step length test.</li>
<li><code>LineSearchBetaConditionFailure</code> Line search could not satisfy the beta-condition.</li>
<li><code>LinearSolverNoRecovery</code> The <a href="Kinsol.Spils.html#TYPEprec_solve_fn"><code class="code"><span class="constructor">Kinsol</span>.<span class="constructor">Spils</span>.prec_solve_fn</code></a> callback raised <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> but the preconditioner is already current.</li>
<li><code>LinearSolverInitFailure</code> Linear solver initialization failed.</li>
<li><code>LinearSetupFailure</code> Linear solver setup failed unrecoverably.</li>
<li><code>LinearSolveFailure</code> Linear solver solution failed unrecoverably.</li>
<li><code>SystemFunctionFailure</code> The <a href="Kinsol.html#TYPEsysfn"><code class="code"><span class="constructor">Kinsol</span>.sysfn</code></a> callback failed unrecoverably.</li>
<li><code>FirstSystemFunctionFailure</code> The <a href="Kinsol.html#TYPEsysfn"><code class="code"><span class="constructor">Kinsol</span>.sysfn</code></a> callback raised <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> when first called.</li>
<li><code>RepeatedSystemFunctionFailure</code> The <a href="Kinsol.html#TYPEsysfn"><code class="code"><span class="constructor">Kinsol</span>.sysfn</code></a> callback raised <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> repeatedly.</li>
</ul></div>
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSol">KINSol</a></li></ul>
</div>
<h3 id="set">Modifying the solver (optional input functions)</h3>
<pre><span id="VALset_no_init_setup"><span class="keyword">val</span> set_no_init_setup</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies that an initial call to the preconditioner setup function
    should <i>not</i> be made. This feature is useful when solving a sequence of
    problems where the final preconditioner values of one problem become the
    initial values for the next problem.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetNoInitSetup">KINSetNoInitSetup</a></li></ul>
</div>

<pre><span id="VALset_init_setup"><span class="keyword">val</span> set_init_setup</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies that an initial call to the preconditioner setup function
    should be made (the default).</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetNoInitSetup">KINSetNoInitSetup</a></li></ul>
</div>

<pre><span id="VALset_no_res_mon"><span class="keyword">val</span> set_no_res_mon</span> : <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] <a href="Kinsol.html#TYPEserial_session">serial_session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Disables the nonlinear residual monitoring scheme that controls Jacobian
    updating. It only has an effect for the Dense and Band solvers.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetNoResMon">KINSetNoResMon</a></li></ul>
</div>

<pre><span id="VALset_res_mon"><span class="keyword">val</span> set_res_mon</span> : <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] <a href="Kinsol.html#TYPEserial_session">serial_session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Enables the nonlinear residual monitoring scheme that controls Jacobian
    updating. It only has an effect for the Dense and Band solvers.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetNoResMon">KINSetNoResMon</a></li></ul>
</div>

<pre><span id="VALset_max_setup_calls"><span class="keyword">val</span> set_max_setup_calls</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of nonlinear iterations between calls to the
    preconditioner setup function. Pass 0 to set the default (10).</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetMaxSetupCalls">KINSetMaxSetupCalls</a></li></ul>
</div>

<pre><span id="VALset_max_sub_setup_calls"><span class="keyword">val</span> set_max_sub_setup_calls</span> : <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] <a href="Kinsol.html#TYPEserial_session">serial_session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of nonlinear iterations between checks by the
    residual monitoring algorithm. Pass 0 to set the default (5). It only
    affects the Dense and Band solvers.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetMaxSubSetupCalls">KINSetMaxSubSetupCalls</a></li></ul>
</div>

<pre><code><span id="TYPEeta_params"><span class="keyword">type</span> <code class="type"></code>eta_params</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTeta_params.egamma">egamma</span>&nbsp;: <code class="type">float option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>default = 0.9</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTeta_params.ealpha">ealpha</span>&nbsp;: <code class="type">float option</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>default = 2.0</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>The parameters <i>gamma</i> and <i>alpha</i> in the formula for the Eisenstat and
    Walker Choice 2 for <i>eta</i>. Set either to <code class="code"><span class="constructor">None</span></code> to specify its default
    value. The legal values are
    $0 < \mathtt{egamma} \leq 1.0 \wedge 1 < \mathtt{ealpha} \leq 2.0$.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Mathematics_link.html#stopping-criteria-for-iterative-linear-solvers">Stopping criteria for iterative linear solvers</a></li></ul>
</div>


<pre><code><span id="TYPEeta_choice"><span class="keyword">type</span> <code class="type"></code>eta_choice</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTeta_choice.EtaChoice1"><span class="constructor">EtaChoice1</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Eisenstat and Walker Choice 1</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTeta_choice.EtaChoice2"><span class="constructor">EtaChoice2</span></span> <span class="keyword">of</span> <code class="type"><a href="Kinsol.html#TYPEeta_params">eta_params</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Eisenstat and Walker Choice 2</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTeta_choice.EtaConstant"><span class="constructor">EtaConstant</span></span> <span class="keyword">of</span> <code class="type">float option</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Constant (default = 0.1)</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>The <i>eta</i> parameter in the stopping criteria for the linear system solver.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Mathematics_link.html#stopping-criteria-for-iterative-linear-solvers">Stopping criteria for iterative linear solvers</a></li></ul>
</div>


<pre><span id="VALset_eta_choice"><span class="keyword">val</span> set_eta_choice</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> <a href="Kinsol.html#TYPEeta_choice">eta_choice</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the method for computing the value of the <i>eta</i> coefficient used
    in the calculation of the linear solver convergence tolerance.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetEtaForm">KINSetEtaForm</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetEtaConstValue">KINSetEtaConstValue</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetEtaParams">KINSetEtaParams</a></li></ul>
</div>

<pre><span id="VALset_res_mon_const_value"><span class="keyword">val</span> set_res_mon_const_value</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the constant value of <i>omega</i> when using residual monitoring.
    Pass 0.0 to specify the default value (0.9). The legal values are
    $0 < \mathtt{omega} < 1.0 $.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetResMonConstValue">KINSetResMonConstValue</a></li></ul>
</div>

<pre><span id="VALset_res_mon_params"><span class="keyword">val</span> set_res_mon_params</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> ?omegamin:float -> ?omegamax:float -> unit -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the minimum and maximum values in the formula for <i>omega</i>.
    The legal values are
    $0 < \mathtt{omegamin} < \mathtt{omegamax} < 1.0$.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetResMonParams">KINSetResMonParams</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Mathematics_link.html#residual-monitoring-for-modified-newton-method">Residual monitoring for Modified Newton method</a></li></ul>
</div>

<pre><span id="VALset_no_min_eps"><span class="keyword">val</span> set_no_min_eps</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies that the scaled linear residual tolerance (<i>epsilon</i>)
    is not bounded from below.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetNoMinEps">KINSetNoMinEps</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetFuncNormTol">KINSetFuncNormTol</a></li></ul>
</div>

<pre><span id="VALset_min_eps"><span class="keyword">val</span> set_min_eps</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies that the scaled linear residual tolerance (<i>epsilon</i>)
    is bounded from below. That is, the positive minimum value
    $0.01\mathtt{fnormtol}$ is applied to <i>epsilon</i>.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetNoMinEps">KINSetNoMinEps</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetFuncNormTol">KINSetFuncNormTol</a></li></ul>
</div>

<pre><span id="VALset_max_newton_step"><span class="keyword">val</span> set_max_newton_step</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum allowable scaled length of the Newton step. Pass
    0.0 to specify the default value $1000\lVert u_0 \rVert_{D_u}$,
    otherwise the given value must be greater than zero.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetMaxNewtonStep">KINSetMaxNewtonStep</a></li></ul>
</div>

<pre><span id="VALset_max_beta_fails"><span class="keyword">val</span> set_max_beta_fails</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of beta-condition failures in the
    line search algorithm. Pass 0.0 to specify the default (10).</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetMaxBetaFails">KINSetMaxBetaFails</a></li></ul>
</div>

<pre><span id="VALset_rel_err_func"><span class="keyword">val</span> set_rel_err_func</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the relative error in computing $F(u)$, which is used in the
    difference quotient approximation of the Jacobian-vector product. Pass
    0.0 to specify the default value
    ($\sqrt{\mathtt{unit\_roundoff}}$).</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetRelErrFunc">KINSetRelErrFunc</a></li></ul>
</div>

<pre><span id="VALset_func_norm_tol"><span class="keyword">val</span> set_func_norm_tol</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the stopping tolerance on the scaled maximum norm.
    It must be greater than zero. Pass 0.0 to specify the default
    value ($\mathtt{unit\_roundoff}^\frac{1}{3}$).</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetFuncNormTol">KINSetFuncNormTol</a></li></ul>
</div>

<pre><span id="VALset_scaled_step_tol"><span class="keyword">val</span> set_scaled_step_tol</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the stopping tolerance on the minimum scaled step length, which
    must be greater than zero. Pass 0.0 to specify the default
    value ($\mathtt{unit\_roundoff}^\frac{1}{3}$).</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetScaledStepTol">KINSetScaledStepTol</a></li></ul>
</div>

<pre><span id="VALset_constraints"><span class="keyword">val</span> set_constraints</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a vector defining inequality constraints for each
    component of the solution vector <code class="code">u</code>.  See <a href="Sundials.Constraint.html"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">Constraint</span></code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetConstraints">KINSetConstraints</a></li></ul>
</div>

<pre><span id="VALset_sys_func"><span class="keyword">val</span> set_sys_func</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> ('d -> 'd -> unit) -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Changes the system function. Allows solutions of several problems of the
    same size but with different functions.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetSysFunc">KINSetSysFunc</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSysFn">KINSysFn</a></li></ul>
</div>
<h4 id="info">Logging and error handling</h4>
<pre><span id="VALset_error_file"><span class="keyword">val</span> set_error_file</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> <a href="Sundials.Logfile.html#TYPEt">Sundials.Logfile.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Configure the default error handler to write messages to a file.
    By default it writes to Logfile.stderr.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetErrFile">KINSetErrFile</a></li></ul>
</div>

<pre><span id="VALset_err_handler_fn"><span class="keyword">val</span> set_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> (<a href="Sundials.Util.html#TYPEerror_details">Sundials.Util.error_details</a> -> unit) -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a custom function for handling error messages.
    The handler must not fail: any exceptions are trapped and discarded.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetErrHandlerFn">KINSetErrHandlerFn</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINErrHandlerFn">KINErrHandlerFn</a></li></ul>
</div>

<pre><span id="VALclear_err_handler_fn"><span class="keyword">val</span> clear_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Restores the default error handling function.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetErrHandlerFn">KINSetErrHandlerFn</a></li></ul>
</div>

<pre><code><span id="TYPEprint_level"><span class="keyword">type</span> <code class="type"></code>print_level</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTprint_level.NoInformation"><span class="constructor">NoInformation</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>No information displayed. <span class="cconst">(0)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTprint_level.ShowScaledNorms"><span class="constructor">ShowScaledNorms</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>At each nonlinear iteration, display the scaled
                          Euclidean norm of the system function at the
                          current iterate, the scaled norm of the Newton step
                          (if no globalization strategy is used), and the number
                          of function evaluations performed so far.
                          <span class="cconst">(1)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTprint_level.ShowScaledDFNorm"><span class="constructor">ShowScaledDFNorm</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Additionally display $\lVert F(u) \rVert_{DF}$
                          if no globalization strategy is used, and
                          $\lVert F(u)\rVert_{DF,\infty}$, otherwise.
                          <span class="cconst">(2)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTprint_level.ShowGlobalValues"><span class="constructor">ShowGlobalValues</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Additionally display the values used by the global
                          strategy and statistical information for the linear
                          solver. <span class="cconst">(3)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Increasing levels of verbosity for informational messages.</p>
</div>
</div>


<pre><span id="VALset_print_level"><span class="keyword">val</span> set_print_level</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> <a href="Kinsol.html#TYPEprint_level">print_level</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the level of verbosity of informational messages.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetPrintLevel">KINSetPrintLevel</a></li></ul>
</div>

<pre><span id="VALset_info_file"><span class="keyword">val</span> set_info_file</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -><br>       ?print_level:<a href="Kinsol.html#TYPEprint_level">print_level</a> -> <a href="Sundials.Logfile.html#TYPEt">Sundials.Logfile.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Write informational (non-error) messages to the given file.
    By default they are written to Logfile.stdout.
    The optional argument is a convenience for invoking <a href="Kinsol.html#VALset_print_level"><code class="code"><span class="constructor">Kinsol</span>.set_print_level</code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetInfoFile">KINSetInfoFile</a></li></ul>
</div>

<pre><span id="VALset_info_handler_fn"><span class="keyword">val</span> set_info_handler_fn</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> (<a href="Sundials.Util.html#TYPEerror_details">Sundials.Util.error_details</a> -> unit) -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a custom function for handling informational (non-error) messages.
    The <code class="code">error_code</code> field of <a href="Sundials.Util.html#TYPEerror_details">Util.error_details</a>
    is <code class="code">0</code> for such messages.
    The handler must not fail: any exceptions are trapped and discarded.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetInfoHandlerFn">KINSetInfoHandlerFn</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINInfoHandlerFn">KINInfoHandlerFn</a></li></ul>
</div>

<pre><span id="VALclear_info_handler_fn"><span class="keyword">val</span> clear_info_handler_fn</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Restores the default information handling function.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetErrHandlerFn">KINSetErrHandlerFn</a></li></ul>
</div>

<pre><span id="VALset_return_newest"><span class="keyword">val</span> set_return_newest</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> bool -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies whether fixed-point iteration should return the newest
    iteration or the iteration consistent with the last function
    evaluation. The default values is false.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.8.0</li>
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetReturnNewest">KINSetReturnNewest</a></li></ul>
</div>

<pre><span id="VALset_damping"><span class="keyword">val</span> set_damping</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the damping parameter for the fixed point or Picard iteration.</p>

<p>To applying damping, the given <code class="code">beta</code> value must be greater than 0
    and less than 1. Damping is disabled if <code class="code">beta&nbsp;&gt;=&nbsp;1</code>. The default
    value is 1.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.8.0</li>
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetDamping">KINSetDamping</a></li></ul>
</div>

<pre><span id="VALset_damping_aa"><span class="keyword">val</span> set_damping_aa</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set the Anderson acceleration damping parameter.</p>

<p>To applying damping, the given <code class="code">beta</code> value must be greater than 0
    and less than 1. Damping is disabled if <code class="code">beta&nbsp;&gt;=&nbsp;1</code>. The default
    value is 1.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.1.0</li>
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetDampingAA">KINSetDampingAA</a></li></ul>
</div>

<pre><span id="VALset_delay_aa"><span class="keyword">val</span> set_delay_aa</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the number of iterations to delay the start of Anderson acceleration.
    The default value is 0.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.8.0</li>
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINSetDelayAA">KINSetDelayAA</a></li></ul>
</div>
<h3 id="get">Querying the solver (optional output functions)</h3>
<pre><span id="VALget_work_space"><span class="keyword">val</span> get_work_space</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the sizes of the real and integer workspaces.</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">real_size</code>, <code class="code">integer_size</code>)</li>
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINGetWorkSpace">KINGetWorkSpace</a></li></ul>
</div>

<pre><span id="VALget_num_func_evals"><span class="keyword">val</span> get_num_func_evals</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of evaluations of the system function.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINGetNumFuncEvals">KINGetNumFuncEvals</a></li></ul>
</div>

<pre><span id="VALget_num_nonlin_solv_iters"><span class="keyword">val</span> get_num_nonlin_solv_iters</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear iterations.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINGetNumNonlinSolvIters">KINGetNumNonlinSolvIters</a></li></ul>
</div>

<pre><span id="VALget_num_beta_cond_fails"><span class="keyword">val</span> get_num_beta_cond_fails</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of beta-condition failures.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINGetNumBetaCondFails">KINGetNumBetaCondFails</a></li></ul>
</div>

<pre><span id="VALget_num_backtrack_ops"><span class="keyword">val</span> get_num_backtrack_ops</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of backtrack operations (step length adjustments)
    performed by the line search algorithm.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINGetNumBacktrackOps">KINGetNumBacktrackOps</a></li></ul>
</div>

<pre><span id="VALget_func_norm"><span class="keyword">val</span> get_func_norm</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the scaled Euclidiean <i>l2</i> norm of the nonlinear system function
    $F(u)$ evaluated at the current iterate.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINGetFuncNorm">KINGetFuncNorm</a></li></ul>
</div>

<pre><span id="VALget_step_length"><span class="keyword">val</span> get_step_length</span> : <code class="type">('d, 'k) <a href="Kinsol.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the scaled Euclidiean <i>l2</i> norm of the step used during the
    previous iteration.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINGetStepLength">KINGetStepLength</a></li></ul>
</div>
<h3 id="exceptions">Exceptions</h3>
<pre><span id="EXCEPTIONIllInput"><span class="keyword">exception</span> IllInput</span></pre>
<div class="info ">
<div class="info-desc">
<p>An input parameter was invalid.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_ILL_INPUT</a></li></ul>
</div>

<pre><span id="EXCEPTIONLineSearchNonConvergence"><span class="keyword">exception</span> LineSearchNonConvergence</span></pre>
<div class="info ">
<div class="info-desc">
<p>Line search could not find an iterate sufficiently distinct
    from the current one, or an iterate satisfying the sufficient decrease
    condition. The latter could mean that the current iterate is “close” to an
    approximate solution, but that the difference approximation of the
    matrix-vector product is inaccurate, or that <code class="code">scsteptol</code>
    (<a href="Kinsol.html#VALset_scaled_step_tol"><code class="code"><span class="constructor">Kinsol</span>.set_scaled_step_tol</code></a>) is too large.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_LINESEARCH_NONCONV</a></li></ul>
</div>

<pre><span id="EXCEPTIONMaxIterationsReached"><span class="keyword">exception</span> MaxIterationsReached</span></pre>
<div class="info ">
<div class="info-desc">
<p>The maximum number of nonlinear iterations has been reached.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_MAXITER_REACHED</a></li></ul>
</div>

<pre><span id="EXCEPTIONMaxNewtonStepExceeded"><span class="keyword">exception</span> MaxNewtonStepExceeded</span></pre>
<div class="info ">
<div class="info-desc">
<p>Five consecutive steps exceed the maximum newton step.
    That is, the five steps satisfy the inequality
    $\\|D_u p\\|_{L2} > 0.99 \mathtt{mxnewtstep}$,
    where $p$ denotes the current step and <code class="code">mxnewtstep</code> is a scalar
    upper bound on the scaled step length (see <a href="Kinsol.html#VALset_max_newton_step"><code class="code"><span class="constructor">Kinsol</span>.set_max_newton_step</code></a>).
    It could be that $\\| D_F F(u)\\|_{L2}$ is bounded from above by
    a positive value or that <code class="code">mxnewtstep</code> is too small.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_MXNEWT_5X_EXCEEDED</a></li></ul>
</div>

<pre><span id="EXCEPTIONLineSearchBetaConditionFailure"><span class="keyword">exception</span> LineSearchBetaConditionFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The line search algorithm could not satisfy the “beta-condition” for
    <code class="code">mxnbcf&nbsp;+&nbsp;1</code> nonlinear iterations. The failures need not occur in
    consecutive iterations. They may indicate that the algorithm is making
    poor progress.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_LINESEARCH_BCFAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONLinearSolverNoRecovery"><span class="keyword">exception</span> LinearSolverNoRecovery</span></pre>
<div class="info ">
<div class="info-desc">
<p>The <a href="Kinsol.Spils.html#TYPEprec_solve_fn"><code class="code"><span class="constructor">Kinsol</span>.<span class="constructor">Spils</span>.prec_solve_fn</code></a> callback raised <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a>
    but the preconditioner is already current.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_LINSOLV_NO_RECOVERY</a></li></ul>
</div>

<pre><span id="EXCEPTIONLinearSolverInitFailure"><span class="keyword">exception</span> LinearSolverInitFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Linear solver initialization failed.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_LINIT_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONLinearSetupFailure"><span class="keyword">exception</span> LinearSetupFailure</span> <span class="keyword">of</span> <code class="type">exn option</code></pre>
<div class="info ">
<div class="info-desc">
<p>The <a href="Kinsol.Spils.html#TYPEprec_setup_fn"><code class="code"><span class="constructor">Kinsol</span>.<span class="constructor">Spils</span>.prec_setup_fn</code></a> callback failed unrecoverably.
    If possible, the exception in the underlying linear solver is specified.
    It is typically one of
    <a href="Sundials_LinearSolver.html#EXCEPTIONZeroInDiagonal"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">ZeroInDiagonal</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONPSetFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PSetFailure</span></code></a>,
    or
    <a href="Sundials_LinearSolver.html#EXCEPTIONPackageFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PackageFailure</span></code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINGetLastLinFlag">KINGetLastLinFlag</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_LSETUP_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONLinearSolveFailure"><span class="keyword">exception</span> LinearSolveFailure</span> <span class="keyword">of</span> <code class="type">exn option</code></pre>
<div class="info ">
<div class="info-desc">
<p>Either <a href="Kinsol.Spils.html#TYPEprec_solve_fn"><code class="code"><span class="constructor">Kinsol</span>.<span class="constructor">Spils</span>.prec_solve_fn</code></a> failed unrecoverably or the linear solver
    encountered an error condition.
    If possible, the exception in the underlying linear solver is specified.
    It is typically one of
    <a href="Sundials_LinearSolver.html#EXCEPTIONZeroInDiagonal"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">ZeroInDiagonal</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONATimesFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">ATimesFailure</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONPSolveFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PSolveFailure</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONGSFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">GSFailure</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONQRSolFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">QRSolFailure</span></code></a>,
    or
    <a href="Sundials_LinearSolver.html#EXCEPTIONPackageFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PackageFailure</span></code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Usage/index.html#c.KINGetLastLinFlag">KINGetLastLinFlag</a></li><li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_LSOLVE_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONSystemFunctionFailure"><span class="keyword">exception</span> SystemFunctionFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The <a href="Kinsol.html#TYPEsysfn"><code class="code"><span class="constructor">Kinsol</span>.sysfn</code></a> callback failed unrecoverably.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_SYSFUNC_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONFirstSystemFunctionFailure"><span class="keyword">exception</span> FirstSystemFunctionFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The <a href="Kinsol.html#TYPEsysfn"><code class="code"><span class="constructor">Kinsol</span>.sysfn</code></a> callback raised <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> when first called.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_FIRST_SYSFUNC_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONRepeatedSystemFunctionFailure"><span class="keyword">exception</span> RepeatedSystemFunctionFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The <a href="Kinsol.html#TYPEsysfn"><code class="code"><span class="constructor">Kinsol</span>.sysfn</code></a> callback raised <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> repeatedly.
    No recovery is possible.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_REPTD_SYSFUNC_ERR</a></li></ul>
</div>

<pre><span id="EXCEPTIONMissingLinearSolver"><span class="keyword">exception</span> MissingLinearSolver</span></pre>
<div class="info ">
<div class="info-desc">
<p>A linear solver is required but was not specified.</p>
</div>
</div>

<pre><span id="EXCEPTIONVectorOpErr"><span class="keyword">exception</span> VectorOpErr</span></pre>
<div class="info ">
<div class="info-desc">
<p>A fused vector operation failed.</p>
</div>
<ul class="info-attributes">
<li class="sundials kinsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/kinsol/Constants_link.html">KIN_VECTOROP_ERR</a></li></ul>
</div>
</body></html>
