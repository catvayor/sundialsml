<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Sundials_Matrix.html">
<link rel="next" href="Sundials_NonlinearSolver.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Sundials_parallel" rel="Chapter" href="Sundials_parallel.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Linear Solver Families" rel="Section" href="#lsolvers">
<link title="Operations" rel="Section" href="#ops">
<link title="Exceptions" rel="Section" href="#exceptions">
<link title="Callback Routines" rel="Subsection" href="#callbacks">
<title>Sundials/ML 6.1.0p0 : Sundials_LinearSolver</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Sundials_Matrix.html" title="Sundials_Matrix">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Sundials_NonlinearSolver.html" title="Sundials_NonlinearSolver">Next</a>
</div>
<h1>Module <a href="type_Sundials_LinearSolver.html">Sundials_LinearSolver</a></h1>

<pre><span id="MODULESundials_LinearSolver"><span class="keyword">module</span> Sundials_LinearSolver</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Sundials_LinearSolver.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>Generic linear solvers.</p>

<p>Sundials provides a set of functions for instantiating linear solvers from
    two families: <a href="Sundials_LinearSolver.Direct.html"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">Direct</span></code></a> and <a href="Sundials_LinearSolver.Iterative.html"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">Iterative</span></code></a>. Any instance may
    be associated with at most one solver session.</p>
</div>
<ul class="info-attributes">
<div class="authors"><b>Author(s):</b> Timothy Bourke (Inria/ENS), Jun Inoue (Inria/ENS), Marc Pouzet (UPMC/ENS/Inria)</div>
<li><b>Version:</b> 6.1.0</li>
<li><b>Since</b> 3.0.0</li>
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#the-sunlinearsolver-api">The SUNLinearSolver API</a></li><li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/index.html#linear-algebraic-solvers">Linear Algebraic Solvers</a></li></ul>
</div>
<hr width="100%">

<pre><span id="TYPEt"><span class="keyword">type</span> <code class="type">('matrix, 'data, 'kind, 'tag)</code> t</span> = <code class="type">('matrix, 'data, 'kind, 'tag) linear_solver</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A linear solver.
    The type variables specify the Jacobian matrix (<code class="code"><span class="keywordsign">'</span>matrix</code>), the
    <a href="Nvector.html#TYPEnvector"><code class="code"><span class="constructor">Nvector</span>.nvector</code></a> data (<code class="code"><span class="keywordsign">'</span>data</code>) and kind (<code class="code"><span class="keywordsign">'</span>kind</code>), and a
    <code class="code"><span class="keywordsign">'</span>tag</code> used to identify specific solver features (like the iterative
    method).</p>

<p>A linear solver of this type must be converted to session-specific
    form by <a href="Cvode.Dls.html#VALsolver"><code class="code"><span class="constructor">Cvode</span>.<span class="constructor">Dls</span>.solver</code></a>, <a href="Ida.Dls.html#VALsolver"><code class="code"><span class="constructor">Ida</span>.<span class="constructor">Dls</span>.solver</code></a>, <a href="Cvode.Spils.html#VALsolver"><code class="code"><span class="constructor">Cvode</span>.<span class="constructor">Spils</span>.solver</code></a>,
    <a href="Ida.Spils.html#VALsolver"><code class="code"><span class="constructor">Ida</span>.<span class="constructor">Spils</span>.solver</code></a>, etc., before being
    attached to a session via <code class="code">init</code> or <code class="code">reinit</code>.</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinearSolver">SUNLinearSolver</a></li></ul>
</div>


<pre><span id="TYPEserial_t"><span class="keyword">type</span> <code class="type">('mat, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ], 'tag)</code> serial_t</span> = <code class="type">('mat, <a href="Nvector_serial.html#TYPEdata">Nvector_serial.data</a>, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'kind, 'tag)<br>       <a href="Sundials_LinearSolver.html#TYPEt">t</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>Alias for linear solvers that are restricted to serial nvectors.</p>
</div>
</div>


<pre><code><span id="TYPElinear_solver_type"><span class="keyword">type</span> <code class="type"></code>linear_solver_type</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_type.Direct"><span class="constructor">Direct</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Performs an exact computation based on a matrix.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_type.Iterative"><span class="constructor">Iterative</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Computes an inexact approximation without a matrix.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_type.MatrixIterative"><span class="constructor">MatrixIterative</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Computes an inexact approximation using a matrix.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_type.MatrixEmbedded"><span class="constructor">MatrixEmbedded</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Computes without an explicit input matrix</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Broadly classifies the operations provided by a linear solver and its
    operating principle.</p>
</div>
</div>


<pre><code><span id="TYPElinear_solver_id"><span class="keyword">type</span> <code class="type"></code>linear_solver_id</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.Band"><span class="constructor">Band</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.Dense"><span class="constructor">Dense</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.Klu"><span class="constructor">Klu</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.LapackBand"><span class="constructor">LapackBand</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.LapackDense"><span class="constructor">LapackDense</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.Pcg"><span class="constructor">Pcg</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.Spbcgs"><span class="constructor">Spbcgs</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.Spfgmr"><span class="constructor">Spfgmr</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.Spgmr"><span class="constructor">Spgmr</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.Sptfqmr"><span class="constructor">Sptfqmr</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.Superludist"><span class="constructor">Superludist</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.Superlumt"><span class="constructor">Superlumt</span></span></code></td>

</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_id.Custom"><span class="constructor">Custom</span></span></code></td>

</tr></table>

<div class="info ">
<div class="info-desc">
<p>The identifier of a linear solver.</p>
</div>
</div>

<h4 id="callbacks">Callback Routines</h4>
<pre><span id="TYPEatimesfn"><span class="keyword">type</span> <code class="type">'data</code> atimesfn</span> = <code class="type">'data -> 'data -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A function <code class="code">atimesfn&nbsp;v&nbsp;z</code> computes the action of the system
    matrix on the vector <code class="code">v</code>, storing the result in <code class="code">z</code>. The matrix is
    represented implicitly by the effect of the function.</p>

<p>If a problem occurs the function raises <a href="Sundials_LinearSolver.html#EXCEPTIONATimesFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">ATimesFailure</span></code></a>.</p>
</div>
</div>


<pre><span id="TYPEpsetupfn"><span class="keyword">type</span> <code class="type"></code>psetupfn</span> = <code class="type">unit -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Functions that set up any problem data in preparation for calls to
    <code class="code">psolvefn</code>.</p>

<p>If a problem occurs the function raises <a href="Sundials_LinearSolver.html#EXCEPTIONPSetFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PSetFailure</span></code></a>.</p>
</div>
</div>


<pre><span id="TYPEpsolvefn"><span class="keyword">type</span> <code class="type">'data</code> psolvefn</span> = <code class="type">'data -> 'data -> float -> bool -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A function <code class="code">psolvefn&nbsp;r&nbsp;z&nbsp;tol&nbsp;lr</code> that solves the preconditioner
    equation $Pz = r$  for the vector <code class="code">z</code> such that
    $\left\lVert Pz - r \right\rVert_\mathrm{wrms} < \mathit{tol}$ .
    If <code class="code">lr</code> is <code class="code"><span class="keyword">true</span></code> then $P$  should be treated as a left
    preconditioner and otherwise as a right preconditioner.</p>

<p>If a problem occurs the function raises <a href="Sundials_LinearSolver.html#EXCEPTIONPSolveFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PSolveFailure</span></code></a>.</p>
</div>
</div>

<h3 id="lsolvers">Linear Solver Families</h3>
<pre><span id="MODULEDirect"><span class="keyword">module</span> <a href="Sundials_LinearSolver.Direct.html">Direct</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Sundials_LinearSolver.Direct.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Direct Linear Solvers</p>

</div>

<pre><span id="MODULEIterative"><span class="keyword">module</span> <a href="Sundials_LinearSolver.Iterative.html">Iterative</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Sundials_LinearSolver.Iterative.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Iterative Linear Solvers</p>

</div>

<pre><span id="MODULECustom"><span class="keyword">module</span> <a href="Sundials_LinearSolver.Custom.html">Custom</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Sundials_LinearSolver.Custom.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Custom linear solvers.</p>

</div>
<h3 id="ops">Operations</h3>
<pre><span id="VALset_atimes"><span class="keyword">val</span> set_atimes</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -><br>       'd <a href="Sundials_LinearSolver.html#TYPEatimesfn">atimesfn</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set the linear solver's problem-specific <a href="Sundials_LinearSolver.html#TYPEatimesfn"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.atimesfn</code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolSetATimes">SUNLinSolSetATimes</a></li></ul>
</div>

<pre><span id="VALset_preconditioner"><span class="keyword">val</span> set_preconditioner</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -><br>       <a href="Sundials_LinearSolver.html#TYPEpsetupfn">psetupfn</a> -> 'd <a href="Sundials_LinearSolver.html#TYPEpsolvefn">psolvefn</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set the linear solver's preconditioner routines.</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolSetPreconditioner">SUNLinSolSetPreconditioner</a></li></ul>
</div>

<pre><span id="VALset_scaling_vectors"><span class="keyword">val</span> set_scaling_vectors</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -><br>       ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the linear solver's left/right scaling vectors for use in <a href="Sundials_LinearSolver.html#VALsolve"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.solve</code></a>.
    The call <code class="code">set_scaling_vectors&nbsp;ls&nbsp;s1&nbsp;s2</code> provides diagonal matrices
    of scale factors for solving the system
    $\tilde{A}\tilde{x} = \tilde{b}$ 
    where
    $\tilde{A} = S_1 P_1^{-1} A P_2^{-1} S_2^{-1}$ ,
    $\tilde{b} = S_1 P_1^{-1} b$ , and
    $\tilde{x} = S_2 P_2 x$ .</p>

<p>Note that the underlying data structures may be used directly by the
    linear solver, i.e., without a copy.</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolSetScalingVectors">SUNLinSolSetScalingVectors</a></li></ul>
</div>

<pre><span id="VALset_zero_guess"><span class="keyword">val</span> set_zero_guess</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -> bool -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Indicates that the next call to <a href="Sundials_LinearSolver.html#VALsolve"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.solve</code></a> will be made with a zero initial
    guess.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.8.0</li>
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolSetZeroGuess">SUNLinSolSetZeroGuess</a></li></ul>
</div>

<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Initializes a linear solver.</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolInitialize">SUNLinSolInitialize</a></li></ul>
</div>

<pre><span id="VALsetup"><span class="keyword">val</span> setup</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -><br>       ('a, 'm, 'd, 'k) Sundials.Matrix.t -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Instruct the linear solver to prepare to solve using an updated
    system matrix.</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolSetup">SUNLinSolSetup</a></li></ul>
</div>

<pre><span id="VALsolve"><span class="keyword">val</span> solve</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -><br>       ('a, 'm, 'd, 'k) Sundials.Matrix.t -><br>       ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Solve a linear system.
    The call <code class="code">solve&nbsp;ls&nbsp;a&nbsp;x&nbsp;b&nbsp;tol</code> solves the linear system
    $Ax = b$ .</p>

<p>Direct solvers ignore <code class="code">tol</code>.
    Matrix-free solvers ignore <code class="code">a</code>, relying instead on the function passed to
    <a href="Sundials_LinearSolver.html#VALset_atimes"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.set_atimes</code></a>.
    Iterative solvesr attempt to respect the weighted 2-norm tolerance,
    <code class="code">tol</code>.</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolSolve">SUNLinSolSolve</a></li></ul>
</div>

<pre><span id="VALget_num_iters"><span class="keyword">val</span> get_num_iters</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>The number of linear iterations performed in the last <a href="Sundials_LinearSolver.html#VALsolve"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.solve</code></a> call.</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolNumIters">SUNLinSolNumIters</a></li></ul>
</div>

<pre><span id="VALget_res_norm"><span class="keyword">val</span> get_res_norm</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>The final residual norm from the last <a href="Sundials_LinearSolver.html#VALsolve"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.solve</code></a> call.</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolResNorm">SUNLinSolResNorm</a></li></ul>
</div>

<pre><span id="VALget_res_id"><span class="keyword">val</span> get_res_id</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -> 'd</code></pre><div class="info ">
<div class="info-desc">
<p>The preconditioned initial residual vector.
    May be called when an iterative method computes the preconditioned initial
    residual and <a href="Sundials_LinearSolver.html#VALsolve"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.solve</code></a> succeeds without performing any iterations, i.e., if
    the intial guess or the preconditioner is sufficiently accurate.</p>

<p>The linear solver may return a reference to its internal array, i.e., it
    may not return a copy.</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolResNorm">SUNLinSolResNorm</a></li></ul>
</div>

<pre><span id="VALget_type"><span class="keyword">val</span> get_type</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -><br>       <a href="Sundials_LinearSolver.html#TYPElinear_solver_type">linear_solver_type</a></code></pre><div class="info ">
<div class="info-desc">
<p>Returns the type of the linear solver.</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolGetType">SUNLinSolGetType</a></li></ul>
</div>

<pre><span id="VALget_id"><span class="keyword">val</span> get_id</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -><br>       <a href="Sundials_LinearSolver.html#TYPElinear_solver_id">linear_solver_id</a></code></pre><div class="info ">
<div class="info-desc">
<p>Returns the identifier of the linear solver.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolGetID">SUNLinSolGetID</a></li></ul>
</div>

<pre><span id="VALget_last_flag"><span class="keyword">val</span> get_last_flag</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns an indication of the last error encountered by a linear solver.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolGetLastFlag">SUNLinSolGetLastFlag</a></li></ul>
</div>

<pre><span id="VALget_work_space"><span class="keyword">val</span> get_work_space</span> : <code class="type">('m, 'd, 'k, 't) <a href="Sundials_LinearSolver.html#TYPEt">t</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>The storage requirements of the linear solver.
    The result <code class="code">(lrw,&nbsp;liw)</code> gives the number of words used for
    storing real values (<code class="code">lrw</code>) and the number of words used
    for storing integer values (<code class="code">liw</code>).</p>
</div>
<ul class="info-attributes">
<li class="sundials linsol">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/sunlinsol/SUNLinSol_API_link.html#c.SUNLinSolSpace">SUNLinSolSpace</a></li></ul>
</div>
<h3 id="exceptions">Exceptions</h3>
<pre><span id="EXCEPTIONInvalidLinearSolver"><span class="keyword">exception</span> InvalidLinearSolver</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised on invalid use of linear solver functions. For instance,
    initializing a session with <a href="Cvode.Diag.html"><code class="code"><span class="constructor">Cvode</span>.<span class="constructor">Diag</span></code></a> and then calling
    <a href="Cvode.Spils.html#VALget_num_lin_iters"><code class="code"><span class="constructor">Cvode</span>.<span class="constructor">Spils</span>.get_num_lin_iters</code></a>, which rather requires a
    linear solver from <a href="Sundials_LinearSolver.Iterative.html"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">Iterative</span></code></a>.</p>
</div>
</div>

<pre><span id="EXCEPTIONUnrecoverableFailure"><span class="keyword">exception</span> UnrecoverableFailure</span> <span class="keyword">of</span> <code class="type">bool</code></pre>
<div class="info ">
<div class="info-desc">
<p>Raised on an unrecoverable failure in a linear solver. The argument is
    <code class="code"><span class="keyword">true</span></code> for a recoverable failure and <code class="code"><span class="keyword">false</span></code> for an unrecoverable one.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_PACKAGE_FAIL_REC         </li><li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_PACKAGE_FAIL_UNREC         </li></ul>
</div>

<pre><span id="EXCEPTIONMatrixNotSquare"><span class="keyword">exception</span> MatrixNotSquare</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised when creating a linear solver if the given matrix is not square.</p>
</div>
</div>

<pre><span id="EXCEPTIONMatrixVectorMismatch"><span class="keyword">exception</span> MatrixVectorMismatch</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised when creating a linear solver if the number of matrix rows and the
    vector length are not equal.</p>
</div>
</div>

<pre><span id="EXCEPTIONInsufficientStorageUpperBandwidth"><span class="keyword">exception</span> InsufficientStorageUpperBandwidth</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised when the storage upper bandwidth (<code class="code">smu</code>) of a
    <a href="Sundials_Matrix.Band.html#TYPEt">Matrix.Band.t</a> is
    insufficient for use in a particular linear solver.</p>
</div>
</div>

<pre><span id="EXCEPTIONLinearSolverInUse"><span class="keyword">exception</span> LinearSolverInUse</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised on an attempt to associate a linear solver instance with more than
    one session.</p>
</div>
</div>

<pre><span id="EXCEPTIONATimesFailure"><span class="keyword">exception</span> ATimesFailure</span> <span class="keyword">of</span> <code class="type">bool</code></pre>
<div class="info ">
<div class="info-desc">
<p>Indicates failure of an atimes function. The argument is <code class="code"><span class="keyword">true</span></code> for a
    recoverable failure and <code class="code"><span class="keyword">false</span></code> for an unrecoverable one.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_ATIMES_FAIL_REC         </li><li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_ATIMES_FAIL_UNREC         </li></ul>
</div>

<pre><span id="EXCEPTIONPSetFailure"><span class="keyword">exception</span> PSetFailure</span> <span class="keyword">of</span> <code class="type">bool</code></pre>
<div class="info ">
<div class="info-desc">
<p>Indicates failure of a preconditioner setup routine. The argument is
    <code class="code"><span class="keyword">true</span></code> for a recoverable failure and <code class="code"><span class="keyword">false</span></code> for an unrecoverable one.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_PSET_FAIL_REC         </li><li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_PSET_FAIL_UNREC         </li></ul>
</div>

<pre><span id="EXCEPTIONPSolveFailure"><span class="keyword">exception</span> PSolveFailure</span> <span class="keyword">of</span> <code class="type">bool</code></pre>
<div class="info ">
<div class="info-desc">
<p>Indicates failure of a preconditioner solver. The argument is <code class="code"><span class="keyword">true</span></code> for a
    recoverable failure and <code class="code"><span class="keyword">false</span></code> for an unrecoverable one.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_PSOLVE_FAIL_REC         </li><li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_PSOLVE_FAIL_UNREC         </li></ul>
</div>

<pre><span id="EXCEPTIONGSFailure"><span class="keyword">exception</span> GSFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Indicates failure of a Gram-Schmidt routine.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_GS_FAIL         </li></ul>
</div>

<pre><span id="EXCEPTIONQRSolFailure"><span class="keyword">exception</span> QRSolFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Indicates that the QR solution found a singular result.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_QRSOL_FAIL         </li></ul>
</div>

<pre><span id="EXCEPTIONVectorOpError"><span class="keyword">exception</span> VectorOpError</span></pre>
<div class="info ">
<div class="info-desc">
<p>An error occurred in a vector operation.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_VECTOROP_ERR         </li></ul>
</div>

<pre><span id="EXCEPTIONResReduced"><span class="keyword">exception</span> ResReduced</span></pre>
<div class="info ">
<div class="info-desc">
<p>Indicates that the residual is reduced but without convergence to the
    desired tolerance.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_RES_REDUCED         </li></ul>
</div>

<pre><span id="EXCEPTIONConvFailure"><span class="keyword">exception</span> ConvFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Indicates that a solver failed to converge.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_CONV_FAIL         </li></ul>
</div>

<pre><span id="EXCEPTIONQRfactFailure"><span class="keyword">exception</span> QRfactFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Indicates that QR factorization encountered a singular matrix.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_QRFACT_FAIL         </li></ul>
</div>

<pre><span id="EXCEPTIONLUfactFailure"><span class="keyword">exception</span> LUfactFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Indicates that LU factorization encountered a singular matrix.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_LUFACT_FAIL         </li></ul>
</div>

<pre><span id="EXCEPTIONPackageFailure"><span class="keyword">exception</span> PackageFailure</span> <span class="keyword">of</span> <code class="type">bool</code></pre>
<div class="info ">
<div class="info-desc">
<p>Indicates failure in an external linear solver package. The argument
    is <code class="code"><span class="keyword">true</span></code> for a recoverable failure and <code class="code"><span class="keyword">false</span></code> for an unrecoverable one.</p>
</div>
<ul class="info-attributes">
<li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_PACKAGE_FAIL_REC         </li><li class="sundials nodoc">          <span class="seesundials">See Sundials: </span>SUNLS_PACKAGE_FAIL_UNREC         </li></ul>
</div>

<pre><span id="EXCEPTIONIllegalPrecType"><span class="keyword">exception</span> IllegalPrecType</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised by <a href="Sundials_LinearSolver.Iterative.html#VALset_prec_type"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">Iterative</span>.set_prec_type</code></a> if the given type is not allowed.</p>
</div>
</div>

<pre><span id="EXCEPTIONInternalFailure"><span class="keyword">exception</span> InternalFailure</span> <span class="keyword">of</span> <code class="type">(string * int)</code></pre>
<div class="info ">
<div class="info-desc">
<p>Indicates that an internal callback, identified by the first argument,
    returned the given unknown error code.</p>
</div>
</div>

<pre><span id="EXCEPTIONZeroInDiagonal"><span class="keyword">exception</span> ZeroInDiagonal</span> <span class="keyword">of</span> <code class="type">int</code></pre>
<div class="info ">
<div class="info-desc">
<p>Setup failed due to a zero diagonal element during LU factorization.
    The argument indicates the column index numbered from one.</p>
</div>
</div>
</body></html>
