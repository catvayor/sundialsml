<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Nvector_array.html">
<link rel="next" href="Kinsol.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Sundials_parallel" rel="Chapter" href="Sundials_parallel.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Linear solvers" rel="Section" href="#linear">
<link title="Tolerances" rel="Section" href="#tols">
<link title="Solver initialization and use" rel="Section" href="#solver">
<link title="Modifying the solver (optional input functions)" rel="Section" href="#set">
<link title="Querying the solver (optional output functions)" rel="Section" href="#get">
<link title="Additional root-finding functions" rel="Section" href="#roots">
<link title="Exceptions" rel="Section" href="#exceptions">
<title>Sundials/ML 6.1.0p0 : Cvode</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Nvector_array.html" title="Nvector_array">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="Kinsol.html" title="Kinsol">Next</a>
</div>
<h1>Module <a href="type_Cvode.html">Cvode</a></h1>

<pre><span id="MODULECvode"><span class="keyword">module</span> Cvode</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvode.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>Variable-step solution of ODE initial value problems with
    zero-crossing detection.</p>

<p>This module solves numerically problems of the form
    $\dot{y} = f(t, y)$, $y(t_0) = y_0$.</p>

<p>This documented interface is structured as follows.</p>
<OL>
<li><a href="#linear">Linear solvers</a></li>
<li><a href="#tols">Tolerances</a></li>
<li><a href="#solver">Solver initialization and use</a></li>
<li><a href="#set">Modifying the solver</a></li>
<li><a href="#get">Querying the solver</a></li>
<li><a href="#roots">Additional root finding functions</a></li>
<li><a href="#exceptions">Exceptions</a></li>
</OL>
</div>
<ul class="info-attributes">
<div class="authors"><b>Author(s):</b> Timothy Bourke (Inria/ENS), Jun Inoue (Inria/ENS), Marc Pouzet (UPMC/ENS/Inria)</div>
<li><b>Version:</b> 6.1.0</li>
</ul>
</div>
<hr width="100%">

<pre><span id="TYPEsession"><span class="keyword">type</span> <code class="type">('d, 'k)</code> session</span> = <code class="type">('d, 'k) session</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A session with the CVODE solver.</p>

<p>An example session with Cvode (<a href="cvode_skel.ml">cvode_skel.ml</a>):</p>
<pre class="codepre"><code class="code"><span class="keyword">open</span> <span class="constructor">Sundials</span>

<span class="comment">(* 1. Define a right-hand-side function. *)</span>
<span class="keyword">let</span> f _t y yd = yd.{0} &lt;- y.{1}; yd.{1} &lt;- -9.81

<span class="comment">(* 2. Optionally define a root function. *)</span>
<span class="keyword">let</span> g _t y gout = gout.{0} &lt;- 1.0 -. y.{0}

<span class="comment">(* 3. Set vector of initial values.
      The length of this vector determines the problem size. *)</span>
<span class="keyword">let</span> yd = <span class="constructor">RealArray</span>.of_list [ 10.0; 0.0 ]
<span class="keyword">let</span> y = <span class="constructor">Nvector_serial</span>.wrap yd

<span class="comment">(* 4. Create and initialize a solver session.
      This will initialize a specific linear solver and the root-finding
      mechanism, if necessary. *)</span>
<span class="keyword">let</span> s = <span class="constructor">Cvode</span>.(init <span class="constructor">Adams</span>
                    (<span class="constructor">SStolerances</span> (1e-4, 1e-8))
                    f ~roots:(1, g) 0.0 y);;

<span class="comment">(* 5. Set optional inputs, e.g.,
      call [set_*] functions to change solver parameters. *)</span>
<span class="constructor">Cvode</span>.set_stop_time s 10.0;;
<span class="constructor">Cvode</span>.set_all_root_directions s <span class="constructor">RootDirs</span>.<span class="constructor">Increasing</span>;;

<span class="comment">(* 6. Advance the solution in time,
      by repeatedly calling [solve_normal] or [solve_one_step]. *)</span>
<span class="keyword">let</span> <span class="keyword">rec</span> go (t, r) =
  <span class="constructor">Printf</span>.printf <span class="string">"% .10e\t% .10e\t% .10e\n"</span> t yd.{0} yd.{1};
  <span class="keyword">match</span> r <span class="keyword">with</span>
  <span class="keywordsign">|</span> <span class="constructor">Cvode</span>.<span class="constructor">Success</span> <span class="keywordsign">-&gt;</span> go (<span class="constructor">Cvode</span>.solve_normal s (t +. 0.5) y)
  <span class="keywordsign">|</span> <span class="constructor">Cvode</span>.<span class="constructor">RootsFound</span> <span class="keywordsign">-&gt;</span> <span class="keyword">begin</span>
        yd.{1} &lt;- -0.8 *. yd.{1};
        <span class="constructor">Cvode</span>.reinit s t y;
        go (t, <span class="constructor">Cvode</span>.<span class="constructor">Success</span>)
      <span class="keyword">end</span>
  <span class="keywordsign">|</span> <span class="constructor">Cvode</span>.<span class="constructor">StopTimeReached</span> <span class="keywordsign">-&gt;</span> ();;

<span class="constructor">Printf</span>.printf <span class="string">"time\ty\ty'\n"</span>;;
go (0.0, <span class="constructor">Cvode</span>.<span class="constructor">Success</span>);;

<span class="comment">(* 7. Get optional outputs,
      call the [get_*] functions to examine solver statistics. *)</span>
<span class="keyword">let</span> ns = <span class="constructor">Cvode</span>.get_num_steps s
    </code></pre></div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#a-skeleton-of-the-users-main-program">Skeleton of main program</a></li></ul>
</div>


<pre><span id="TYPEserial_session"><span class="keyword">type</span> <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_session</span> = <code class="type">(<a href="Nvector_serial.html#TYPEdata">Nvector_serial.data</a>, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a) <a href="Cvode.html#TYPEsession">session</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>Alias for sessions based on serial nvectors.</p>
</div>
</div>

<h3 id="linear">Linear solvers</h3>
<pre><span id="TYPElinear_solver"><span class="keyword">type</span> <code class="type">('data, 'kind)</code> linear_solver</span> = <code class="type">('data, 'kind) linear_solver</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Linear solvers used by Cvode.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#linear-solver-interface-functions">Linear Solver Interface Functions</a></li></ul>
</div>


<pre><span id="TYPEserial_linear_solver"><span class="keyword">type</span> <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_linear_solver</span> = <code class="type">(<a href="Nvector_serial.html#TYPEdata">Nvector_serial.data</a>, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a) <a href="Cvode.html#TYPElinear_solver">linear_solver</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>Alias for linear solvers that are restricted to serial nvectors.</p>
</div>
</div>


<pre><span id="TYPEdouble"><span class="keyword">type</span> <code class="type">'d</code> double</span> = <code class="type">'d * 'd</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Workspaces with two temporary vectors.</p>
</div>
</div>


<pre><span id="TYPEtriple"><span class="keyword">type</span> <code class="type">'d</code> triple</span> = <code class="type">'d * 'd * 'd</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Workspaces with three temporary vectors.</p>
</div>
</div>


<pre><span id="TYPEjacobian_arg"><span class="keyword">type</span> <code class="type">('t, 'd)</code> jacobian_arg</span> = <code class="type">('t, 'd) jacobian_arg</code> = {</pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_t">jac_t</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The independent variable.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_y">jac_y</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The dependent variable vector.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_fy">jac_fy</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The derivative vector
                            (i.e., $\frac{\mathrm{d}y}{\mathrm{d}t}$).</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTjacobian_arg.jac_tmp">jac_tmp</span>&nbsp;: <code class="type">'t</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Workspace data.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Arguments common to Jacobian callback functions.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVLsJacFn">CVLsJacFn</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVLsJacTimesVecFn">CVLsJacTimesVecFn</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVLsPrecSolveFn">CVLsPrecSolveFn</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVLsPrecSetupFn">CVLsPrecSetupFn</a></li></ul>
</div>


<pre><span id="TYPErhsfn"><span class="keyword">type</span> <code class="type">'d</code> rhsfn</span> = <code class="type">float -> 'd -> 'd -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Right-hand side functions for calculating ODE derivatives. They are passed
    three arguments:</p>
<ul>
<li><code class="code">t</code>, the value of the independent variable, i.e., the simulation time,</li>
<li><code class="code">y</code>, the vector of dependent-variable values, i.e., $y(t)$, and,</li>
<li><code class="code">y'</code>, a vector for storing the value of $f(t, y)$.</li>
</ul>
<p>Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
    indicates a recoverable error. Any other exception is treated as an
    unrecoverable error.</p>

<p><div class="warningbox"> <code class="code">y</code> and <code class="code">y'</code> should not be accessed after the function
             returns.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVRhsFn">CVRhsFn</a></li></ul>
</div>


<pre><span id="MODULEDiag"><span class="keyword">module</span> <a href="Cvode.Diag.html">Diag</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvode.Diag.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Diagonal approximation of Jacobians by difference quotients.</p>

</div>

<pre><span id="MODULEDls"><span class="keyword">module</span> <a href="Cvode.Dls.html">Dls</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvode.Dls.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Direct Linear Solvers operating on dense, banded, and sparse matrices.</p>

</div>

<pre><span id="MODULESpils"><span class="keyword">module</span> <a href="Cvode.Spils.html">Spils</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvode.Spils.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Scaled Preconditioned Iterative Linear Solvers.</p>

</div>

<pre><span id="VALmatrix_embedded_solver"><span class="keyword">val</span> matrix_embedded_solver</span> : <code class="type">(unit, 'data, 'kind, [> `MatE ]) Sundials.LinearSolver.t -><br>       ('data, 'kind) <a href="Cvode.html#TYPElinear_solver">linear_solver</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create a CVode-specific linear solver from a generic matrix embedded
    solver.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.8.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetLinearSolver">CVodeSetLinearSolver</a></li></ul>
</div>
<h3 id="tols">Tolerances</h3>
<pre><span id="TYPEerror_weight_fun"><span class="keyword">type</span> <code class="type">'data</code> error_weight_fun</span> = <code class="type">'data -> 'data -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Functions that set the multiplicative error weights for use in the weighted
    RMS norm. The call <code class="code">efun&nbsp;y&nbsp;ewt</code> takes the dependent variable vector <code class="code">y</code> and
    fills the error-weight vector <code class="code">ewt</code> with positive values or raises
    <a href="Sundials.html#EXCEPTIONNonPositiveEwt"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">NonPositiveEwt</span></code></a>. Other exceptions are eventually propagated, but
    should be avoided (<code class="code">efun</code> is not allowed to abort the solver).</p>
</div>
</div>


<pre><code><span id="TYPEtolerance"><span class="keyword">type</span> <code class="type">('data, 'kind)</code> tolerance</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SStolerances"><span class="constructor">SStolerances</span></span> <span class="keyword">of</span> <code class="type">float * float</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><code class="code">(rel,&nbsp;abs)</code> : scalar relative and absolute tolerances.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SVtolerances"><span class="constructor">SVtolerances</span></span> <span class="keyword">of</span> <code class="type">float * ('data, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><code class="code">(rel,&nbsp;abs)</code> : scalar relative and vector absolute tolerances.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.WFtolerances"><span class="constructor">WFtolerances</span></span> <span class="keyword">of</span> <code class="type">'data <a href="Cvode.html#TYPEerror_weight_fun">error_weight_fun</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Set the multiplicative error weights for the weighted RMS norm.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Tolerance specifications.</p>
</div>
</div>


<pre><span id="VALdefault_tolerances"><span class="keyword">val</span> default_tolerances</span> : <code class="type">('data, 'kind) <a href="Cvode.html#TYPEtolerance">tolerance</a></code></pre><div class="info ">
<div class="info-desc">
<p>A default relative tolerance of 1.0e-4 and absolute tolerance of 1.0e-8.</p>
</div>
</div>
<h3 id="solver">Solver initialization and use</h3>
<pre><code><span id="TYPElmm"><span class="keyword">type</span> <code class="type"></code>lmm</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlmm.Adams"><span class="constructor">Adams</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Adams-Moulton formulas (non-stiff systems).</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlmm.BDF"><span class="constructor">BDF</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Backward Differentiation Formulas (stiff systems).</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Choice of linear multistep method.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeCreate">CVodeCreate</a></li></ul>
</div>


<pre><span id="TYPErootsfn"><span class="keyword">type</span> <code class="type">'d</code> rootsfn</span> = <code class="type">float -> 'd -> Sundials.RealArray.t -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Called by the solver to calculate the values of root functions. These
    ‘zero-crossings’ are used to detect significant events. The function is
    passed three arguments:</p>
<ul>
<li><code class="code">t</code>, the value of the independent variable, i.e., the simulation time,</li>
<li><code class="code">y</code>, the vector of dependent-variable values, i.e., $y(t)$, and,</li>
<li><code class="code">gout</code>, a vector for storing the value of $g(t, y)$.</li>
</ul>
<p><div class="warningbox"> <code class="code">y</code> and <code class="code">gout</code> should not be accessed after the function has
             returned.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.cvRootFn">cvRootFn</a></li></ul>
</div>


<pre><span id="TYPEproj_fn"><span class="keyword">type</span> <code class="type">'d</code> proj_fn</span> = <code class="type">float -> 'd -> 'd -> float -> 'd option -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A function to compute the projection of the solution and, if enabled, the
    error on the constraint manifold.</p>

<p>Such functions take the following arguments:</p>
<ul>
<li><code class="code">t</code>, the independent variable,</li>
<li><code class="code">ycur</code>, the dependent variable vector,</li>
<li><code class="code">corr</code>, the correction to the dependent variable vector so that
              $y(t) + c$  satisifies the constraint equation,</li>
<li><code class="code">eps</code>, the tolerance to use in the nonlinear stopping test when
             solving the nonlinear contrained least-squares problem, and</li>
<li><code class="code">err</code>, if error project is enabled (the default), the current error
             estimate on input and updated to the projected error for output.</li>
</ul>
<p>(The <code class="code">err</code> argument is <code class="code"><span class="constructor">None</span></code> if error projection is not enabled.)</p>

<p>Raising <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> indicates a recoverable error.
    Any other exception is treated as an unrecoverable error. The integrator
    will, in most cases, try to correct and reattempt the step.</p>

<p>The solve should stop when the WRMS norm of the current iterate update is
    less than <code class="code">eps</code>. The projection routine can access the error weight vector
    with <a href="Cvode.html#VALget_err_weights"><code class="code"><span class="constructor">Cvode</span>.get_err_weights</code></a>.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVProjFn">CVProjFn</a></li></ul>
</div>


<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">?context:<a href="Sundials.Context.html#TYPEt">Sundials.Context.t</a> -><br>       <a href="Cvode.html#TYPElmm">lmm</a> -><br>       ('data, 'kind) <a href="Cvode.html#TYPEtolerance">tolerance</a> -><br>       ?nlsolver:('data, 'kind, ('data, 'kind) <a href="Cvode.html#TYPEsession">session</a>, [ `Nvec ])<br>                 <a href="Sundials_NonlinearSolver.html#TYPEt">Sundials_NonlinearSolver.t</a> -><br>       ?nlsrhsfn:'data <a href="Cvode.html#TYPErhsfn">rhsfn</a> -><br>       ?lsolver:('data, 'kind) <a href="Cvode.html#TYPElinear_solver">linear_solver</a> -><br>       'data <a href="Cvode.html#TYPErhsfn">rhsfn</a> -><br>       ?roots:int * 'data <a href="Cvode.html#TYPErootsfn">rootsfn</a> -><br>       ?projfn:'data <a href="Cvode.html#TYPEproj_fn">proj_fn</a> -><br>       float -> ('data, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('data, 'kind) <a href="Cvode.html#TYPEsession">session</a></code></pre><div class="info ">
<div class="info-desc">
<p>Creates and initializes a session with the solver. The call</p>
<pre class="codepre"><code class="code">init lmm tol ~nlsolver ~nlsrhsfn ~lsolver f ~roots:(nroots, g) ~projfn t0 y0</code></pre><p>has as arguments:</p>
<ul>
<li><code class="code">lmm</code>,      the linear multistep method (see <a href="Cvode.html#TYPElmm"><code class="code"><span class="constructor">Cvode</span>.lmm</code></a>),</li>
<li><code class="code">tol</code>,      the integration tolerances,</li>
<li><code class="code">nlsolver</code>, the solver to use to calculate integration steps,</li>
<li><code class="code">nlsrhsfn</code>, alternative right-hand-side function to use in
                  nonlinear system function evaluations,</li>
<li><code class="code">lsolver</code>,  used by <code class="code">nlsolver</code>s based on Newton interation,</li>
<li><code class="code">f</code>,        the ODE right-hand-side function,</li>
<li><code class="code">nroots</code>,   the number of root functions,</li>
<li><code class="code">g</code>,        the root function (<code class="code">(nroots,&nbsp;g)</code> defaults to <a href="Cvode.html#VALno_roots"><code class="code"><span class="constructor">Cvode</span>.no_roots</code></a>),</li>
<li><code class="code">projfn</code>,   enables projection onto the constraint manifold using the
                  given function after each time step,</li>
<li><code class="code">t0</code>,       the initial value of the independent variable, and,</li>
<li><code class="code">y0</code>,       a vector of initial values that also determines the number
                  of equations.</li>
</ul>
<p>This function does everything necessary to initialize a session, i.e.,
    it makes the calls referenced below. The <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> and
    <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a> functions may be called directly.</p>

<p>If an <code class="code">nlsolver</code> is not specified, then the
    <a href="Sundials_NonlinearSolver.Newton.html">Newton</a> module is used by default.
    In this case only, <code class="code">lsolver</code> defaults to <a href="Cvode.Diag.html#VALsolver"><code class="code"><span class="constructor">Cvode</span>.<span class="constructor">Diag</span>.solver</code></a> if not otherwise
    specified. Specifying an <code class="code">nlsolver</code> that requires a linear solver without
    specifying an <code class="code">lsolver</code> results in a <a href="Cvode.html#EXCEPTIONNonlinearInitFailure"><code class="code"><span class="constructor">Cvode</span>.<span class="constructor">NonlinearInitFailure</span></code></a> (or
    <a href="Cvode.html#EXCEPTIONIllInput"><code class="code"><span class="constructor">Cvode</span>.<span class="constructor">IllInput</span></code></a> for Sundials &lt; 4.0.0) exception on the first call to
    <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> or <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a>.</p>

<p>The projection feature is only supported for Sundials &gt;= 5.3.0 and the
    <a href="Cvode.html#TYPElmm">BDF</a> method.</p>

<p>The alternative right-hand-side function for nonlinear system function
    evaluations is only supported for Sundials &gt;= 5.8.0.</p>

<p>By default, the session is created using the context returned by
    <a href="Sundials.Context.html#VALdefault"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">Context</span>.default</code></a>, but this can be overridden by passing an
    optional <code class="code">context</code> argument.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeCreate">CVodeCreate</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeInit">CVodeInit</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeRootInit">CVodeRootInit</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetLinearSolver">CVodeSetLinearSolver</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetNonlinearSolver">CVodeSetNonlinearSolver</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSStolerances">CVodeSStolerances</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSVtolerances">CVodeSVtolerances</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeWFtolerances">CVodeWFtolerances</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVEwtFn">CVEwtFn</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetProjFn">CVodeSetProjFn</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetNlsRhsFn">CVodeSetNlsRhsFn</a></li></ul>
</div>

<pre><span id="VALno_roots"><span class="keyword">val</span> no_roots</span> : <code class="type">int * 'd <a href="Cvode.html#TYPErootsfn">rootsfn</a></code></pre><div class="info ">
<div class="info-desc">
<p>A convenience value for signalling that there are no roots to monitor.</p>
</div>
</div>

<pre><code><span id="TYPEsolver_result"><span class="keyword">type</span> <code class="type"></code>solver_result</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.Success"><span class="constructor">Success</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The solution was advanced. <span class="cconst">(CV_SUCCESS)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.RootsFound"><span class="constructor">RootsFound</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>A root was found. See <a href="Cvode.html#VALget_root_info"><code class="code"><span class="constructor">Cvode</span>.get_root_info</code></a>.
                            <span class="cconst">(CV_ROOT_RETURN)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTsolver_result.StopTimeReached"><span class="constructor">StopTimeReached</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The stop time was reached. See <a href="Cvode.html#VALset_stop_time"><code class="code"><span class="constructor">Cvode</span>.set_stop_time</code></a>.
                            <span class="cconst">(CV_TSTOP_RETURN)</span></p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Values returned by the step functions. Failures are indicated by
    exceptions.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVode">CVode</a></li></ul>
</div>


<pre><span id="VALsolve_normal"><span class="keyword">val</span> solve_normal</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -><br>       float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float * <a href="Cvode.html#TYPEsolver_result">solver_result</a></code></pre><div class="info ">
<div class="info-desc">
<p>Integrates an ODE system over an interval. The call
    <code class="code">tret,&nbsp;r&nbsp;=&nbsp;solve_normal&nbsp;s&nbsp;tout&nbsp;yout</code> has as arguments</p>
<ul>
<li><code class="code">s</code>, a solver session,</li>
<li><code class="code">tout</code>, the next time at which a solution is desired, and,</li>
<li><code class="code">yout</code>, a vector to store the computed solution.</li>
</ul>
<p>It returns <code class="code">tret</code>, the time reached by the solver, which will be equal to
    <code class="code">tout</code> if no errors occur, and, <code class="code">r</code>, a <a href="Cvode.html#TYPEsolver_result"><code class="code"><span class="constructor">Cvode</span>.solver_result</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>IllInput</code> Missing or illegal solver inputs.</li>
<li><code>TooClose</code> The initial and final times are too close to each other and not initial step size was specified.</li>
<li><code>TooMuchWork</code> The requested time could not be reached in <code class="code">mxstep</code> internal steps.</li>
<li><code>TooMuchAccuracy</code> The requested accuracy could not be satisfied.</li>
<li><code>ErrFailure</code> Too many error test failures within a step or at the minimum step size.</li>
<li><code>ConvergenceFailure</code> Too many convergence test failures within a step or at the minimum step size.</li>
<li><code>LinearInitFailure</code> Linear solver initialization failed.</li>
<li><code>LinearSetupFailure</code> Linear solver setup failed unrecoverably.</li>
<li><code>LinearSolveFailure</code> Linear solver solution failed unrecoverably.</li>
<li><code>RhsFuncFailure</code> Unrecoverable failure in the RHS function <code class="code">f</code>.</li>
<li><code>FirstRhsFuncFailure</code> Initial unrecoverable failure in the RHS function <code class="code">f</code>.</li>
<li><code>RepeatedRhsFuncFailure</code> Too many convergence test failures, or unable to estimate the initial step size, due to repeated recoverable errors in the right-hand side function.</li>
<li><code>UnrecoverableRhsFuncFailure</code> The right-hand side function had a recoverable error, but no recovery was possible. This error can only occur after an error test failure at order one.</li>
<li><code>RootFuncFailure</code> Failure in the rootfinding function <code class="code">g</code>.</li>
</ul></div>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVode">CVode (CV_NORMAL)</a></li></ul>
</div>

<pre><span id="VALsolve_one_step"><span class="keyword">val</span> solve_one_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -><br>       float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float * <a href="Cvode.html#TYPEsolver_result">solver_result</a></code></pre><div class="info ">
<div class="info-desc">
<p>Like <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> but returns after one internal solver step.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVode">CVode (CV_ONE_STEP)</a></li></ul>
</div>

<pre><span id="VALget_dky"><span class="keyword">val</span> get_dky</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the interpolated solution or derivatives.
    <code class="code">get_dky&nbsp;s&nbsp;dky&nbsp;t&nbsp;k</code> computes the <code class="code">k</code>th derivative of the function at time
    <code class="code">t</code>, i.e., $\frac{d^\mathtt{k}y(\mathtt{t})}{\mathit{dt}^\mathtt{k}}$,
    and stores it in <code class="code">dky</code>. The arguments must satisfy
    $t_n - h_u \leq \mathtt{t} \leq t_n$—where $t_n$
    denotes <a href="Cvode.html#VALget_current_time"><code class="code"><span class="constructor">Cvode</span>.get_current_time</code></a> and $h_u$ denotes <a href="Cvode.html#VALget_last_step"><code class="code"><span class="constructor">Cvode</span>.get_last_step</code></a>,—
    and $0 \leq \mathtt{k} \leq q_u$—where $q_u$ denotes
    <a href="Cvode.html#VALget_last_order"><code class="code"><span class="constructor">Cvode</span>.get_last_order</code></a>.</p>

<p>This function may only be called after a successful return from either
    <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> or <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadT</code> <code class="code">t</code> is not in the interval $[t_n - h_u, t_n]$.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range 0, 1, ..., $q_u$.</li>
</ul></div>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetDky">CVodeGetDky</a></li></ul>
</div>

<pre><span id="VALreinit"><span class="keyword">val</span> reinit</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -><br>       ?nlsolver:('d, 'k, ('d, 'k) <a href="Cvode.html#TYPEsession">session</a>, [ `Nvec ])<br>                 <a href="Sundials_NonlinearSolver.html#TYPEt">Sundials_NonlinearSolver.t</a> -><br>       ?nlsrhsfn:'d <a href="Cvode.html#TYPErhsfn">rhsfn</a> -><br>       ?lsolver:('d, 'k) <a href="Cvode.html#TYPElinear_solver">linear_solver</a> -><br>       ?roots:int * 'd <a href="Cvode.html#TYPErootsfn">rootsfn</a> -><br>       ?rhsfn:'d <a href="Cvode.html#TYPErhsfn">rhsfn</a> -> float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Reinitializes the solver with new parameters and state values. The
    values of the independent variable, i.e., the simulation time, and the
    state variables must be given. If given, <code class="code">nlsolver</code> specifies a nonlinear
    solver, <code class="code">nlsrhsfn</code> specifies an alternative rhs function for nonlinear
    system function evaluations,<code class="code">lsolver</code> specifies a linear solver,
    <code class="code">roots</code> specifies a new root finding function, and <code class="code">rhsfn</code> specifies
    a new rhs function; all default to unchanged.</p>

<p>If the new problem does not have a constraint equation, but the old one
    did, then <a href="Cvode.html#VALset_proj_frequency"><code class="code"><span class="constructor">Cvode</span>.set_proj_frequency</code></a> must a zero argument to disable
    projection.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeReInit">CVodeReInit</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetLinearSolver">CVodeSetLinearSolver</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetNonlinearSolver">CVodeSetNonlinearSolver</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetNlsRhsFn">CVodeSetNlsRhsFn</a></li></ul>
</div>
<h3 id="set">Modifying the solver (optional input functions)</h3>
<pre><span id="VALset_tolerances"><span class="keyword">val</span> set_tolerances</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> ('d, 'k) <a href="Cvode.html#TYPEtolerance">tolerance</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the integration tolerances.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSStolerances">CVodeSStolerances</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSVtolerances">CVodeSVtolerances</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeWFtolerances">CVodeWFtolerances</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVEwtFn">CVEwtFn</a></li></ul>
</div>

<pre><span id="VALset_error_file"><span class="keyword">val</span> set_error_file</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> <a href="Sundials.Logfile.html#TYPEt">Sundials.Logfile.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Configure the default error handler to write messages to a file.
    By default it writes to Logfile.stderr.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetErrFile">CVodeSetErrFile</a></li></ul>
</div>

<pre><span id="VALset_err_handler_fn"><span class="keyword">val</span> set_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> (<a href="Sundials.Util.html#TYPEerror_details">Sundials.Util.error_details</a> -> unit) -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a custom function for handling error messages.
    The handler must not fail: any exceptions are trapped and discarded.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetErrHandlerFn">CVodeSetErrHandlerFn</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVErrHandlerFn">CVErrHandlerFn</a></li></ul>
</div>

<pre><span id="VALclear_err_handler_fn"><span class="keyword">val</span> clear_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Restores the default error handling function.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetErrHandlerFn">CVodeSetErrHandlerFn</a></li></ul>
</div>

<pre><span id="VALset_monitor_fn"><span class="keyword">val</span> set_monitor_fn</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> (('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> unit) -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a function to be called after the given number of successful
    steps.</p>

<p>The solver solution may be read by the monitoring function, but it should
    not be changed.</p>

<p>This function requires that the underlying library was explicitly built
    with support for monitoring (see <a href="Sundials_Config.html#VALmonitoring_enabled"><code class="code"><span class="constructor">Sundials_Config</span>.monitoring_enabled</code></a>).</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<div class="raisedexceptions"><span class="raises">Raises</span> <code>NotImplementedBySundialsVersion</code> if not provided by the underlying library</div>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMonitorFn">CVodeSetMonitorFn</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMonitorFrequency">CVodeSetMonitorFrequency</a></li></ul>
</div>

<pre><span id="VALset_monitor_frequency"><span class="keyword">val</span> set_monitor_frequency</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the number of successful steps between calls to the monitoring
    function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<div class="raisedexceptions"><span class="raises">Raises</span> <code>NotImplementedBySundialsVersion</code> if not provided by the underlying library</div>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMonitorFrequency">CVodeSetMonitorFrequency</a></li></ul>
</div>

<pre><span id="VALclear_monitor_fn"><span class="keyword">val</span> clear_monitor_fn</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Turns monitoring off.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMonitorFn">CVodeSetMonitorFn</a></li></ul>
</div>

<pre><span id="VALset_max_ord"><span class="keyword">val</span> set_max_ord</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum order of the linear multistep method.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMaxOrd">CVodeSetMaxOrd</a></li></ul>
</div>

<pre><span id="VALset_max_num_steps"><span class="keyword">val</span> set_max_num_steps</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of steps taken in attempting to reach
    a given output time.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMaxNumSteps">CVodeSetMaxNumSteps</a></li></ul>
</div>

<pre><span id="VALset_max_hnil_warns"><span class="keyword">val</span> set_max_hnil_warns</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of messages warning that <code class="code">t&nbsp;+&nbsp;h&nbsp;=&nbsp;t</code> on
    the next internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMaxHnilWarns">CVodeSetMaxHnilWarns</a></li></ul>
</div>

<pre><span id="VALset_stab_lim_det"><span class="keyword">val</span> set_stab_lim_det</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> bool -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Indicates whether the BDF stability limit detection algorithm should be
    used.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetStabLimDet">CVodeSetStabLimDet</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Mathematics_link.html#cvode-mathematics-stablimit">BDF Stability Limit Detection</a></li></ul>
</div>

<pre><span id="VALset_init_step"><span class="keyword">val</span> set_init_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the initial step size.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetInitStep">CVodeSetInitStep</a></li></ul>
</div>

<pre><span id="VALset_min_step"><span class="keyword">val</span> set_min_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a lower bound on the magnitude of the step size.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMinStep">CVodeSetMinStep</a></li></ul>
</div>

<pre><span id="VALset_max_step"><span class="keyword">val</span> set_max_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies an upper bound on the magnitude of the step size.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMaxStep">CVodeSetMaxStep</a></li></ul>
</div>

<pre><span id="VALset_stop_time"><span class="keyword">val</span> set_stop_time</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Limits the value of the independent variable <code class="code">t</code> when solving.
    By default no stop time is imposed.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetStopTime">CVodeSetStopTime</a></li></ul>
</div>

<pre><span id="VALset_max_err_test_fails"><span class="keyword">val</span> set_max_err_test_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of error test failures permitted in attempting
    one step.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMaxErrTestFails">CVodeSetMaxErrTestFails</a></li></ul>
</div>

<pre><span id="VALset_max_nonlin_iters"><span class="keyword">val</span> set_max_nonlin_iters</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of nonlinear solver iterations permitted per
    step.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMaxNonlinIters">CVodeSetMaxNonlinIters</a></li></ul>
</div>

<pre><span id="VALset_max_conv_fails"><span class="keyword">val</span> set_max_conv_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of nonlinear solver convergence failures
    permitted during one step.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMaxConvFails">CVodeSetMaxConvFails</a></li></ul>
</div>

<pre><span id="VALset_nonlin_conv_coef"><span class="keyword">val</span> set_nonlin_conv_coef</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the safety factor used in the nonlinear convergence test.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetNonlinConvCoef">CVodeSetNonlinConvCoef</a></li></ul>
</div>

<pre><span id="VALset_constraints"><span class="keyword">val</span> set_constraints</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a vector defining inequality constraints for each
    component of the solution vector <code class="code">y</code>.  See <a href="Sundials.Constraint.html"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">Constraint</span></code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetConstraints">CVodeSetConstraints</a></li></ul>
</div>

<pre><span id="VALclear_constraints"><span class="keyword">val</span> clear_constraints</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Disables constraint checking.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetConstraints">CVodeSetConstraints</a></li></ul>
</div>

<pre><span id="VALset_proj_err_est"><span class="keyword">val</span> set_proj_err_est</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> bool -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Enables or disables projection of the error estimate by the projection
    function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetProjErrEst">CVodeSetProjErrEst</a></li></ul>
</div>

<pre><span id="VALset_proj_frequency"><span class="keyword">val</span> set_proj_frequency</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set the frequency with which the projection is performed. The default is
    1, that is, every time step. A value of 0 disables projection and a value
    less than zero restores the default.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetProjFrequency">CVodeSetProjFrequency</a></li></ul>
</div>

<pre><span id="VALset_max_num_proj_fails"><span class="keyword">val</span> set_max_num_proj_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set the maximum number of projection failures in a step attempt before an
    unrecoverable error is returned. The default is 10. A value less than 1
    restores the default.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetMaxNumProjFails">CVodeSetMaxNumProjFails</a></li></ul>
</div>

<pre><span id="VALset_eps_proj"><span class="keyword">val</span> set_eps_proj</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set the tolerance for the nonlinear-constrained least-squares problem
    solved by the projection function. The default is 0.1. A value less than
    or equal to zero restores the default.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetEpsProj">CVodeSetEpsProj</a></li></ul>
</div>

<pre><span id="VALset_proj_fail_eta"><span class="keyword">val</span> set_proj_fail_eta</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Sets the time-step reduction factor to apply on a projection function
    failure. The default is 0.25. A value less than or equal to 1, or greater
    than 1 restores the default.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetProjFailEta">CVodeSetProjFailEta</a></li></ul>
</div>
<h3 id="get">Querying the solver (optional output functions)</h3>
<pre><span id="VALget_work_space"><span class="keyword">val</span> get_work_space</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the real and integer workspace sizes.</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">real_size</code>, <code class="code">integer_size</code>)</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetWorkSpace">CVodeGetWorkSpace</a></li></ul>
</div>

<pre><span id="VALget_num_steps"><span class="keyword">val</span> get_num_steps</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of internal steps taken by the solver.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNumSteps">CVodeGetNumSteps</a></li></ul>
</div>

<pre><span id="VALget_num_rhs_evals"><span class="keyword">val</span> get_num_rhs_evals</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls to the right-hand side function.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNumRhsEvals">CVodeGetNumRhsEvals</a></li></ul>
</div>

<pre><span id="VALget_num_lin_solv_setups"><span class="keyword">val</span> get_num_lin_solv_setups</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls made to the linear solver's setup function.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNumLinSolvSetups">CVodeGetNumLinSolvSetups</a></li></ul>
</div>

<pre><span id="VALget_num_err_test_fails"><span class="keyword">val</span> get_num_err_test_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of local error test failures that have occurred.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNumErrTestFails">CVodeGetNumErrTestFails</a></li></ul>
</div>

<pre><span id="VALget_last_order"><span class="keyword">val</span> get_last_order</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integration method order used during the last internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetLastOrder">CVodeGetLastOrder</a></li></ul>
</div>

<pre><span id="VALget_current_order"><span class="keyword">val</span> get_current_order</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integration method order to be used on the next internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetCurrentOrder">CVodeGetCurrentOrder</a></li></ul>
</div>

<pre><span id="VALget_current_state"><span class="keyword">val</span> get_current_state</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> 'd</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the current state vector. This vector provides direct access to
    the data within the integrator.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetCurrentState">CVodeGetCurrentState</a></li></ul>
</div>

<pre><code><span id="TYPEnonlin_system_data"><span class="keyword">type</span> <code class="type">'d</code> nonlin_system_data</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.tn">tn</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Independent variable value $t_n$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.ypred">ypred</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Predicted state vector $y_{\mathit{pred}}$  at $t_n$ . This
        data must not be changed.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.yn">yn</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>State vector $y^n$ . This data may not be current and may
        need to be filled.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.fn">fn</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The right-hand side function evaluated at the current time and state,
        $f(t_n, y^n)$ . * This data may not be current and may need to
        be filled.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.gamma">gamma</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Current value of $\gamma$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.rl1">rl1</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>A scaling factor used to compute $\tilde{a}_n =
          \mathtt{rl1}\cdot\mathtt{zn1}$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTnonlin_system_data.zn1">zn1</span>&nbsp;: <code class="type">'d</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>A vector used to compute $\tilde{a}_n =
          \mathtt{rl1}\cdot\mathtt{zn1}$ .</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Internal data required to construct the current nonlinear implicit
    system within a nonlinear solver.</p>
</div>
</div>


<pre><span id="VALget_nonlin_system_data"><span class="keyword">val</span> get_nonlin_system_data</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> 'd <a href="Cvode.html#TYPEnonlin_system_data">nonlin_system_data</a></code></pre><div class="info ">
<div class="info-desc">
<p>Gives direct access to the internal data required to construct the
    current nonlinear system within a nonlinear solver. This
    function should be called inside the nonlinear system function.
    If the nonlinear solver uses the <code class="code">lsetup</code> or <code class="code">lsolve</code> functions, then
    the nonlinear solver system function must fill the <code class="code">zi</code> and <code class="code">fi</code>
    vectors with, respectively, the current state and corresponding
    evaluation of the right-hand-side function:
    $y^n = y_{\mathit{pred}} + y_{\mathit{cor}}$  and
    $f_n = f(t_n, y^n)$  where $y_{\mathit{cor}}$  is the
    first argument of the nonlinear solver system function. Within a custom
    linear solver, then the vectors <code class="code">yn</code> and <code class="code">fn</code> are only current after
    an evaluation of the nonlinear system function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNonlinearSystemData">CVodeGetNonlinearSystemData</a></li></ul>
</div>

<pre><span id="VALcompute_state"><span class="keyword">val</span> compute_state</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Computes the current stage state vector using the stored prediction and
    the supplied correction from the nonlinear solver. The call
    <code class="code">compute_state&nbsp;s&nbsp;ycor&nbsp;yn</code> computes $y^n = y_{\mathit{pred}}
    + y_{\mathit{cor}}$ .</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeComputeState">CVodeComputeState</a></li></ul>
</div>

<pre><span id="VALget_current_gamma"><span class="keyword">val</span> get_current_gamma</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the current value of $\gamma$ .
    This scalar appears in the internal Newton equation,
    $M = I - \gamma J$ .</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetCurrentGamma">CVodeGetCurrentGamma</a></li></ul>
</div>

<pre><span id="VALget_last_step"><span class="keyword">val</span> get_last_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integration step size taken on the last internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetLastStep">CVodeGetLastStep</a></li></ul>
</div>

<pre><span id="VALget_current_step"><span class="keyword">val</span> get_current_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integration step size to be attempted on the next internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetCurrentStep">CVodeGetCurrentStep</a></li></ul>
</div>

<pre><span id="VALget_actual_init_step"><span class="keyword">val</span> get_actual_init_step</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the the value of the integration step size used on the first step.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetActualInitStep">CVodeGetActualInitStep</a></li></ul>
</div>

<pre><span id="VALget_current_time"><span class="keyword">val</span> get_current_time</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the the current internal time reached by the solver.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetCurrentTime">CVodeGetCurrentTime</a></li></ul>
</div>

<pre><span id="VALget_num_stab_lim_order_reds"><span class="keyword">val</span> get_num_stab_lim_order_reds</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of order reductions dictated by the BDF stability limit
    detection algorithm.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNumStabLimOrderReds">CVodeGetNumStabLimOrderReds</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Mathematics_link.html#cvode-mathematics-stablimit">BDF Stability Limit Detection</a></li></ul>
</div>

<pre><span id="VALget_tol_scale_factor"><span class="keyword">val</span> get_tol_scale_factor</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns a suggested factor by which the user's tolerances should be scaled
    when too much accuracy has been requested for some internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetTolScaleFactor">CVodeGetTolScaleFactor</a></li></ul>
</div>

<pre><span id="VALget_err_weights"><span class="keyword">val</span> get_err_weights</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the solution error weights at the current time.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetErrWeights">CVodeGetErrWeights</a></li></ul>
</div>

<pre><span id="VALget_est_local_errors"><span class="keyword">val</span> get_est_local_errors</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the vector of estimated local errors.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetEstLocalErrors">CVodeGetEstLocalErrors</a></li></ul>
</div>

<pre><code><span id="TYPEintegrator_stats"><span class="keyword">type</span> <code class="type"></code>integrator_stats</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_steps">num_steps</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Cumulative number of internal solver steps.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_rhs_evals">num_rhs_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of calls to the right-hand side function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_lin_solv_setups">num_lin_solv_setups</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of setups calls to the linear solver.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.num_err_test_fails">num_err_test_fails</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of local error test failures.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.last_order">last_order</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Integration method order used in the last internal step.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_order">current_order</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Integration method order to be used in the next internal step.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.actual_init_step">actual_init_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Integration step sized used on the first step.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.last_step">last_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Integration step size of the last internal step.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_step">current_step</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Integration step size to attempt on the next internal step.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTintegrator_stats.current_time">current_time</span>&nbsp;: <code class="type">float</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Current internal time reached by the solver.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Summaries of integrator statistics.</p>
</div>
</div>


<pre><span id="VALget_integrator_stats"><span class="keyword">val</span> get_integrator_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> <a href="Cvode.html#TYPEintegrator_stats">integrator_stats</a></code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integrator statistics as a group.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetIntegratorStats">CVodeGetIntegratorStats</a></li></ul>
</div>

<pre><span id="VALprint_integrator_stats"><span class="keyword">val</span> print_integrator_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> Stdlib.out_channel -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Prints the integrator statistics on the given channel.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetIntegratorStats">CVodeGetIntegratorStats</a></li></ul>
</div>

<pre><code><span id="TYPElinear_solver_stats"><span class="keyword">type</span> <code class="type"></code>linear_solver_stats</span> = {</code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_stats.jac_evals">jac_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of calls made by a linear solver to the Jacobian
          approximation function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_stats.lin_rhs_evals">lin_rhs_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Number of calls to the right-hand side callback due to
          the finite difference Jacobian approximation.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_stats.lin_iters">lin_iters</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The cumulative number of linear iterations.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_stats.lin_conv_fails">lin_conv_fails</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The cumulative number of linear convergence failures.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_stats.prec_evals">prec_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The cumulative number of calls to the setup function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_stats.prec_solves">prec_solves</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The cumulative number of calls to the solve function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_stats.jtsetup_evals">jtsetup_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The cumulative number of calls to the Jacobian-vector
          setup function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code>&nbsp;&nbsp;</code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTlinear_solver_stats.jtimes_evals">jtimes_evals</span>&nbsp;: <code class="type">int</code>;</code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>The cumulative number of calls to the Jacobian-vector function.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>
<code>}</code>

<div class="info ">
<div class="info-desc">
<p>Summaries of linear solver statistics.</p>
</div>
</div>


<pre><span id="VALget_linear_solver_stats"><span class="keyword">val</span> get_linear_solver_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> <a href="Cvode.html#TYPElinear_solver_stats">linear_solver_stats</a></code></pre><div class="info ">
<div class="info-desc">
<p>Returns linear solver statistics as a group.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.3.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetLinSolveStats">CVodeGetLinSolveStats</a></li></ul>
</div>

<pre><span id="VALget_num_nonlin_solv_iters"><span class="keyword">val</span> get_num_nonlin_solv_iters</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear (functional or Newton)
    iterations.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNumNonlinSolvIters">CVodeGetNumNonlinSolvIters</a></li></ul>
</div>

<pre><span id="VALget_num_nonlin_solv_conv_fails"><span class="keyword">val</span> get_num_nonlin_solv_conv_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear convergence failures.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNumNonlinSolvConvFails">CVodeGetNumNonlinSolvConvFails</a></li></ul>
</div>

<pre><span id="VALget_nonlin_solv_stats"><span class="keyword">val</span> get_nonlin_solv_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns both the numbers of nonlinear iterations performed <code class="code">nniters</code> and
    nonlinear convergence failures <code class="code">nncfails</code>.</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">nniters</code>, <code class="code">nncfails</code>)</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNonlinSolvStats">CVodeGetNonlinSolvStats</a></li></ul>
</div>
<h3 id="roots">Additional root-finding functions</h3>
<pre><span id="VALset_root_direction"><span class="keyword">val</span> set_root_direction</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">set_root_direction&nbsp;s&nbsp;dir</code> specifies the direction of zero-crossings to be
    located and returned. <code class="code">dir</code> may contain one entry for each root function.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetRootDirection">CVodeSetRootDirection</a></li></ul>
</div>

<pre><span id="VALset_all_root_directions"><span class="keyword">val</span> set_all_root_directions</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Like <a href="Cvode.html#VALset_root_direction"><code class="code"><span class="constructor">Cvode</span>.set_root_direction</code></a> but specifies a single direction for all root
    functions.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetRootDirection">CVodeSetRootDirection</a></li></ul>
</div>

<pre><span id="VALset_no_inactive_root_warn"><span class="keyword">val</span> set_no_inactive_root_warn</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Disables issuing a warning if some root function appears to be identically
    zero at the beginning of the integration.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeSetNoInactiveRootWarn">CVodeSetNoInactiveRootWarn</a></li></ul>
</div>

<pre><span id="VALget_num_roots"><span class="keyword">val</span> get_num_roots</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of root functions.</p>
</div>
</div>

<pre><span id="VALget_root_info"><span class="keyword">val</span> get_root_info</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> <a href="Sundials.Roots.html#TYPEt">Sundials.Roots.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Fills an array showing which functions were found to have a root.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetRootInfo">CVodeGetRootInfo</a></li></ul>
</div>

<pre><span id="VALget_num_g_evals"><span class="keyword">val</span> get_num_g_evals</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of calls made to the user-supplied root
    function g.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNumGEvals">CVodeGetNumGEvals</a></li></ul>
</div>

<pre><span id="VALget_num_proj_evals"><span class="keyword">val</span> get_num_proj_evals</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the current total number of projection evaluations.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNumProjEvals">CVodeGetNumProjEvals</a></li></ul>
</div>

<pre><span id="VALget_num_proj_fails"><span class="keyword">val</span> get_num_proj_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the current total number of projection evaluation failures.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetNumProjFails">CVodeGetNumProjFails</a></li></ul>
</div>
<h3 id="exceptions">Exceptions</h3>
<pre><span id="EXCEPTIONIllInput"><span class="keyword">exception</span> IllInput</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised on missing or illegal solver inputs. Also raised if an element
    of the error weight vector becomes zero during time stepping, or the
    linear solver initialization function failed, or a root was found both at
    <code class="code">t</code> and very near <code class="code">t</code>.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_ILL_INPUT</a></li></ul>
</div>

<pre><span id="EXCEPTIONTooClose"><span class="keyword">exception</span> TooClose</span></pre>
<div class="info ">
<div class="info-desc">
<p>The initial and final times are too close to each other and an initial step
    size was not specified.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_TOO_CLOSE</a></li></ul>
</div>

<pre><span id="EXCEPTIONTooMuchWork"><span class="keyword">exception</span> TooMuchWork</span></pre>
<div class="info ">
<div class="info-desc">
<p>The requested time could not be reached in <code class="code">mxstep</code> internal steps.
    See <a href="Cvode.html#VALset_max_num_steps"><code class="code"><span class="constructor">Cvode</span>.set_max_num_steps</code></a></p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_TOO_MUCH_WORK</a></li></ul>
</div>

<pre><span id="EXCEPTIONTooMuchAccuracy"><span class="keyword">exception</span> TooMuchAccuracy</span></pre>
<div class="info ">
<div class="info-desc">
<p>The requested accuracy could not be satisfied.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_TOO_MUCH_ACC</a></li></ul>
</div>

<pre><span id="EXCEPTIONErrFailure"><span class="keyword">exception</span> ErrFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Too many error test failures within a step or at the minimum step size.
    See <a href="Cvode.html#VALset_max_err_test_fails"><code class="code"><span class="constructor">Cvode</span>.set_max_err_test_fails</code></a> and <a href="Cvode.html#VALset_min_step"><code class="code"><span class="constructor">Cvode</span>.set_min_step</code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_ERR_FAILURE</a></li></ul>
</div>

<pre><span id="EXCEPTIONConvergenceFailure"><span class="keyword">exception</span> ConvergenceFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Too many convergence test failures within a step or at the minimum step
    size. See <a href="Cvode.html#VALset_max_conv_fails"><code class="code"><span class="constructor">Cvode</span>.set_max_conv_fails</code></a> and <a href="Cvode.html#VALset_min_step"><code class="code"><span class="constructor">Cvode</span>.set_min_step</code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_CONV_FAILURE</a></li></ul>
</div>

<pre><span id="EXCEPTIONLinearInitFailure"><span class="keyword">exception</span> LinearInitFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Linear solver initialization failed.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_LINIT_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONLinearSetupFailure"><span class="keyword">exception</span> LinearSetupFailure</span> <span class="keyword">of</span> <code class="type">exn option</code></pre>
<div class="info ">
<div class="info-desc">
<p>Linear solver setup failed in an unrecoverable manner.
    If possible, the exception in the underlying linear solver is specified.
    It is typically one of
    <a href="Sundials_LinearSolver.html#EXCEPTIONZeroInDiagonal"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">ZeroInDiagonal</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONPSetFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PSetFailure</span></code></a>,
    or
    <a href="Sundials_LinearSolver.html#EXCEPTIONPackageFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PackageFailure</span></code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetLastLinFlag">CVodeGetLastLinFlag</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_LSETUP_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONLinearSolveFailure"><span class="keyword">exception</span> LinearSolveFailure</span> <span class="keyword">of</span> <code class="type">exn option</code></pre>
<div class="info ">
<div class="info-desc">
<p>Linear solver solution failed in an unrecoverable manner.
    If possible, the exception in the underlying linear solver is specified.
    It is typically one of
    <a href="Sundials_LinearSolver.html#EXCEPTIONZeroInDiagonal"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">ZeroInDiagonal</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONATimesFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">ATimesFailure</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONPSolveFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PSolveFailure</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONGSFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">GSFailure</span></code></a>,
    <a href="Sundials_LinearSolver.html#EXCEPTIONQRSolFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">QRSolFailure</span></code></a>,
    or
    <a href="Sundials_LinearSolver.html#EXCEPTIONPackageFailure"><code class="code"><span class="constructor">Sundials_LinearSolver</span>.<span class="constructor">PackageFailure</span></code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Usage/index.html#c.CVodeGetLastLinFlag">CVodeGetLastLinFlag</a></li><li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_LSOLVE_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONNonlinearSolverFailure"><span class="keyword">exception</span> NonlinearSolverFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The nonlinear solver failed in a general way.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_NLS_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONNonlinearInitFailure"><span class="keyword">exception</span> NonlinearInitFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Nonlinear solver initialization failed.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_NLS_INIT_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONNonlinearSetupFailure"><span class="keyword">exception</span> NonlinearSetupFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Nonlinear solver setup failed in an unrecoverable manner.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_NLS_SETUP_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONRhsFuncFailure"><span class="keyword">exception</span> RhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The right-hand side function failed in an unrecoverable manner.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_RHSFUNC_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONFirstRhsFuncFailure"><span class="keyword">exception</span> FirstRhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The right-hand side function had a recoverable error when first called.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_FIRST_RHSFUNC_ERR</a></li></ul>
</div>

<pre><span id="EXCEPTIONRepeatedRhsFuncFailure"><span class="keyword">exception</span> RepeatedRhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Too many convergence test failures, or unable to estimate the initial step
    size, due to repeated recoverable errors in the right-hand side function.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_REPTD_RHSFUNC_ERR</a></li></ul>
</div>

<pre><span id="EXCEPTIONUnrecoverableRhsFuncFailure"><span class="keyword">exception</span> UnrecoverableRhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The right-hand side function had a recoverable error, but no recovery was
    possible. This error can only occur after an error test failure at order
    one.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_UNREC_RHSFUNC_ERR</a></li></ul>
</div>

<pre><span id="EXCEPTIONRootFuncFailure"><span class="keyword">exception</span> RootFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The rootfinding function failed.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_RTFUNC_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONConstraintFailure"><span class="keyword">exception</span> ConstraintFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>No solution satisfying the inequality constraints could be found.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_CONSTR_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONBadK"><span class="keyword">exception</span> BadK</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised by <a href="Cvode.html#VALget_dky"><code class="code"><span class="constructor">Cvode</span>.get_dky</code></a> for invalid order values.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CVodeGetDky (CV_BAD_K)</a></li></ul>
</div>

<pre><span id="EXCEPTIONBadT"><span class="keyword">exception</span> BadT</span></pre>
<div class="info ">
<div class="info-desc">
<p>Raised by <a href="Cvode.html#VALget_dky"><code class="code"><span class="constructor">Cvode</span>.get_dky</code></a> for invalid time values.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CVodeGetDky (CV_BAD_T)</a></li></ul>
</div>

<pre><span id="EXCEPTIONVectorOpErr"><span class="keyword">exception</span> VectorOpErr</span></pre>
<div class="info ">
<div class="info-desc">
<p>A fused vector operation failed.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_VECTOROP_ERR</a></li></ul>
</div>

<pre><span id="EXCEPTIONProjFuncFailure"><span class="keyword">exception</span> ProjFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The projection function failed.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_PROJFUNC_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONRepeatedProjFuncError"><span class="keyword">exception</span> RepeatedProjFuncError</span></pre>
<div class="info ">
<div class="info-desc">
<p>The projection function failed repeatedly.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_REPTD_PROJFUNC_ERR</a></li></ul>
</div>

<pre><span id="EXCEPTIONProjectionNotEnabled"><span class="keyword">exception</span> ProjectionNotEnabled</span></pre>
<div class="info ">
<div class="info-desc">
<p>The project functionality is not enabled. A projection function must be
    given in the call to <a href="Cvode.html#VALinit"><code class="code"><span class="constructor">Cvode</span>.init</code></a> and the last call to <a href="Cvode.html#VALset_proj_frequency"><code class="code"><span class="constructor">Cvode</span>.set_proj_frequency</code></a>
    must not have set the frequency to zero.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials cvode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvode/Constants_link.html">CV_PROJ_MEM_NULL</a></li></ul>
</div>
</body></html>
