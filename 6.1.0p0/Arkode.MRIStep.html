<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="previous" href="Arkode.ERKStep.html">
<link rel="Up" href="Arkode.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Sundials_parallel" rel="Chapter" href="Sundials_parallel.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Linear solvers" rel="Section" href="#mrilinear">
<link title="Inner steppers" rel="Section" href="#innerstepper">
<link title="Coupling coefficients" rel="Section" href="#coupling">
<link title="Solver initialization and use" rel="Section" href="#mrisolver">
<link title="Modifying the solver (optional input functions)" rel="Section" href="#mriset">
<link title="Querying the solver (optional output functions)" rel="Section" href="#mriget">
<link title="Additional root-finding functions" rel="Section" href="#mriroots">
<link title="Optional inputs for time step adaptivity" rel="Subsection" href="#mrisetadap">
<link title="Optional inputs for implicit stage solves" rel="Subsection" href="#mrisetimplicit">
<link title="Implicit solver optional output functions" rel="Subsection" href="#mrigetimplicit">
<title>Sundials/ML 6.1.0p0 : Arkode.MRIStep</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Arkode.ERKStep.html" title="Arkode.ERKStep">Previous</a>
&nbsp;<a class="up" href="Arkode.html" title="Arkode">Up</a>
&nbsp;</div>
<h1>Module <a href="type_Arkode.MRIStep.html">Arkode.MRIStep</a></h1>

<pre><span id="MODULEMRIStep"><span class="keyword">module</span> MRIStep</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Arkode.MRIStep.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>MRIStep Time-Stepping Module for two-rate initial value problems.</p>

<p>This module solves problems of the form
    $\dot{y} = f_s(t, y) + f_f(t, y)$, $y(t_0) = y_0$.</p>

<p>Its interface is structured as follows.</p>
<OL>
<li><a href="#mrilinear">Linear solvers</a></li>
<li><a href="#innerstepper">Inner steppers</a></li>
<li><a href="#coupling">Coupilng coefficients</a></li>
<li><a href="#mrisolver">Solver initialization and use</a></li>
<li><a href="#mriset">Modifying the solver</a></li>
<li><a href="#mriget">Querying the solver</a></li>
<li><a href="#mriroots">Additional root finding functions</a></li>
</OL>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/index.html#using-the-mristep-time-stepping-module">Using the MRIStep time-stepping module</a></li></ul>
</div>
<hr width="100%">

<pre><span class="keyword">include</span> <a href="Arkode.Common.html">Arkode.Common</a></pre>

<pre><span id="TYPEsession"><span class="keyword">type</span> <code class="type">('d, 'k)</code> session</span> = <code class="type">('d, 'k, <a href="Arkode.html#TYPEmristep">Arkode.mristep</a>) session</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A session with the MRIStep time-stepping solver.</p>

<p>An example session with MRIStep (<a href="arkode_mri_skel.ml">arkode_mri_skel.ml</a>):</p>
<pre class="codepre"><code class="code"><span class="keyword">open</span> <span class="constructor">Sundials</span>
<span class="keyword">module</span> <span class="constructor">MRIStep</span> = <span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>
<span class="keyword">module</span> <span class="constructor">ARKStep</span> = <span class="constructor">Arkode</span>.<span class="constructor">ARKStep</span>

<span class="comment">(* 1. Define right-hand-side functions. *)</span>
<span class="keyword">let</span> fslow _t y yd = yd.{0} &lt;- y.{1};
                    yd.{1} &lt;- 0.0
<span class="keyword">let</span> ffast _t _y yd = yd.{0} &lt;- 0.0;
                     yd.{1} &lt;- -9.81

<span class="comment">(* 2. Optionally define a root function. *)</span>
<span class="keyword">let</span> g _t y gout = gout.{0} &lt;- 1.0 -. y.{0}

<span class="comment">(* 3. Set vector of initial values.
      The length of this vector determines the problem size. *)</span>
<span class="keyword">let</span> y = <span class="constructor">RealArray</span>.of_list [ 10.0; 0.0 ]
<span class="keyword">let</span> ynv = <span class="constructor">Nvector_serial</span>.wrap y

<span class="comment">(* 4. Create an ARKStep solver for the fast (inner) integration *)</span>
<span class="keyword">let</span> sf = <span class="constructor">ARKStep</span>.(init (explicit ffast) default_tolerances 0.0 ynv)

<span class="comment">(* 5. Create and initialize a solver session. *)</span>
<span class="keyword">let</span> slowstep = 0.01
<span class="keyword">let</span> s = <span class="constructor">MRIStep</span>.(init (explicit fslow)
                      default_tolerances
                      <span class="constructor">InnerStepper</span>.(from_arkstep sf)
                      ~roots:(1, g) ~slowstep 0.0 ynv);;

<span class="comment">(* 6. Set optional inputs, e.g.,
      call [set_*] functions to change solver parameters. *)</span>
<span class="constructor">MRIStep</span>.set_stop_time s 10.0;;
<span class="constructor">MRIStep</span>.set_all_root_directions s <span class="constructor">RootDirs</span>.<span class="constructor">Increasing</span>;;

<span class="comment">(* 7. Advance the solution in time,
      by repeatedly calling [evolve_normal] or [evolve_one_step]. *)</span>
<span class="keyword">let</span> <span class="keyword">rec</span> go (t, r) =
  <span class="constructor">Printf</span>.printf <span class="string">"% .10e\t% .10e\t% .10e\n"</span> t y.{0} y.{1};
  <span class="keyword">match</span> r <span class="keyword">with</span>
  <span class="keywordsign">|</span> <span class="constructor">MRIStep</span>.<span class="constructor">Success</span> <span class="keywordsign">-&gt;</span> go (<span class="constructor">MRIStep</span>.evolve_normal s (t +. 0.5) ynv)
  <span class="keywordsign">|</span> <span class="constructor">MRIStep</span>.<span class="constructor">RootsFound</span> <span class="keywordsign">-&gt;</span> <span class="keyword">begin</span>
        y.{1} &lt;- -0.8 *. y.{1};
        <span class="constructor">MRIStep</span>.reinit s t ynv;
        <span class="constructor">ARKStep</span>.reinit sf t ynv;
        go (t, <span class="constructor">MRIStep</span>.<span class="constructor">Success</span>)
      <span class="keyword">end</span>
  <span class="keywordsign">|</span> <span class="constructor">MRIStep</span>.<span class="constructor">StopTimeReached</span> <span class="keywordsign">-&gt;</span> ();;

<span class="constructor">Printf</span>.printf <span class="string">"time\ty\ty'\n"</span>;;
go (0.0, <span class="constructor">MRIStep</span>.<span class="constructor">Success</span>);;

<span class="comment">(* 8. Get optional outputs,
      call the [get_*] functions to examine solver statistics. *)</span>
<span class="keyword">let</span> ns = <span class="constructor">MRIStep</span>.get_num_steps s
      </code></pre></div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/Skeleton.html#a-skeleton-of-the-user-s-main-program">Skeleton of main program</a></li></ul>
</div>


<pre><span id="TYPEserial_session"><span class="keyword">type</span> <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_session</span> = <code class="type">(<a href="Nvector_serial.html#TYPEdata">Nvector_serial.data</a>, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a) <a href="Arkode.MRIStep.html#TYPEsession">session</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>Alias for sessions based on serial nvectors.</p>
</div>
</div>

<h3 id="mrilinear">Linear solvers</h3>
<pre><span id="TYPElinear_solver"><span class="keyword">type</span> <code class="type">('data, 'kind)</code> linear_solver</span> </pre>
<div class="info ">
<div class="info-desc">
<p>Linear solvers used by MRIStep.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#arkode-usage-mristep-linearsolvers">Linear solver interface functions</a></li></ul>
</div>


<pre><span id="TYPEserial_linear_solver"><span class="keyword">type</span> <code class="type">[> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ]</code> serial_linear_solver</span> = <code class="type">(<a href="Nvector_serial.html#TYPEdata">Nvector_serial.data</a>, [> <a href="Nvector_serial.html#TYPEkind">Nvector_serial.kind</a> ] as 'a)<br>       <a href="Arkode.MRIStep.html#TYPElinear_solver">linear_solver</a></code> </pre>
<div class="info ">
<div class="info-desc">
<p>Alias for linear solvers that are restricted to serial nvectors.</p>
</div>
</div>


<pre><span id="MODULEDls"><span class="keyword">module</span> <a href="Arkode.MRIStep.Dls.html">Dls</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Arkode.MRIStep.Dls.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Direct Linear Solvers operating on dense, banded, and sparse matrices.</p>

</div>

<pre><span id="MODULESpils"><span class="keyword">module</span> <a href="Arkode.MRIStep.Spils.html">Spils</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Arkode.MRIStep.Spils.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Scaled Preconditioned Iterative Linear Solvers.</p>

</div>

<pre><span id="VALmatrix_embedded_solver"><span class="keyword">val</span> matrix_embedded_solver</span> : <code class="type">(unit, 'data, 'kind, [> `MatE ]) Sundials.LinearSolver.t -><br>       ('data, 'kind) <a href="Arkode.MRIStep.html#TYPElinear_solver">linear_solver</a></code></pre><div class="info ">
<div class="info-desc">
<p>Create an MRIStep-specific linear solver from a generic matrix embedded
      solver.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.8.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetLinearSolver">MRIStepSetLinearSolver</a></li></ul>
</div>
<h3 id="innerstepper">Inner steppers</h3>
<pre><span id="MODULEInnerStepper"><span class="keyword">module</span> <a href="Arkode.MRIStep.InnerStepper.html">InnerStepper</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Arkode.MRIStep.InnerStepper.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Integrators for problems on the MRIStep fast time-scale.</p>

</div>
<h3 id="coupling">Coupling coefficients</h3>
<pre><span id="MODULECoupling"><span class="keyword">module</span> <a href="Arkode.MRIStep.Coupling.html">Coupling</a></span>: <code class="code"><span class="keyword">sig</span></code> <a href="Arkode.MRIStep.Coupling.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info">
<p>Coupling coefficients between fast and slow time scales.</p>

</div>
<h3 id="mrisolver">Solver initialization and use</h3>
<pre><span id="TYPEproblem"><span class="keyword">type</span> <code class="type">('d, 'k)</code> problem</span> </pre>
<div class="info ">
<div class="info-desc">
<p>The form of the initial value problem.</p>
</div>
</div>


<pre><span id="VALimplicit"><span class="keyword">val</span> implicit</span> : <code class="type">?nlsolver:('data, 'kind, ('data, 'kind) <a href="Arkode.MRIStep.html#TYPEsession">session</a>, [ `Nvec ])<br>                 <a href="Sundials_NonlinearSolver.html#TYPEt">Sundials_NonlinearSolver.t</a> -><br>       ?nlsrhsfn:'data rhsfn -><br>       ?lsolver:('data, 'kind) <a href="Arkode.MRIStep.html#TYPElinear_solver">linear_solver</a> -><br>       ?linearity:linearity -> 'data rhsfn -> ('data, 'kind) <a href="Arkode.MRIStep.html#TYPEproblem">problem</a></code></pre><div class="info ">
<div class="info-desc">
<p>Implicit slow right-hand-side function only.
      The fields are as follows.</p>
<ul>
<li><code class="code">nlsolver</code>, the nonlinear solver used for implicit stage solves,</li>
<li><code class="code">nlsrhsfn</code>, alternative implicit right-hand-side function to use in
                    nonlinear system function evaluations,</li>
<li><code class="code">lsolver</code>, used by <code class="code">nlsolver</code>s based on Newton interation.</li>
<li><code class="code">linearity</code>, specifies whether the implicit slow right-hand side
                     function $f^S(t, y)$  is linear in $y$  or
                     nonlinear (the default), and</li>
<li><code class="code">f_s</code>, the implicit, slow portion of the right-hand-side function,</li>
</ul>
<p>If an <code class="code">nlsolver</code> is not specified, then the
      <a href="Sundials_NonlinearSolver.Newton.html">Newton</a> module is used by default.</p>

<p>The alternative implicit right-hand-side function for nonlinear
      system function evaluations is only supported for Sundials &gt;= 5.8.0.</p>
</div>
</div>

<pre><span id="VALexplicit"><span class="keyword">val</span> explicit</span> : <code class="type">'data rhsfn -> ('data, 'kind) <a href="Arkode.MRIStep.html#TYPEproblem">problem</a></code></pre><div class="info ">
<div class="info-desc">
<p>Explicit slow right-hand-side function only. The argument
      specifies the explicit portion of the slow right-hand-side problem.</p>
</div>
</div>

<pre><span id="VALimex"><span class="keyword">val</span> imex</span> : <code class="type">?nlsolver:('data, 'kind, ('data, 'kind) <a href="Arkode.MRIStep.html#TYPEsession">session</a>, [ `Nvec ])<br>                 <a href="Sundials_NonlinearSolver.html#TYPEt">Sundials_NonlinearSolver.t</a> -><br>       ?nlsrhsfn:'data rhsfn -><br>       ?lsolver:('data, 'kind) <a href="Arkode.MRIStep.html#TYPElinear_solver">linear_solver</a> -><br>       ?linearity:linearity -><br>       fsi:'data rhsfn -><br>       fse:'data rhsfn -> unit -> ('data, 'kind) <a href="Arkode.MRIStep.html#TYPEproblem">problem</a></code></pre><div class="info ">
<div class="info-desc">
<p>Slow problem with both implicit and explicit parts. The arguments
      are as described under <a href="Arkode.MRIStep.html#VALimplicit"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.implicit</code></a> and <a href="Arkode.MRIStep.html#VALexplicit"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.explicit</code></a>.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 6.0.0</li>
</ul>
</div>

<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">?context:<a href="Sundials.Context.html#TYPEt">Sundials.Context.t</a> -><br>       ('data, 'kind) <a href="Arkode.MRIStep.html#TYPEproblem">problem</a> -><br>       ('data, 'kind) tolerance -><br>       ('data, 'kind) <a href="Arkode.MRIStep.InnerStepper.html#TYPEt">InnerStepper.t</a> -><br>       ?coupling:<a href="Arkode.MRIStep.Coupling.html#TYPEt">Coupling.t</a> -><br>       slowstep:float -><br>       ?roots:int * 'data rootsfn -><br>       float -> ('data, 'kind) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('data, 'kind) <a href="Arkode.MRIStep.html#TYPEsession">session</a></code></pre><div class="info ">
<div class="info-desc">
<p>Creates and initializes a session with the solver. The call</p>
<pre class="codepre"><code class="code">init problem tol inner ~slowstep:h_s ~roots:(nroots, g) t0 y0</code></pre><p>has as arguments:</p>
<ul>
<li><code class="code">problem</code>, specifies the problem to solve (see <a href="Arkode.MRIStep.html#TYPEproblem"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.problem</code></a>),</li>
<li><code class="code">tol</code>,    the slow-step integration tolerances,</li>
<li><code class="code">inner</code>,  an inner stepper to use for the fast integrator,</li>
<li><code class="code">~coupling</code>, use a customized set of slow-to-fast coupling
                     coefficients,</li>
<li><code class="code">h_s</code>,    the slow step size,</li>
<li><code class="code">nroots</code>, the number of root functions,</li>
<li><code class="code">g</code>,      the root function (<code class="code">(nroots,&nbsp;g)</code> defaults to
                  <a href="Arkode.Common.html#VALno_roots"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">Common</span>.no_roots</code></a>),</li>
<li><code class="code">t0</code>,     the initial value of the independent variable, and</li>
<li><code class="code">y0</code>,     a vector of initial values that also determines the number
                  of equations.</li>
</ul>
<p>This function does everything necessary to initialize a session, i.e.,
      it makes the calls referenced below. The <a href="Arkode.MRIStep.html#VALevolve_normal"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.evolve_normal</code></a> and
      <a href="Arkode.MRIStep.html#VALevolve_one_step"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.evolve_one_step</code></a> functions may be called directly.</p>

<p>If the inner (fast) stepper uses a fixed step size <code class="code">h_f</code> that does not
      evenly divide the time interval between the stages of the outer (slow)
      method, then the actual value used for the fast steps will
      be slightly smaller than <code class="code">h_f</code> to ensure that
      $(c_i^s - c_{i-1}^s)h_s/h_f$  is an integer value. Specifically,
      the fast step for the ith slow stage will be
      $h = \frac{(c_i^s - c_{i-1}^s)h_s}
                   {\left\lceil (c_i^s - c_{i-1}^s)h_s/h_f \right\rceil}$ .</p>

<p>If fixed step sizes and a stop time are used, then the fixed step size
      will be used for all steps except the final step, which may be shorter.
      To resume use of the previous fixed step size, another call to
      <a href="Arkode.MRIStep.html#VALset_fixed_step"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.set_fixed_step</code></a> is required before calling either <a href="Arkode.MRIStep.html#VALevolve_normal"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.evolve_normal</code></a> or
      <a href="Arkode.MRIStep.html#VALevolve_one_step"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.evolve_one_step</code></a>.</p>

<p>Neither Root finding nor non-identity mass matrices are supported in the
      inner session.</p>

<p>For Sundials &lt; 5.4.0, the tolerance must be <a href="Arkode.Common.html#VALdefault_tolerances"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">Common</span>.default_tolerances</code></a>
      and the <code class="code">coupling</code>, <code class="code">nlsolver</code>, <code class="code">lsolver</code>, and <code class="code">linearity</code> arguments are
      not available.</p>

<p>By default, the session is created using the context returned by
      <a href="Sundials.Context.html#VALdefault"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">Context</span>.default</code></a>, but this can be overridden by passing
      an optional <code class="code">context</code> argument.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.0.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepCreate">MRIStepCreate</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetCoupling">MRIStepSetCoupling</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetLinear">MRIStepSetLinear</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetNonlinear">MRIStepSetNonlinear</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetLinearSolver">MRIStepSetLinearSolver</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetNonlinearSolver">MRIStepSetNonlinearSolver</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepRootInit">MRIStepRootInit</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetFixedStep">MRIStepSetFixedStep</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSStolerances">MRIStepSStolerances</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSVtolerances">MRIStepSVtolerances</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepWFtolerances">MRIStepWFtolerances</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetNlsRhsFn">MRIStepSetNlsRhsFn</a></li></ul>
</div>

<pre><span id="VALevolve_normal"><span class="keyword">val</span> evolve_normal</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -><br>       float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float * solver_result</code></pre><div class="info ">
<div class="info-desc">
<p>Integrates an ODE system over an interval. The call
      <code class="code">tret,&nbsp;r&nbsp;=&nbsp;evolve_normal&nbsp;s&nbsp;tout&nbsp;yout</code> has as arguments</p>
<ul>
<li><code class="code">s</code>, a solver session,</li>
<li><code class="code">tout</code>, the next time at which a solution is desired, and,</li>
<li><code class="code">yout</code>, a vector to store the computed solution.</li>
</ul>
<p>It returns <code class="code">tret</code>, the time reached by the solver, which will be equal to
      <code class="code">tout</code> if no errors occur, and, <code class="code">r</code>, a <a href="Arkode.Common.html#TYPEsolver_result"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">Common</span>.solver_result</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>IllInput</code> Missing or illegal solver inputs.</li>
<li><code>TooMuchWork</code> The requested time could not be reached in <code class="code">mxstep</code> internal steps.</li>
<li><code>VectorOpErr</code> A vector operation error occurred</li>
<li><code>InnerStepFail</code> The inner stepper had an unrecoverable error</li>
</ul></div>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepEvolve">MRIStepEvolve (ARK_NORMAL)</a></li></ul>
</div>

<pre><span id="VALevolve_one_step"><span class="keyword">val</span> evolve_one_step</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -><br>       float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float * solver_result</code></pre><div class="info ">
<div class="info-desc">
<p>Like <a href="Arkode.MRIStep.html#VALevolve_normal"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.evolve_normal</code></a> but returns after one internal solver step.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepEvolve">MRIStepEvolve (ARK_ONE_STEP)</a></li></ul>
</div>

<pre><span id="VALget_dky"><span class="keyword">val</span> get_dky</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the interpolated solution or derivatives.
      <code class="code">get_dky&nbsp;s&nbsp;dky&nbsp;t&nbsp;k</code> computes the <code class="code">k</code>th derivative of the function
      at time <code class="code">t</code>, i.e.,
      $\frac{d^\mathtt{k}}{\mathit{dt}^\mathtt{k}}y(\mathtt{t})$,
      and stores it in <code class="code">dky</code>. The arguments must satisfy
      $t_n - h_n \leq \mathtt{t} \leq t_n$—where $t_n$
      denotes <a href="Arkode.MRIStep.html#VALget_current_time"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.get_current_time</code></a> and $h_n$ denotes <a href="Arkode.MRIStep.html#VALget_last_step"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.get_last_step</code></a>,—
      and $0 \leq \mathtt{k} \leq 3$.</p>

<p>This function may only be called after a successful return from either
      <a href="Arkode.MRIStep.html#VALevolve_normal"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.evolve_normal</code></a> or <a href="Arkode.MRIStep.html#VALevolve_one_step"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.evolve_one_step</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadT</code> <code class="code">t</code> is not in the interval $[t_n - h_n, t_n]$.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range {0, 1, ..., dord}.</li>
</ul></div>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetDky">MRIStepGetDky</a></li></ul>
</div>

<pre><span id="VALreinit"><span class="keyword">val</span> reinit</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -><br>       ?problem:('d, 'k) <a href="Arkode.MRIStep.html#TYPEproblem">problem</a> -><br>       ?roots:int * 'd rootsfn -> float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Reinitializes the solver with new parameters and state values. The
      values of the independent variable, i.e., the simulation time, and the
      state variables must be given. If given, <code class="code">problem</code> specifies new
      callback functions and solvers, and <code class="code">roots</code> specifies a new root finding
      function. The new problem must have the same size as the previous one.
      The number of Runge Kutta stages for both the slow and
      fast methods in the new problem must not be larger than that of the
      previous one.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetNonlinearSolver">MRIStepSetNonlinearSolver</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetLinearSolver">MRIStepSetLinearSolver</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetLinear">MRIStepSetLinear</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetNonlinear">MRIStepSetNonlinear</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepReInit">MRIStepReInit</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepRootInit">MRIStepRootInit</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetNlsRhsFn">MRIStepSetNlsRhsFn</a></li></ul>
</div>

<pre><span id="VALreset"><span class="keyword">val</span> reset</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> float -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Resets the state to the given independent variable value and dependent
      variable vector. All previously set options, internal counter values,
      and step-size/error histories are retained.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepReset">MRIStepReset</a></li></ul>
</div>

<pre><span id="VALresize"><span class="keyword">val</span> resize</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -><br>       ?resize_nvec:'d resize_fn -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Change the number of equations and unknowns between integrator steps.
      The call
      <code class="code">resize&nbsp;s&nbsp;~resize_nvec:rfn&nbsp;ynew&nbsp;t0</code>
      has as arguments:</p>
<ul>
<li><code class="code">s</code>, the solver session to resize,</li>
<li><code class="code">rfn</code>, a resize function that transforms nvectors in place-otherwise
               they are simply destroyed and recloned,</li>
<li><code class="code">ynew</code>, the newly-sized solution vector with the value $y(t_0)$, and</li>
<li><code class="code">t0</code>, the current value of the independent variable $t_0$.</li>
</ul>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepResize">MRIStepResize</a></li></ul>
</div>
<h3 id="mriset">Modifying the solver (optional input functions)</h3>
<pre><span id="VALset_defaults"><span class="keyword">val</span> set_defaults</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Resets all optional input parameters to their default values. Neither
      the problem-defining functions nor the root-finding functions are
      changed.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetDefaults">MRIStepSetDefaults</a></li></ul>
</div>

<pre><span id="VALset_interpolant_type"><span class="keyword">val</span> set_interpolant_type</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> interpolant_type -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the interpolation module used for output value interpolation
      and implicit method predictors.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.2.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetInterpolantType">MRIStepSetInterpolantType</a></li></ul>
</div>

<pre><span id="VALset_interpolant_degree"><span class="keyword">val</span> set_interpolant_degree</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the degree of the polynomial interpolant used for output
      values and implicit method predictors.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.2.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetInterpolantDegree">MRIStepSetInterpolantDegree</a></li></ul>
</div>

<pre><span id="VALset_diagnostics"><span class="keyword">val</span> set_diagnostics</span> : <code class="type">?logfile:<a href="Sundials.Logfile.html#TYPEt">Sundials.Logfile.t</a> -> ('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Write step adaptivity and solver diagnostics on the standard output
      (or given file).</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetDiagnostics">MRIStepSetDiagnostics</a></li></ul>
</div>

<pre><span id="VALclear_diagnostics"><span class="keyword">val</span> clear_diagnostics</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Do not write step adaptivity or solver diagnostics of a file.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetDiagnostics">MRIStepSetDiagnostics</a></li></ul>
</div>

<pre><span id="VALset_error_file"><span class="keyword">val</span> set_error_file</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> <a href="Sundials.Logfile.html#TYPEt">Sundials.Logfile.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Configure the default error handler to write messages to a file.
      By default it writes to Logfile.stderr.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetErrFile">MRIStepSetErrFile</a></li></ul>
</div>

<pre><span id="VALset_err_handler_fn"><span class="keyword">val</span> set_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -><br>       (<a href="Sundials.Util.html#TYPEerror_details">Sundials.Util.error_details</a> -> unit) -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a custom function for handling error messages.
      The handler must not fail: any exceptions are trapped and discarded.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetErrHandlerFn">MRIStepSetErrHandlerFn</a></li><li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/User_supplied.html#c.ARKErrHandlerFn">ARKErrHandlerFn</a></li></ul>
</div>

<pre><span id="VALclear_err_handler_fn"><span class="keyword">val</span> clear_err_handler_fn</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Restores the default error handling function.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetErrHandlerFn">MRIStepSetErrHandlerFn</a></li></ul>
</div>

<pre><span id="VALset_fixed_step"><span class="keyword">val</span> set_fixed_step</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Disables time step adaptivity and fix the step size for all internal
      steps. See the notes under <a href="Arkode.MRIStep.html#VALinit"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.init</code></a>.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetFixedStep">MRIStepSetFixedStep</a></li></ul>
</div>

<pre><span id="VALset_max_hnil_warns"><span class="keyword">val</span> set_max_hnil_warns</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of messages warning that <code class="code">t&nbsp;+&nbsp;h&nbsp;=&nbsp;t</code> on
      the next internal step.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetMaxHnilWarns">MRIStepSetMaxHnilWarns</a></li></ul>
</div>

<pre><span id="VALset_max_num_steps"><span class="keyword">val</span> set_max_num_steps</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of steps taken in attempting to reach
      a given output time.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetMaxNumSteps">MRIStepSetMaxNumSteps</a></li></ul>
</div>

<pre><span id="VALset_stop_time"><span class="keyword">val</span> set_stop_time</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Limits the value of the independent variable <code class="code">t</code> when solving.
      By default no stop time is imposed.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetStopTime">MRIStepSetStopTime</a></li></ul>
</div>

<pre><span id="TYPEpre_inner_fn"><span class="keyword">type</span> <code class="type">'d</code> pre_inner_fn</span> = <code class="type">float -> 'd array -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A function to be called <em>before</em> each inner integration. This function
      may be used, for instance, to perform communications or memory transfers
      of forcing data supplied by the outer integrator to the inner
      integrator.</p>

<p>The first argument is the current value of the independent variable. The
      second is an array of outer forcing vectors.</p>

<p><div class="warningbox"> The array and its contents should not be accessed after the
               function has returned</div>.</p>

<p>Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
      indicates a recoverable error. Any other exception is treated as an
      unrecoverable error.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepPreInnerFn">MRIStepPreInnerFn</a></li></ul>
</div>


<pre><span id="VALset_pre_inner_fn"><span class="keyword">val</span> set_pre_inner_fn</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> 'd <a href="Arkode.MRIStep.html#TYPEpre_inner_fn">pre_inner_fn</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set the function called <em>before</em> each inner integration.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetPreInnerFn">MRIStepSetPreInnerFn</a></li></ul>
</div>

<pre><span id="VALclear_pre_inner_fn"><span class="keyword">val</span> clear_pre_inner_fn</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Clear the function called <em>before</em> each inner integration.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetPreInnerFn">MRIStepSetPreInnerFn</a></li></ul>
</div>

<pre><span id="TYPEpost_inner_fn"><span class="keyword">type</span> <code class="type">'d</code> post_inner_fn</span> = <code class="type">float -> 'd -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A function to be called <em>after</em> each inner integration. This function
      may be used, for instance, to perform communications or memory transfers
      of state data supplied by the inner integrator to the outer
      integrator.</p>

<p>The first argument is the current value of the independent variable. The
      second is the current value of the dependent variable vector.</p>

<p><div class="warningbox"> The dependent variable vector should not be accessed after the
               function has returned.</div></p>

<p>Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
      indicates a recoverable error. Any other exception is treated as an
      unrecoverable error.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepPreInnerFn">MRIStepPreInnerFn</a></li></ul>
</div>


<pre><span id="VALset_post_inner_fn"><span class="keyword">val</span> set_post_inner_fn</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> 'd <a href="Arkode.MRIStep.html#TYPEpost_inner_fn">post_inner_fn</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set the function called <em>after</em> each inner integration.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetPostInnerFn">MRIStepSetPostInnerFn</a></li></ul>
</div>

<pre><span id="VALclear_post_inner_fn"><span class="keyword">val</span> clear_post_inner_fn</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Clear the function called <em>after</em> each inner integration.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetPostInnerFn">MRIStepSetPostInnerFn</a></li></ul>
</div>
<h4 id="mrisetadap">Optional inputs for time step adaptivity</h4>
<pre><span id="VALset_postprocess_step_fn"><span class="keyword">val</span> set_postprocess_step_fn</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> 'd postprocess_step_fn -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set a post processing step function.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetPostprocessStepFn">MRIStepSetPostprocessStepFn</a></li></ul>
</div>

<pre><span id="VALclear_postprocess_step_fn"><span class="keyword">val</span> clear_postprocess_step_fn</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Clear the post processing step function.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRISetPostprocessStepFn">MRISetPostprocessStepFn</a></li></ul>
</div>
<h4 id="mrisetimplicit">Optional inputs for implicit stage solves</h4>
<pre><span id="TYPEstage_predict_fn"><span class="keyword">type</span> <code class="type">'d</code> stage_predict_fn</span> = <code class="type">float -> 'd -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>A function to be called <em>after</em> the predictor algorithm to update the
      predictor.</p>

<p>The first argument is the current value of the independent variable. The
      second is the predicated stage solution which may be updated directly.</p>

<p><div class="warningbox"> The array and its contents should not be accessed after the
               function has returned</div>.</p>

<p>All exceptions are treated as unrecoverable errors.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepStagePredictFn">MRIStepStagePredictFn</a></li></ul>
</div>


<pre><span id="VALset_stage_predict_fn"><span class="keyword">val</span> set_stage_predict_fn</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> 'd <a href="Arkode.MRIStep.html#TYPEstage_predict_fn">stage_predict_fn</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Set the function called after the predictor algorithm and before the
      calculation of an implicit stage solution.</p>

<p>If a stage prediction function is set and the current predictor method,
      see <a href="Arkode.MRIStep.html#VALset_predictor_method"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.set_predictor_method</code></a>, is
      <a href="Arkode.Common.html#TYPEpredictor_method">MinimumCorrectionPredictor</a>, then the
      <a href="Arkode.Common.html#TYPEpredictor_method">TrivialPredictor</a> will be used instead.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetStagePredictFn">MRIStepSetStagePredictFn</a></li></ul>
</div>

<pre><span id="VALclear_stage_predict_fn"><span class="keyword">val</span> clear_stage_predict_fn</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Clear the function called after the predictor algorithm.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetStagePredictFn">MRIStepSetStagePredictFn</a></li></ul>
</div>

<pre><span id="VALset_nonlin_conv_coef"><span class="keyword">val</span> set_nonlin_conv_coef</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the safety factor used in the nonlinear convergence test.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetNonlinConvCoef">MRIStepSetNonlinConvCoef</a></li></ul>
</div>

<pre><span id="VALset_nonlin_crdown"><span class="keyword">val</span> set_nonlin_crdown</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the constant used in estimating the nonlinear solver
      convergence rate.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetNonlinCRDown">MRIStepSetNonlinCRDown</a></li></ul>
</div>

<pre><span id="VALset_nonlin_rdiv"><span class="keyword">val</span> set_nonlin_rdiv</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the nonlinear correction threshold beyond which the iteration
      will be declared divergent.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetNonlinRDiv">MRIStepSetNonlinRDiv</a></li></ul>
</div>

<pre><span id="VALset_delta_gamma_max"><span class="keyword">val</span> set_delta_gamma_max</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> float -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies a scaled step size ratio tolerance beyond which the linear
      solver setup routine will be signalled.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetDeltaGammaMax">MRIStepSetDeltaGammaMax</a></li></ul>
</div>

<pre><span id="VALset_lsetup_frequency"><span class="keyword">val</span> set_lsetup_frequency</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the frequency of calls to the linear solver setup routine.
      Positive values specify the number of time steps between setup calls,
      negative values force recomputation at each Newton step, and zero values
      reset to the default (20).</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetLSetupFrequency">MRIStepSetLSetupFrequency</a></li></ul>
</div>

<pre><span id="VALset_linear"><span class="keyword">val</span> set_linear</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> bool -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies that the implicit portion of the problem is linear. The flag
      indicates whether the Jacobian of $f_I(t,y)$, or, when using an
      iterative linear solver, the preconditioner is time-dependent (<code class="code"><span class="keyword">true</span></code>)
      or not (<code class="code"><span class="keyword">false</span></code>).</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetLinear">MRIStepSetLinear</a></li></ul>
</div>

<pre><span id="VALset_nonlinear"><span class="keyword">val</span> set_nonlinear</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies that the implicit portion of the problem is nonlinear.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetNonlinear">MRIStepSetNonlinear</a></li></ul>
</div>

<pre><span id="VALset_predictor_method"><span class="keyword">val</span> set_predictor_method</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> predictor_method -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the method for predicting implicit solutions.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetPredictorMethod">MRIStepSetPredictorMethod</a></li></ul>
</div>

<pre><span id="VALset_max_nonlin_iters"><span class="keyword">val</span> set_max_nonlin_iters</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specifies the maximum number of nonlinear solver iterations permitted
      per RK stage at each step.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<div class="raisedexceptions"><span class="raises">Raises</span> <code>NonlinearOperationError</code> Nonlinear solver not configured</div>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetMaxNonlinIters">MRIStepSetMaxNonlinIters</a></li></ul>
</div>
<h3 id="mriget">Querying the solver (optional output functions)</h3>
<pre><span id="VALget_work_space"><span class="keyword">val</span> get_work_space</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the real and integer workspace sizes.</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">real_size</code>, <code class="code">integer_size</code>)</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetWorkSpace">MRIStepGetWorkSpace</a></li></ul>
</div>

<pre><span id="VALget_num_steps"><span class="keyword">val</span> get_num_steps</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of internal steps taken by the solver.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetNumSteps">MRIStepGetNumSteps</a></li></ul>
</div>

<pre><span id="VALget_last_step"><span class="keyword">val</span> get_last_step</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the integration step size taken on the last successful internal
      step.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetLastStep">MRIStepGetLastStep</a></li></ul>
</div>

<pre><span id="VALget_num_rhs_evals"><span class="keyword">val</span> get_num_rhs_evals</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>The number of calls to the (outer) right-hand-side functions.
      Returns a pair <code class="code">nfse,&nbsp;nfsi&nbsp;=&nbsp;get_num_rhs_evals&nbsp;s</code>, where <code class="code">nfse</code>
      is the number of calls to the explicit part and <code class="code">nfsi</code> is the number of
      calls to the implicit part.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetNumRhsEvals">MRIStepGetNumRhsEvals</a></li></ul>
</div>

<pre><span id="VALget_current_time"><span class="keyword">val</span> get_current_time</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the the current internal time reached by the solver.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetCurrentTime">MRIStepGetCurrentTime</a></li></ul>
</div>

<pre><span id="VALget_current_state"><span class="keyword">val</span> get_current_state</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> 'd</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the current state vector. This vector provides direct access to
      the data within the integrator.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetCurrentState">MRIStepGetCurrentState</a></li></ul>
</div>

<pre><span id="VALget_current_coupling"><span class="keyword">val</span> get_current_coupling</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> <a href="Arkode.MRIStep.Coupling.html#TYPEt">Coupling.t</a></code></pre><div class="info ">
<div class="info-desc">
<p>Returns the coupling table currently in use by the solver.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetCurrentCoupling">MRIStepGetCurrentCoupling</a></li></ul>
</div>

<pre><span id="VALwrite_coupling"><span class="keyword">val</span> write_coupling</span> : <code class="type">?logfile:<a href="Sundials.Logfile.html#TYPEt">Sundials.Logfile.t</a> -> ('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Output the current coupling table on the standard output (or given file).</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepWriteCoupling">MRIStepWriteCoupling</a></li></ul>
</div>

<pre><span id="VALget_nonlin_system_data"><span class="keyword">val</span> get_nonlin_system_data</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> 'd nonlin_system_data</code></pre><div class="info ">
<div class="info-desc">
<p>Gives direct access to the internal data required to construct the
      current nonlinear implicit system within a nonlinear solver. This
      function should be called inside the nonlinear system function.
      If the nonlinear solver uses the <code class="code">lsetup</code> or <code class="code">lsolve</code> functions, then
      the nonlinear solver system function must fill the <code class="code">zi</code> and <code class="code">fi</code>
      vectors with, respectively, the current state and corresponding
      evaluation of the right-hand-side function:
      $z_i = z_{\mathit{pred}} + z_{\mathit{cor}}$  and
      $F_i = f^S(t^S_{n,i}, z_i)$  where $z_{\mathit{cor}}$  is the
      first argument of the nonlinear solver system function. Within a custom
      linear solver, then the vectors <code class="code">zi</code> and <code class="code">fi</code> are only current after
      an evaluation of the nonlinear system function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetNonlinSystemData">MRIStepGetNonlinSystemData</a></li></ul>
</div>

<pre><span id="VALcompute_state"><span class="keyword">val</span> compute_state</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -><br>       ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Computes the current stage state vector using the stored prediction and
      the supplied correction from the nonlinear solver. The call
      <code class="code">compute_state&nbsp;s&nbsp;zcor&nbsp;z</code> computes $z_i(t) = z_{\mathit{pred}}
      + z_{\mathit{cor}}$ .</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepComputeState">MRIStepComputeState</a></li></ul>
</div>

<pre><span id="VALget_current_gamma"><span class="keyword">val</span> get_current_gamma</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the current value of $\gamma$ .
      This scalar appears in the internal Newton equation, either
      $A = I - \gamma J$  or $A = M - \gamma J$ .</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetCurrentGamma">MRIStepGetCurrentGamma</a></li></ul>
</div>

<pre><span id="VALget_tol_scale_factor"><span class="keyword">val</span> get_tol_scale_factor</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns a suggested factor by which the user's tolerances should be
      scaled when too much accuracy has been requested for some internal step.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetTolScaleFactor">MRIStepGetTolScaleFactor</a></li></ul>
</div>

<pre><span id="VALget_err_weights"><span class="keyword">val</span> get_err_weights</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the solution error weights at the current time.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetErrWeights">MRIStepGetErrWeights</a></li></ul>
</div>
<h4 id="mrigetimplicit">Implicit solver optional output functions</h4>
<pre><span id="VALget_num_lin_solv_setups"><span class="keyword">val</span> get_num_lin_solv_setups</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls made to the linear solver's setup function.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetNumLinSolvSetups">MRIStepGetNumLinSolvSetups</a></li></ul>
</div>

<pre><span id="VALget_num_nonlin_solv_iters"><span class="keyword">val</span> get_num_nonlin_solv_iters</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear (functional or Newton)
      iterations.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<div class="raisedexceptions"><span class="raises">Raises</span> <code>NonlinearOperationError</code> Nonlinear solver not configured</div>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetNumNonlinSolvIters">MRIStepGetNumNonlinSolvIters</a></li></ul>
</div>

<pre><span id="VALget_num_nonlin_solv_conv_fails"><span class="keyword">val</span> get_num_nonlin_solv_conv_fails</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of nonlinear convergence failures.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetNumNonlinSolvConvFails">MRIStepGetNumNonlinSolvConvFails</a></li></ul>
</div>

<pre><span id="VALget_nonlin_solv_stats"><span class="keyword">val</span> get_nonlin_solv_stats</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns both the numbers of nonlinear iterations performed <code class="code">nniters</code> and
      nonlinear convergence failures <code class="code">nncfails</code>.</p>
</div>
<ul class="info-attributes">
<li><b>Since</b> 5.4.0</li>
<div class="raisedexceptions"><span class="raises">Raises</span> <code>NonlinearOperationError</code> Nonlinear solver not configured</div>
<li><b>Returns</b> (<code class="code">nniters</code>, <code class="code">nncfails</code>)</li>
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetNonlinSolvStats">MRIStepGetNonlinSolvStats</a></li></ul>
</div>

<pre><span id="VALwrite_session"><span class="keyword">val</span> write_session</span> : <code class="type">?logfile:<a href="Sundials.Logfile.html#TYPEt">Sundials.Logfile.t</a> -> ('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Summarize the session on the standard output (or given file).</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepPrintMem">MRIStepPrintMem</a></li></ul>
</div>
<h3 id="mriroots">Additional root-finding functions</h3>
<pre><span id="VALset_root_direction"><span class="keyword">val</span> set_root_direction</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> array -> unit</code></pre><div class="info ">
<div class="info-desc">
<p><code class="code">set_root_direction&nbsp;s&nbsp;dir</code> specifies the direction of zero-crossings to
      be located and returned. <code class="code">dir</code> may contain one entry for each root
      function.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetRootDirection">MRIStepSetRootDirection</a></li></ul>
</div>

<pre><span id="VALset_all_root_directions"><span class="keyword">val</span> set_all_root_directions</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> <a href="Sundials.RootDirs.html#TYPEd">Sundials.RootDirs.d</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Like <a href="Arkode.MRIStep.html#VALset_root_direction"><code class="code"><span class="constructor">Arkode</span>.<span class="constructor">MRIStep</span>.set_root_direction</code></a> but specifies a single direction for all root
      functions.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetRootDirection">MRIStepSetRootDirection</a></li></ul>
</div>

<pre><span id="VALset_no_inactive_root_warn"><span class="keyword">val</span> set_no_inactive_root_warn</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Disables issuing a warning if some root function appears to be
      identically zero at the beginning of the integration.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepSetNoInactiveRootWarn">MRIStepSetNoInactiveRootWarn</a></li></ul>
</div>

<pre><span id="VALget_num_roots"><span class="keyword">val</span> get_num_roots</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of root functions.</p>
</div>
</div>

<pre><span id="VALget_root_info"><span class="keyword">val</span> get_root_info</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> <a href="Sundials.Roots.html#TYPEt">Sundials.Roots.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Fills an array showing which functions were found to have a root.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetRootInfo">MRIStepGetRootInfo</a></li></ul>
</div>

<pre><span id="VALget_num_g_evals"><span class="keyword">val</span> get_num_g_evals</span> : <code class="type">('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the cumulative number of calls made to the user-supplied root
      function g.</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepGetNumGEvals">MRIStepGetNumGEvals</a></li></ul>
</div>

<pre><span id="VALwrite_parameters"><span class="keyword">val</span> write_parameters</span> : <code class="type">?logfile:<a href="Sundials.Logfile.html#TYPEt">Sundials.Logfile.t</a> -> ('d, 'k) <a href="Arkode.MRIStep.html#TYPEsession">session</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Outputs all the solver parameters on the standard output (or given file).</p>
</div>
<ul class="info-attributes">
<li class="sundials arkode">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/arkode/Usage/MRIStep_c_interface/User_callable.html#c.MRIStepWriteParameters">MRIStepWriteParameters</a></li></ul>
</div>
</body></html>
