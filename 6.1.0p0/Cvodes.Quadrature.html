<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="docstyle.css" type="text/css">
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
</script><script type="text/javascript"
        src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="Start" href="index.html">
<link rel="next" href="Cvodes.Sensitivity.html">
<link rel="Up" href="Cvodes.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of extensions" rel=Appendix href="index_extensions.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Sundials_Index" rel="Chapter" href="Sundials_Index.html">
<link title="Sundials_Config" rel="Chapter" href="Sundials_Config.html">
<link title="Sundials_RealArray" rel="Chapter" href="Sundials_RealArray.html">
<link title="Sundials_RealArray2" rel="Chapter" href="Sundials_RealArray2.html">
<link title="Sundials_LintArray" rel="Chapter" href="Sundials_LintArray.html">
<link title="Sundials_ROArray" rel="Chapter" href="Sundials_ROArray.html">
<link title="Sundials" rel="Chapter" href="Sundials.html">
<link title="Nvector" rel="Chapter" href="Nvector.html">
<link title="Nvector_serial" rel="Chapter" href="Nvector_serial.html">
<link title="Nvector_many" rel="Chapter" href="Nvector_many.html">
<link title="Sundials_Matrix" rel="Chapter" href="Sundials_Matrix.html">
<link title="Sundials_LinearSolver" rel="Chapter" href="Sundials_LinearSolver.html">
<link title="Sundials_NonlinearSolver" rel="Chapter" href="Sundials_NonlinearSolver.html">
<link title="Nvector_custom" rel="Chapter" href="Nvector_custom.html">
<link title="Nvector_array" rel="Chapter" href="Nvector_array.html">
<link title="Cvode" rel="Chapter" href="Cvode.html">
<link title="Kinsol" rel="Chapter" href="Kinsol.html">
<link title="Ida" rel="Chapter" href="Ida.html">
<link title="Arkode" rel="Chapter" href="Arkode.html">
<link title="Cvodes" rel="Chapter" href="Cvodes.html">
<link title="Idas" rel="Chapter" href="Idas.html">
<link title="Sundials_parallel" rel="Chapter" href="Sundials_parallel.html">
<link title="Nvector_parallel" rel="Chapter" href="Nvector_parallel.html">
<link title="Nvector_mpimany" rel="Chapter" href="Nvector_mpimany.html">
<link title="Nvector_mpiplusx" rel="Chapter" href="Nvector_mpiplusx.html">
<link title="Kinsol_bbd" rel="Chapter" href="Kinsol_bbd.html">
<link title="Arkode_bbd" rel="Chapter" href="Arkode_bbd.html">
<link title="Cvode_bbd" rel="Chapter" href="Cvode_bbd.html">
<link title="Cvodes_bbd" rel="Chapter" href="Cvodes_bbd.html">
<link title="Ida_bbd" rel="Chapter" href="Ida_bbd.html">
<link title="Idas_bbd" rel="Chapter" href="Idas_bbd.html">
<link title="Nvector_openmp" rel="Chapter" href="Nvector_openmp.html">
<link title="Nvector_pthreads" rel="Chapter" href="Nvector_pthreads.html"><link title="Initialization and access" rel="Section" href="#init">
<link title="Tolerances" rel="Section" href="#tols">
<link title="Querying the solver (optional output functions)" rel="Section" href="#get">
<link title="Exceptions" rel="Section" href="#exceptions">
<title>Sundials/ML 6.1.0p0 : Cvodes.Quadrature</title>
</head>
<body>
<div class="navbar">&nbsp;<a class="up" href="Cvodes.html" title="Cvodes">Up</a>
&nbsp;<a class="post" href="Cvodes.Sensitivity.html" title="Cvodes.Sensitivity">Next</a>
</div>
<h1>Module <a href="type_Cvodes.Quadrature.html">Cvodes.Quadrature</a></h1>

<pre><span id="MODULEQuadrature"><span class="keyword">module</span> Quadrature</span>: <code class="code"><span class="keyword">sig</span></code> <a href="Cvodes.Quadrature.html">..</a> <code class="code"><span class="keyword">end</span></code></pre><div class="info module top">
<div class="info-desc">
<p>Integration of pure quadrature equations.</p>

<p>Adds a vector $y_Q$ of $N_Q$ quadrature variables defined by
    $\frac{\mathrm{d} y_Q}{\mathrm{d}t} = f_Q(t, y, p)$. The values of
    these variables are calculated more efficiently since they are excluded
    from the nonlinear solution stage.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#integration-of-pure-quadrature-equations">Integration of pure quadrature equations</a></li><li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Mathematics_link.html#pure-quadrature-integration">Pure Quadrature Integration</a></li></ul>
</div>
<hr width="100%">
<h3 id="init">Initialization and access</h3>
<pre><span id="TYPEquadrhsfn"><span class="keyword">type</span> <code class="type">'d</code> quadrhsfn</span> = <code class="type">float -> 'd -> 'd -> unit</code> </pre>
<div class="info ">
<div class="info-desc">
<p>Functions defining quadrature variables. They are passed three
      arguments:</p>
<ul>
<li><code class="code">t</code>, the value of the independent variable, i.e., the simulation time,</li>
<li><code class="code">y</code>, the vector of dependent-variable values, i.e., $y(t)$, and,</li>
<li><code class="code">yQ'</code>, a vector for storing the computed value of
               $\dot{y}_Q = f_Q(t, y)$.</li>
</ul>
<p>Within the function, raising a <a href="Sundials.html#EXCEPTIONRecoverableFailure"><code class="code"><span class="constructor">Sundials</span>.<span class="constructor">RecoverableFailure</span></code></a> exception
      indicates a recoverable error. Any other exception is treated as an
      unrecoverable error.</p>

<p><div class="warningbox"> <code class="code">y</code> and <code class="code">yQ'</code> should not be accessed after the function
               returns.</div></p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVQuadRhsFn">CVQuadRhsFn</a></li></ul>
</div>


<pre><span id="VALinit"><span class="keyword">val</span> init</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -><br>       'd <a href="Cvodes.Quadrature.html#TYPEquadrhsfn">quadrhsfn</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Activates the integration of quadrature equations. The vector
      gives the initial value of $y_Q$.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVodeQuadInit">CVodeQuadInit</a></li></ul>
</div>

<pre><span id="VALreinit"><span class="keyword">val</span> reinit</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Reinitializes the integration of quadrature equations. The vector
      gives a new value for $y_Q$.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVodeQuadReInit">CVodeQuadReInit</a></li></ul>
</div>

<pre><span id="VALget"><span class="keyword">val</span> get</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the quadrature solutions and time reached after a successful
      solver step. The given vector is filled with values calculated during
      either <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> or <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a> and the
      value of the independent variable is returned.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVodeGetQuad">CVodeGetQuad</a></li></ul>
</div>

<pre><span id="VALget_dky"><span class="keyword">val</span> get_dky</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> float -> int -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the interpolated solution or derivatives of quadrature
      variables.</p>

<p><code class="code">get_dky&nbsp;s&nbsp;dkyq&nbsp;t&nbsp;k</code> computes the <code class="code">k</code>th derivative at time <code class="code">t</code>, i.e.,
      $\frac{d^\mathtt{k}y_Q(\mathtt{t})}{\mathit{dt}^\mathtt{k}}$,
      and stores it in <code class="code">dkyq</code>. The arguments must satisfy $t_n - h_u \leq
      \mathtt{t} \leq t_n$—where $t_n$ denotes <a href="Cvode.html#VALget_current_time"><code class="code"><span class="constructor">Cvode</span>.get_current_time</code></a>
      and $h_u$ denotes <a href="Cvode.html#VALget_last_step"><code class="code"><span class="constructor">Cvode</span>.get_last_step</code></a>,— and
      $0 \leq \mathtt{k} \leq q_u$—where
      $q_u$ denotes <a href="Cvode.html#VALget_last_order"><code class="code"><span class="constructor">Cvode</span>.get_last_order</code></a>.</p>

<p>This function may only be called after a successful return from either
      <a href="Cvode.html#VALsolve_normal"><code class="code"><span class="constructor">Cvode</span>.solve_normal</code></a> or <a href="Cvode.html#VALsolve_one_step"><code class="code"><span class="constructor">Cvode</span>.solve_one_step</code></a>.</p>
</div>
<ul class="info-attributes">
<div class="raisedexceptions"><span class="raises">Raises</span><ul><li><code>BadT</code> <code class="code">t</code> is not in the interval $[t_n - h_u, t_n]$.</li>
<li><code>BadK</code> <code class="code">k</code> is not in the range 0, 1, ..., $q_u$.</li>
</ul></div>
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVodeGetQuadDky">CVodeGetQuadDky</a></li></ul>
</div>
<h3 id="tols">Tolerances</h3>
<pre><code><span id="TYPEtolerance"><span class="keyword">type</span> <code class="type">('d, 'k)</code> tolerance</span> = </code></pre><table class="typetable">
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.NoStepSizeControl"><span class="constructor">NoStepSizeControl</span></span></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p>Do not use quadrature variables for step-size control (default).</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SStolerances"><span class="constructor">SStolerances</span></span> <span class="keyword">of</span> <code class="type">float * float</code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><code class="code">(rel,&nbsp;abs)</code> : scalar relative and absolute tolerances.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr>
<tr>
<td align="left" valign="top" >
<code><span class="keyword">|</span></code></td>
<td align="left" valign="top" >
<code><span id="TYPEELTtolerance.SVtolerances"><span class="constructor">SVtolerances</span></span> <span class="keyword">of</span> <code class="type">float * ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a></code></code></td>
<td class="typefieldcomment" align="left" valign="top" ><code>(*</code></td><td class="typefieldcomment" align="left" valign="top" ><div class="info ">
<div class="info-desc">
<p><code class="code">(rel,&nbsp;abs)</code> : scalar relative and vector absolute tolerances.</p>
</div>
</div>
</td><td class="typefieldcomment" align="left" valign="bottom" ><code>*)</code></td>
</tr></table>

<div class="info ">
<div class="info-desc">
<p>Tolerances for calculating quadrature variables.</p>
</div>
</div>


<pre><span id="VALset_tolerances"><span class="keyword">val</span> set_tolerances</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Cvodes.Quadrature.html#TYPEtolerance">tolerance</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Specify how to use quadrature variables in step size control.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVodeSetQuadErrCon">CVodeSetQuadErrCon</a></li><li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVodeQuadSStolerances">CVodeQuadSStolerances</a></li><li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVodeQuadSVtolerances">CVodeQuadSVtolerances</a></li></ul>
</div>
<h3 id="get">Querying the solver (optional output functions)</h3>
<pre><span id="VALget_num_rhs_evals"><span class="keyword">val</span> get_num_rhs_evals</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of calls to the quadrature function.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVodeGetQuadNumRhsEvals">CVodeGetQuadNumRhsEvals</a></li></ul>
</div>

<pre><span id="VALget_num_err_test_fails"><span class="keyword">val</span> get_num_err_test_fails</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the number of local error test failures that have occurred
      due to quadrature variables.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVodeGetQuadNumErrTestFails">CVodeGetQuadNumErrTestFails</a></li></ul>
</div>

<pre><span id="VALget_err_weights"><span class="keyword">val</span> get_err_weights</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> ('d, 'k) <a href="Nvector.html#TYPEt">Nvector.t</a> -> unit</code></pre><div class="info ">
<div class="info-desc">
<p>Returns the quadrature error weights at the current time.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVodeGetQuadErrWeights">CVodeGetQuadErrWeights</a></li></ul>
</div>

<pre><span id="VALget_stats"><span class="keyword">val</span> get_stats</span> : <code class="type">('d, 'k) <a href="Cvode.html#TYPEsession">Cvode.session</a> -> int * int</code></pre><div class="info ">
<div class="info-desc">
<p>Returns quadrature-related statistics. These are the
      number of calls to the quadrature function (<code class="code">nfqevals</code>) and the number
      of error test failures due to quadrature variables (<code class="code">nqetfails</code>).</p>
</div>
<ul class="info-attributes">
<li><b>Returns</b> (<code class="code">nfqevals</code>, <code class="code">nqetfails</code>)</li>
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Usage/SIM.html#c.CVodeGetQuadStats">CVodeGetQuadStats</a></li></ul>
</div>
<h3 id="exceptions">Exceptions</h3>
<pre><span id="EXCEPTIONQuadNotInitialized"><span class="keyword">exception</span> QuadNotInitialized</span></pre>
<div class="info ">
<div class="info-desc">
<p>Quadrature integration was not initialized.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Constants_link.html">CV_NO_QUAD</a></li></ul>
</div>

<pre><span id="EXCEPTIONQuadRhsFuncFailure"><span class="keyword">exception</span> QuadRhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The quadrature function failed in an unrecoverable manner.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Constants_link.html">CV_QRHSFUNC_FAIL</a></li></ul>
</div>

<pre><span id="EXCEPTIONFirstQuadRhsFuncFailure"><span class="keyword">exception</span> FirstQuadRhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The quadrature function failed at the first call.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Constants_link.html">CV_FIRST_QRHSFUNC_ERR</a></li></ul>
</div>

<pre><span id="EXCEPTIONRepeatedQuadRhsFuncFailure"><span class="keyword">exception</span> RepeatedQuadRhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>Convergence test failures occurred too many times due to repeated
      recoverable errors in the quadrature function. Also raised if the
      quadrature function had repeated recoverable errors during the
      estimation of an initial step size (if quadrature variables are
      included in error tests).</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Constants_link.html">CV_REPTD_QRHSFUNC_ERR</a></li></ul>
</div>

<pre><span id="EXCEPTIONUnrecoverableQuadRhsFuncFailure"><span class="keyword">exception</span> UnrecoverableQuadRhsFuncFailure</span></pre>
<div class="info ">
<div class="info-desc">
<p>The quadrature function had a recoverable error, but no
      recovery was possible. This failure mode is rare, as it can occur only
      if the quadrature function fails recoverably after an error test failed
      while at order one.</p>
</div>
<ul class="info-attributes">
<li class="sundials cvodes">      <span class="seesundials">See Sundials: </span>      <a href="https://sundials.readthedocs.io/en/latest/cvodes/Constants_link.html">CV_UNREC_QRHSFUNC_ERR</a></li></ul>
</div>
</body></html>
